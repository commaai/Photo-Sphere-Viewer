{"version":3,"file":"photo-sphere-viewer.js","sources":["../src/PSVError.js","../src/adapters/AbstractAdapter.js","../src/data/constants.js","../src/data/system.js","../src/utils/browser.js","../src/utils/math.js","../src/utils/misc.js","../src/utils/psv.js","../src/utils/Animation.js","../src/utils/Dynamic.js","../src/utils/MultiDynamic.js","../src/utils/Slider.js","../src/utils/index.js","../src/adapters/equirectangular/index.js","../src/components/AbstractComponent.js","../src/buttons/AbstractButton.js","../src/buttons/AutorotateButton.js","../src/buttons/CustomButton.js","../src/buttons/DescriptionButton.js","../src/buttons/DownloadButton.js","../src/buttons/FullscreenButton.js","../src/buttons/MenuButton.js","../src/utils/PressHandler.js","../src/buttons/AbstractMoveButton.js","../src/buttons/MoveDownButton.js","../src/buttons/MoveLeftButton.js","../src/buttons/MoveRightButton.js","../src/buttons/MoveUpButton.js","../src/buttons/AbstractZoomButton.js","../src/buttons/ZoomInButton.js","../src/buttons/ZoomOutButton.js","../src/buttons/ZoomRangeButton.js","../src/plugins/AbstractPlugin.js","../src/data/config.js","../src/components/NavbarCaption.js","../src/components/Navbar.js","../src/components/Loader.js","../src/components/Notification.js","../src/components/Overlay.js","../src/components/Panel.js","../src/services/AbstractService.js","../src/services/DataHelper.js","../src/services/EventsHandler.js","../src/services/Renderer.js","../src/services/TextureLoader.js","../src/components/Tooltip.js","../src/services/TooltipRenderer.js","../src/Viewer.js"],"sourcesContent":["/**\n * @summary Custom error used in the lib\n * @param {string} message\n * @constructor\n * @memberOf PSV\n */\nfunction PSVError(message) {\n  this.message = message;\n\n  // Use V8's native method if available, otherwise fallback\n  if ('captureStackTrace' in Error) {\n    Error.captureStackTrace(this, PSVError);\n  }\n  else {\n    this.stack = (new Error()).stack;\n  }\n}\n\nPSVError.prototype = Object.create(Error.prototype);\nPSVError.prototype.name = 'PSVError';\nPSVError.prototype.constructor = PSVError;\n\nexport { PSVError };\n","import { ShaderMaterial, Texture } from 'three';\nimport { PSVError } from '../PSVError';\n\n/**\n * @namespace PSV.adapters\n */\n\n\n/**\n * @summary Base adapters class\n * @memberof PSV.adapters\n * @abstract\n */\nexport class AbstractAdapter {\n\n  /**\n   * @summary Unique identifier of the adapter\n   * @member {string}\n   * @readonly\n   * @static\n   */\n  static id = null;\n\n  /**\n   * @summary Indicates if the adapter supports panorama download natively\n   * @type {boolean}\n   * @readonly\n   * @static\n   */\n  static supportsDownload = false;\n\n  /**\n   * @summary Indicated if the adapter can display an additional transparent image above the panorama\n   * @type {boolean}\n   */\n  static supportsOverlay = false;\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    /**\n     * @summary Reference to main controller\n     * @type {PSV.Viewer}\n     * @readonly\n     */\n    this.psv = psv;\n  }\n\n  /**\n   * @summary Destroys the adapter\n   */\n  destroy() {\n    delete this.psv;\n  }\n\n  /**\n   * @summary Indicates if the adapter supports transitions between panoramas\n   * @param {*} panorama\n   * @return {boolean}\n   */\n  supportsTransition(panorama) { // eslint-disable-line no-unused-vars\n    return false;\n  }\n\n  /**\n   * @summary Indicates if the adapter supports preload of a panorama\n   * @param {*} panorama\n   * @return {boolean}\n   */\n  supportsPreload(panorama) { // eslint-disable-line no-unused-vars\n    return false;\n  }\n\n  /**\n   * @abstract\n   * @summary Loads the panorama texture(s)\n   * @param {*} panorama\n   * @param {PSV.PanoData | PSV.PanoDataProvider} [newPanoData]\n   * @param {boolean} [useXmpPanoData]\n   * @returns {Promise.<PSV.TextureData>}\n   */\n  loadTexture(panorama, newPanoData, useXmpPanoData) { // eslint-disable-line no-unused-vars\n    throw new PSVError('loadTexture not implemented');\n  }\n\n  /**\n   * @abstract\n   * @summary Creates the cube mesh\n   * @param {number} [scale=1]\n   * @returns {external:THREE.Mesh}\n   */\n  createMesh(scale = 1) { // eslint-disable-line no-unused-vars\n    throw new PSVError('createMesh not implemented');\n  }\n\n  /**\n   * @abstract\n   * @summary Applies the texture to the mesh\n   * @param {external:THREE.Mesh} mesh\n   * @param {PSV.TextureData} textureData\n   * @param {boolean} [transition=false]\n   */\n  setTexture(mesh, textureData, transition = false) { // eslint-disable-line no-unused-vars\n    throw new PSVError('setTexture not implemented');\n  }\n\n  /**\n   * @abstract\n   * @summary Changes the opacity of the mesh\n   * @param {external:THREE.Mesh} mesh\n   * @param {number} opacity\n   */\n  setTextureOpacity(mesh, opacity) { // eslint-disable-line no-unused-vars\n    throw new PSVError('setTextureOpacity not implemented');\n  }\n\n  /**\n   * @abstract\n   * @summary Clear a loaded texture from memory\n   * @param {PSV.TextureData} textureData\n   */\n  disposeTexture(textureData) { // eslint-disable-line no-unused-vars\n    throw new PSVError('disposeTexture not implemented');\n  }\n\n  /**\n   * @abstract\n   * @summary Applies the overlay to the mesh\n   * @param {external:THREE.Mesh} mesh\n   * @param {PSV.TextureData} textureData\n   * @param {number} opacity\n   */\n  setOverlay(mesh, textureData, opacity) { // eslint-disable-line no-unused-vars\n    throw new PSVError('setOverlay not implemented');\n  }\n\n  /**\n   * @internal\n   */\n  static OVERLAY_UNIFORMS = {\n    panorama      : 'panorama',\n    overlay       : 'overlay',\n    globalOpacity : 'globalOpacity',\n    overlayOpacity: 'overlayOpacity',\n  };\n\n  /**\n   * @internal\n   */\n  static createOverlayMaterial({ additionalUniforms, overrideVertexShader } = {}) {\n    return new ShaderMaterial({\n      uniforms: {\n        ...additionalUniforms,\n        [AbstractAdapter.OVERLAY_UNIFORMS.panorama]      : { value: new Texture() },\n        [AbstractAdapter.OVERLAY_UNIFORMS.overlay]       : { value: new Texture() },\n        [AbstractAdapter.OVERLAY_UNIFORMS.globalOpacity] : { value: 1.0 },\n        [AbstractAdapter.OVERLAY_UNIFORMS.overlayOpacity]: { value: 1.0 },\n      },\n\n      vertexShader: overrideVertexShader || `\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}`,\n\n      fragmentShader: `\nuniform sampler2D ${AbstractAdapter.OVERLAY_UNIFORMS.panorama};\nuniform sampler2D ${AbstractAdapter.OVERLAY_UNIFORMS.overlay};\nuniform float ${AbstractAdapter.OVERLAY_UNIFORMS.globalOpacity};\nuniform float ${AbstractAdapter.OVERLAY_UNIFORMS.overlayOpacity};\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 tColor1 = texture2D( ${AbstractAdapter.OVERLAY_UNIFORMS.panorama}, vUv );\n  vec4 tColor2 = texture2D( ${AbstractAdapter.OVERLAY_UNIFORMS.overlay}, vUv );\n  gl_FragColor = vec4(\n    mix( tColor1.rgb, tColor2.rgb, tColor2.a * ${AbstractAdapter.OVERLAY_UNIFORMS.overlayOpacity} ),\n    ${AbstractAdapter.OVERLAY_UNIFORMS.globalOpacity}\n  );\n}`,\n    });\n  }\n\n}\n","/**\n * @namespace PSV.constants\n */\n\n/**\n * @summary Default duration of the transition between panoramas\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const DEFAULT_TRANSITION = 1500;\n\n/**\n * @summary Number of pixels bellow which a mouse move will be considered as a click\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const MOVE_THRESHOLD = 4;\n\n/**\n * @summary Delay in milliseconds between two clicks to consider a double click\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const DBLCLICK_DELAY = 300;\n\n/**\n * @summary Delay in milliseconds to emulate a long touch\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const LONGTOUCH_DELAY = 500;\n\n/**\n * @summary Delay in milliseconds to for the two fingers overlay to appear\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const TWOFINGERSOVERLAY_DELAY = 100;\n\n/**\n * @summary Duration in milliseconds of the \"ctrl zoom\" overlay\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const CTRLZOOM_TIMEOUT = 2000;\n\n/**\n * @summary Time size of the mouse position history used to compute inertia\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const INERTIA_WINDOW = 300;\n\n/**\n * @summary Radius of the THREE.SphereGeometry, Half-length of the THREE.BoxGeometry\n * @memberOf PSV.constants\n * @type {number}\n * @constant\n */\nexport const SPHERE_RADIUS = 10;\n\n/**\n * @summary Property name added to viewer element\n * @memberOf PSV.constants\n * @type {string}\n * @constant\n */\nexport const VIEWER_DATA = 'photoSphereViewer';\n\n/**\n * @summary Property added the the main Mesh object\n * @memberOf PSV.constants\n * @type {string}\n * @constant\n */\nexport const MESH_USER_DATA = 'psvSphere';\n\n/**\n * @summary Available actions\n * @memberOf PSV.constants\n * @enum {string}\n * @constant\n */\nexport const ACTIONS = {\n  ROTATE_LAT_UP    : 'rotateLatitudeUp',\n  ROTATE_LAT_DOWN  : 'rotateLatitudeDown',\n  ROTATE_LONG_RIGHT: 'rotateLongitudeRight',\n  ROTATE_LONG_LEFT : 'rotateLongitudeLeft',\n  ZOOM_IN          : 'zoomIn',\n  ZOOM_OUT         : 'zoomOut',\n  TOGGLE_AUTOROTATE: 'toggleAutorotate',\n};\n\n/**\n * @summary Available events names\n * @memberOf PSV.constants\n * @enum {string}\n * @constant\n */\nexport const EVENTS = {\n  /**\n   * @event autorotate\n   * @memberof PSV\n   * @summary Triggered when the automatic rotation is enabled/disabled\n   * @param {boolean} enabled\n   */\n  AUTOROTATE        : 'autorotate',\n  /**\n   * @event before-render\n   * @memberof PSV\n   * @summary Triggered before a render, used to modify the view\n   * @param {number} timestamp - time provided by requestAnimationFrame\n   * @param {number} elapsed - time elapsed from the previous frame\n   */\n  BEFORE_RENDER     : 'before-render',\n  /**\n   * @event before-rotate\n   * @memberOf PSV\n   * @summary Triggered before a rotate operation, can be cancelled\n   * @param {PSV.ExtendedPosition}\n   */\n  BEFORE_ROTATE     : 'before-rotate',\n  /**\n   * @event click\n   * @memberof PSV\n   * @summary Triggered when the user clicks on the viewer (everywhere excluding the navbar and the side panel)\n   * @param {PSV.ClickData} data\n   */\n  CLICK             : 'click',\n  /**\n   * @event close-panel\n   * @memberof PSV\n   * @summary Triggered when the panel is closed\n   * @param {string} [id]\n   */\n  CLOSE_PANEL       : 'close-panel',\n  /**\n   * @event config-changed\n   * @memberOf PSV\n   * @summary Triggered after a call to setOption/setOptions\n   * @param {string[]} name of changed options\n   */\n  CONFIG_CHANGED    : 'config-changed',\n  /**\n   * @event dblclick\n   * @memberof PSV\n   * @summary Triggered when the user double clicks on the viewer. The simple `click` event is always fired before `dblclick`\n   * @param {PSV.ClickData} data\n   */\n  DOUBLE_CLICK      : 'dblclick',\n  /**\n   * @event fullscreen-updated\n   * @memberof PSV\n   * @summary Triggered when the fullscreen mode is enabled/disabled\n   * @param {boolean} enabled\n   */\n  FULLSCREEN_UPDATED: 'fullscreen-updated',\n  /**\n   * @event hide-notification\n   * @memberof PSV\n   * @summary Triggered when the notification is hidden\n   * @param {string} [id]\n   */\n  HIDE_NOTIFICATION : 'hide-notification',\n  /**\n   * @event hide-overlay\n   * @memberof PSV\n   * @summary Triggered when the overlay is hidden\n   * @param {string} [id]\n   */\n  HIDE_OVERLAY      : 'hide-overlay',\n  /**\n   * @event hide-tooltip\n   * @memberof PSV\n   * @summary Triggered when the tooltip is hidden\n   * @param {*} Data associated to this tooltip\n   */\n  HIDE_TOOLTIP      : 'hide-tooltip',\n  /**\n   * @event key-press\n   * @memberof PSV\n   * @summary Triggered when a key is pressed, can be cancelled\n   * @param {string} key\n   */\n  KEY_PRESS         : 'key-press',\n  /**\n   * @event load-progress\n   * @memberof PSV\n   * @summary Triggered when the loader value changes\n   * @param {number} value from 0 to 100\n   */\n  LOAD_PROGRESS     : 'load-progress',\n  /**\n   * @event open-panel\n   * @memberof PSV\n   * @summary Triggered when the panel is opened\n   * @param {string} [id]\n   */\n  OPEN_PANEL        : 'open-panel',\n  /**\n   * @event panorama-loaded\n   * @memberof PSV\n   * @summary Triggered when a panorama image has been loaded\n   * @param {PSV.TextureData} textureData\n   */\n  PANORAMA_LOADED   : 'panorama-loaded',\n  /**\n   * @event position-updated\n   * @memberof PSV\n   * @summary Triggered when the view longitude and/or latitude changes\n   * @param {PSV.Position} position\n   */\n  POSITION_UPDATED  : 'position-updated',\n  /**\n   * @event ready\n   * @memberof PSV\n   * @summary Triggered when the panorama image has been loaded and the viewer is ready to perform the first render\n   */\n  READY             : 'ready',\n  /**\n   * @event render\n   * @memberof PSV\n   * @summary Triggered on each viewer render, **this event is triggered very often**\n   */\n  RENDER            : 'render',\n  /**\n   * @event show-notification\n   * @memberof PSV\n   * @summary Triggered when the notification is shown\n   * @param {string} [id]\n   */\n  SHOW_NOTIFICATION : 'show-notification',\n  /**\n   * @event show-overlay\n   * @memberof PSV\n   * @summary Triggered when the overlay is shown\n   * @param {string} [id]\n   */\n  SHOW_OVERLAY      : 'show-overlay',\n  /**\n   * @event show-tooltip\n   * @memberof PSV\n   * @summary Triggered when the tooltip is shown\n   * @param {*} Data associated to this tooltip\n   * @param {PSV.components.Tooltip} Instance of the tooltip\n   */\n  SHOW_TOOLTIP      : 'show-tooltip',\n  /**\n   * @event size-updated\n   * @memberof PSV\n   * @summary Triggered when the viewer size changes\n   * @param {PSV.Size} size\n   */\n  SIZE_UPDATED      : 'size-updated',\n  /**\n   * @event stop-all\n   * @memberof PSV\n   * @summary Triggered when all current animations are stopped\n   */\n  STOP_ALL          : 'stop-all',\n  /**\n   * @event zoom-updated\n   * @memberof PSV\n   * @summary Triggered when the zoom level changes\n   * @param {number} zoomLevel\n   */\n  ZOOM_UPDATED      : 'zoom-updated',\n};\n\n/**\n * @summary Available change events names\n * @memberOf PSV.constants\n * @enum {string}\n * @constant\n */\nexport const CHANGE_EVENTS = {\n  /**\n   * @event get-animate-position\n   * @memberof PSV\n   * @param {Position} position\n   * @returns {Position}\n   * @summary Called to alter the target position of an animation\n   */\n  GET_ANIMATE_POSITION: 'get-animate-position',\n  /**\n   * @event get-rotate-position\n   * @memberof PSV\n   * @param {Position} position\n   * @returns {Position}\n   * @summary Called to alter the target position of a rotation\n   */\n  GET_ROTATE_POSITION : 'get-rotate-position',\n};\n\n/**\n * @summary Special events emitted to listener using {@link Viewer#observeObjects}\n * @memberOf PSV.constants\n * @constant\n * @package\n */\nexport const OBJECT_EVENTS = {\n  ENTER_OBJECT: 'enter-object',\n  HOVER_OBJECT: 'hover-object',\n  LEAVE_OBJECT: 'leave-object',\n};\n\n/**\n * @summary Internal identifiers for various stuff\n * @memberOf PSV.constants\n * @enum {string}\n * @constant\n */\nexport const IDS = {\n  MENU       : 'menu',\n  TWO_FINGERS: 'twoFingers',\n  CTRL_ZOOM  : 'ctrlZoom',\n  ERROR      : 'error',\n  DESCRIPTION: 'description',\n};\n\n/* eslint-disable */\n// @formatter:off\n/**\n * @summary Collection of easing functions\n * @memberOf PSV.constants\n * @see {@link https://gist.github.com/frederickk/6165768}\n * @type {Object<string, Function>}\n * @constant\n */\nexport const EASINGS = {\n  linear    : (t) => t,\n\n  inQuad    : (t) => t*t,\n  outQuad   : (t) => t*(2-t),\n  inOutQuad : (t) => t<.5 ? 2*t*t : -1+(4-2*t)*t,\n\n  inCubic   : (t) => t*t*t,\n  outCubic  : (t) => (--t)*t*t+1,\n  inOutCubic: (t) => t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1,\n\n  inQuart   : (t) => t*t*t*t,\n  outQuart  : (t) => 1-(--t)*t*t*t,\n  inOutQuart: (t) => t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t,\n\n  inQuint   : (t) => t*t*t*t*t,\n  outQuint  : (t) => 1+(--t)*t*t*t*t,\n  inOutQuint: (t) => t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t,\n\n  inSine    : (t) => 1-Math.cos(t*(Math.PI/2)),\n  outSine   : (t) => Math.sin(t*(Math.PI/2)),\n  inOutSine : (t) => .5-.5*Math.cos(Math.PI*t),\n\n  inExpo    : (t) => Math.pow(2, 10*(t-1)),\n  outExpo   : (t) => 1-Math.pow(2, -10*t),\n  inOutExpo : (t) => (t=t*2-1)<0 ? .5*Math.pow(2, 10*t) : 1-.5*Math.pow(2, -10*t),\n\n  inCirc    : (t) => 1-Math.sqrt(1-t*t),\n  outCirc   : (t) => Math.sqrt(1-(t-1)*(t-1)),\n  inOutCirc : (t) => (t*=2)<1 ? .5-.5*Math.sqrt(1-t*t) : .5+.5*Math.sqrt(1-(t-=2)*t)\n};\n// @formatter:on\n/* eslint-enable */\n\n/**\n * @summary Subset of key codes\n * @memberOf PSV.constants\n * @type {Object<string, string>}\n * @constant\n */\nexport const KEY_CODES = {\n  Enter     : 'Enter',\n  Control   : 'Control',\n  Escape    : 'Escape',\n  Space     : ' ',\n  PageUp    : 'PageUp',\n  PageDown  : 'PageDown',\n  ArrowLeft : 'ArrowLeft',\n  ArrowUp   : 'ArrowUp',\n  ArrowRight: 'ArrowRight',\n  ArrowDown : 'ArrowDown',\n  Delete    : 'Delete',\n  Plus      : '+',\n  Minus     : '-',\n};\n","import { PSVError } from '../PSVError';\nimport { VIEWER_DATA } from './constants';\n\nconst LOCALSTORAGE_TOUCH_SUPPORT = `${VIEWER_DATA}_touchSupport`;\n\n/**\n * @summary General information about the system\n * @constant\n * @memberOf PSV\n * @property {boolean} loaded - Indicates if the system data has been loaded\n * @property {Function} load - Loads the system if not already loaded\n * @property {number} pixelRatio\n * @property {boolean} isWebGLSupported\n * @property {number} maxCanvasWidth\n * @property {string} mouseWheelEvent\n * @property {string} fullscreenEvent\n * @property {Function} getMaxCanvasWidth - Returns the max width of a canvas allowed by the browser\n * @property {{initial: boolean, promise: Promise<boolean>}} isTouchEnabled\n */\nexport const SYSTEM = {\n  loaded          : false,\n  pixelRatio      : 1,\n  isWebGLSupported: false,\n  isTouchEnabled  : null,\n  maxTextureWidth : 0,\n  mouseWheelEvent : null,\n  fullscreenEvent : null,\n};\n\n/**\n * @summary Loads the system if not already loaded\n */\nSYSTEM.load = () => {\n  if (!SYSTEM.loaded) {\n    const ctx = getWebGLCtx();\n\n    SYSTEM.loaded = true;\n    SYSTEM.pixelRatio = window.devicePixelRatio || 1;\n    SYSTEM.isWebGLSupported = ctx != null;\n    SYSTEM.isTouchEnabled = isTouchEnabled();\n    SYSTEM.maxTextureWidth = getMaxTextureWidth(ctx);\n    SYSTEM.mouseWheelEvent = getMouseWheelEvent();\n    SYSTEM.fullscreenEvent = getFullscreenEvent();\n  }\n};\n\nlet maxCanvasWidth = null;\nSYSTEM.getMaxCanvasWidth = () => {\n  if (maxCanvasWidth === null) {\n    maxCanvasWidth = getMaxCanvasWidth(SYSTEM.maxTextureWidth);\n  }\n  return maxCanvasWidth;\n};\n\n/**\n * @summary Tries to return a canvas webgl context\n * @returns {WebGLRenderingContext}\n * @private\n */\nfunction getWebGLCtx() {\n  const canvas = document.createElement('canvas');\n  const names = ['webgl', 'experimental-webgl', 'moz-webgl', 'webkit-3d'];\n  let context = null;\n\n  if (!canvas.getContext) {\n    return null;\n  }\n\n  if (names.some((name) => {\n    try {\n      context = canvas.getContext(name);\n      return context !== null;\n    }\n    catch (e) {\n      return false;\n    }\n  })) {\n    return context;\n  }\n  else {\n    return null;\n  }\n}\n\n/**\n * @summary Detects if the user is using a touch screen\n * @returns {{initial: boolean, promise: Promise<boolean>}}\n * @private\n */\nfunction isTouchEnabled() {\n  let initial = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);\n  if (LOCALSTORAGE_TOUCH_SUPPORT in localStorage) {\n    initial = localStorage[LOCALSTORAGE_TOUCH_SUPPORT] === 'true';\n  }\n\n  const promise = new Promise((resolve) => {\n    let clear;\n\n    const listenerMouse = () => {\n      clear();\n      localStorage[LOCALSTORAGE_TOUCH_SUPPORT] = false;\n      resolve(false);\n    };\n\n    const listenerTouch = () => {\n      clear();\n      localStorage[LOCALSTORAGE_TOUCH_SUPPORT] = true;\n      resolve(true);\n    };\n\n    const listenerTimeout = () => {\n      clear();\n      localStorage[LOCALSTORAGE_TOUCH_SUPPORT] = initial;\n      resolve(initial);\n    };\n\n    window.addEventListener('mousedown', listenerMouse, false);\n    window.addEventListener('touchstart', listenerTouch, false);\n    const listenerTimeoutId = setTimeout(listenerTimeout, 10000);\n\n    clear = () => {\n      window.removeEventListener('mousedown', listenerMouse);\n      window.removeEventListener('touchstart', listenerTouch);\n      clearTimeout(listenerTimeoutId);\n    };\n  });\n\n  return { initial, promise };\n}\n\n/**\n * @summary Gets max texture width in WebGL context\n * @returns {number}\n * @private\n */\nfunction getMaxTextureWidth(ctx) {\n  if (ctx !== null) {\n    return ctx.getParameter(ctx.MAX_TEXTURE_SIZE);\n  }\n  else {\n    return 0;\n  }\n}\n\n/**\n * @summary Gets max canvas width supported by the browser.\n * We only test powers of 2 and height = width / 2 because that's what we need to generate WebGL textures\n * @param maxWidth\n * @return {number}\n * @private\n */\nfunction getMaxCanvasWidth(maxWidth) {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  canvas.width = maxWidth;\n  canvas.height = maxWidth / 2;\n\n  while (canvas.width > 1024) {\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, 1, 1);\n\n    try {\n      if (ctx.getImageData(0, 0, 1, 1).data[0] > 0) {\n        return canvas.width;\n      }\n    }\n    catch (e) {\n      // continue\n    }\n\n    canvas.width /= 2;\n    canvas.height /= 2;\n  }\n\n  throw new PSVError('Unable to detect system capabilities');\n}\n\n/**\n * @summary Gets the event name for mouse wheel\n * @returns {string}\n * @private\n */\nfunction getMouseWheelEvent() {\n  if ('onwheel' in document.createElement('div')) { // Modern browsers support \"wheel\"\n    return 'wheel';\n  }\n  else if (document.onmousewheel !== undefined) { // Webkit and IE support at least \"mousewheel\"\n    return 'mousewheel';\n  }\n  else { // let's assume that remaining browsers are older Firefox\n    return 'DOMMouseScroll';\n  }\n}\n\n/**\n * @summary Map between fullsceen method and fullscreen event name\n * @type {Object<string, string>}\n * @readonly\n * @private\n */\nconst FULLSCREEN_EVT_MAP = {\n  exitFullscreen      : 'fullscreenchange',\n  webkitExitFullscreen: 'webkitfullscreenchange',\n  mozCancelFullScreen : 'mozfullscreenchange',\n  msExitFullscreen    : 'MSFullscreenChange',\n};\n\n\n/**\n * @summary  Gets the event name for fullscreen\n * @returns {string}\n * @private\n */\nfunction getFullscreenEvent() {\n  const validExits = Object.keys(FULLSCREEN_EVT_MAP).filter(exit => exit in document);\n\n  if (validExits.length) {\n    return FULLSCREEN_EVT_MAP[validExits[0]];\n  }\n  else {\n    return null;\n  }\n}\n","/**\n * @summary Toggles a CSS class\n * @memberOf PSV.utils\n * @param {HTMLElement|SVGElement} element\n * @param {string} className\n * @param {boolean} [active] - forced state\n */\nexport function toggleClass(element, className, active) {\n  if (active === undefined) {\n    element.classList.toggle(className);\n  }\n  else if (active) {\n    element.classList.add(className);\n  }\n  else if (!active) {\n    element.classList.remove(className);\n  }\n}\n\n/**\n * @summary Adds one or several CSS classes to an element\n * @memberOf PSV.utils\n * @param {HTMLElement} element\n * @param {string} className\n */\nexport function addClasses(element, className) {\n  element.classList.add(...className.split(' '));\n}\n\n/**\n * @summary Removes one or several CSS classes to an element\n * @memberOf PSV.utils\n * @param {HTMLElement} element\n * @param {string} className\n */\nexport function removeClasses(element, className) {\n  element.classList.remove(...className.split(' '));\n}\n\n/**\n * @summary Searches if an element has a particular parent at any level including itself\n * @memberOf PSV.utils\n * @param {HTMLElement} el\n * @param {HTMLElement} parent\n * @returns {boolean}\n */\nexport function hasParent(el, parent) {\n  let test = el;\n\n  do {\n    if (test === parent) {\n      return true;\n    }\n    test = test.parentNode;\n  } while (test);\n\n  return false;\n}\n\n/**\n * @summary Gets the closest parent (can by itself)\n * @memberOf PSV.utils\n * @param {HTMLElement|SVGElement} el\n * @param {string} selector\n * @returns {HTMLElement}\n */\nexport function getClosest(el, selector) {\n  // When el is document or window, the matches does not exist\n  if (!el?.matches) {\n    return null;\n  }\n\n  let test = el;\n\n  do {\n    if (test.matches(selector)) {\n      return test;\n    }\n    test = test instanceof SVGElement ? test.parentNode : test.parentElement;\n  } while (test);\n\n  return null;\n}\n\n/**\n * @summary Gets the position of an element in the viewer without reflow\n * @description Will gives the same result as getBoundingClientRect() as soon as there are no CSS transforms\n * @memberOf PSV.utils\n * @param {HTMLElement} el\n * @return {{left: number, top: number}}\n */\nexport function getPosition(el) {\n  let left = 0;\n  let top = 0;\n  let test = el;\n\n  while (test) {\n    left += (test.offsetLeft - test.scrollLeft + test.clientLeft);\n    top += (test.offsetTop - test.scrollTop + test.clientTop);\n    test = test.offsetParent;\n  }\n\n  return { left, top };\n}\n\n/**\n * @summary Detects if fullscreen is enabled\n * @memberOf PSV.utils\n * @param {HTMLElement} elt\n * @returns {boolean}\n */\nexport function isFullscreenEnabled(elt) {\n  return (document.fullscreenElement || document.webkitFullscreenElement) === elt;\n}\n\n/**\n * @summary Enters fullscreen mode\n * @memberOf PSV.utils\n * @param {HTMLElement} elt\n */\nexport function requestFullscreen(elt) {\n  (elt.requestFullscreen || elt.webkitRequestFullscreen).call(elt);\n}\n\n/**\n * @summary Exits fullscreen mode\n * @memberOf PSV.utils\n */\nexport function exitFullscreen() {\n  (document.exitFullscreen || document.webkitExitFullscreen).call(document);\n}\n\n/**\n * @summary Gets an element style\n * @memberOf PSV.utils\n * @param {HTMLElement} elt\n * @param {string} prop\n * @returns {*}\n */\nexport function getStyle(elt, prop) {\n  return window.getComputedStyle(elt, null)[prop];\n}\n\n/**\n * @summary Normalize mousewheel values accross browsers\n * @memberOf PSV.utils\n * @description From Facebook's Fixed Data Table\n * {@link https://github.com/facebookarchive/fixed-data-table/blob/master/src/vendor_upstream/dom/normalizeWheel.js}\n * @copyright Facebook\n * @param {WheelEvent} event\n * @returns {{spinX: number, spinY: number, pixelX: number, pixelY: number}}\n */\nexport function normalizeWheel(event) {\n  const PIXEL_STEP = 10;\n  const LINE_HEIGHT = 40;\n  const PAGE_HEIGHT = 800;\n\n  let spinX = 0;\n  let spinY = 0;\n  let pixelX = 0;\n  let pixelY = 0;\n\n  // Legacy\n  if ('detail' in event) {\n    spinY = event.detail;\n  }\n  if ('wheelDelta' in event) {\n    spinY = -event.wheelDelta / 120;\n  }\n  if ('wheelDeltaY' in event) {\n    spinY = -event.wheelDeltaY / 120;\n  }\n  if ('wheelDeltaX' in event) {\n    spinX = -event.wheelDeltaX / 120;\n  }\n\n  // side scrolling on FF with DOMMouseScroll\n  if ('axis' in event && event.axis === event.HORIZONTAL_AXIS) {\n    spinX = spinY;\n    spinY = 0;\n  }\n\n  pixelX = spinX * PIXEL_STEP;\n  pixelY = spinY * PIXEL_STEP;\n\n  if ('deltaY' in event) {\n    pixelY = event.deltaY;\n  }\n  if ('deltaX' in event) {\n    pixelX = event.deltaX;\n  }\n\n  if ((pixelX || pixelY) && event.deltaMode) {\n    // delta in LINE units\n    if (event.deltaMode === 1) {\n      pixelX *= LINE_HEIGHT;\n      pixelY *= LINE_HEIGHT;\n    }\n    // delta in PAGE units\n    else {\n      pixelX *= PAGE_HEIGHT;\n      pixelY *= PAGE_HEIGHT;\n    }\n  }\n\n  // Fall-back if spin cannot be determined\n  if (pixelX && !spinX) {\n    spinX = (pixelX < 1) ? -1 : 1;\n  }\n  if (pixelY && !spinY) {\n    spinY = (pixelY < 1) ? -1 : 1;\n  }\n\n  return { spinX, spinY, pixelX, pixelY };\n}\n","import { MathUtils } from 'three';\n\n/**\n * @deprecated use THREE.MathUtils.clamp\n */\nexport function bound(x, min, max) {\n  return MathUtils.clamp(x, min, max);\n}\n\n/**\n * @summary Ensure a value is within 0 and `max`\n * @param {number} value\n * @param {number} max\n * @return {number}\n */\nexport function loop(value, max) {\n  let result = value % max;\n\n  if (result < 0) {\n    result += max;\n  }\n\n  return result;\n}\n\n/**\n * @deprecated Use THREE.MathUtils.isPowerOfTwo\n */\nexport function isPowerOfTwo(x) {\n  return MathUtils.isPowerOfTwo(x);\n}\n\n/**\n * @summary Computes the sum of an array\n * @memberOf PSV.utils\n * @param {number[]} array\n * @returns {number}\n */\nexport function sum(array) {\n  return array.reduce((a, b) => a + b, 0);\n}\n\n/**\n * @summary Computes the distance between two points\n * @memberOf PSV.utils\n * @param {PSV.Point} p1\n * @param {PSV.Point} p2\n * @returns {number}\n */\nexport function distance(p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}\n\n/**\n * @summary Compute the shortest offset between two longitudes\n * @memberOf PSV.utils\n * @param {number} from\n * @param {number} to\n * @returns {number}\n */\nexport function getShortestArc(from, to) {\n  const tCandidates = [\n    0, // direct\n    Math.PI * 2, // clock-wise cross zero\n    -Math.PI * 2, // counter-clock-wise cross zero\n  ];\n\n  return tCandidates.reduce((value, candidate) => {\n    const newCandidate = to - from + candidate;\n    return Math.abs(newCandidate) < Math.abs(value) ? newCandidate : value;\n  }, Infinity);\n}\n\n/**\n * @summary Computes the angle between the current position and a target position\n * @memberOf PSV.utils\n * @param {PSV.Position} position1\n * @param {PSV.Position} position2\n * @returns {number}\n */\nexport function getAngle(position1, position2) {\n  return Math.acos(\n    Math.cos(position1.latitude)\n    * Math.cos(position2.latitude)\n    * Math.cos(position1.longitude - position2.longitude)\n    + Math.sin(position1.latitude)\n    * Math.sin(position2.latitude)\n  );\n}\n\n/**\n * @summary Returns the distance between two points on a sphere of radius one\n * {@link http://www.movable-type.co.uk/scripts/latlong.html}\n * @memberOf PSV.utils\n * @param {number[]} p1\n * @param {number[]} p2\n * @returns {number}\n */\nexport function greatArcDistance(p1, p2) {\n  const [λ1, φ1] = p1;\n  const [λ2, φ2] = p2;\n\n  const x = (λ2 - λ1) * Math.cos((φ1 + φ2) / 2);\n  const y = (φ2 - φ1);\n  return Math.sqrt(x * x + y * y);\n}\n","/**\n * @summary Transforms a string to dash-case {@link https://github.com/shahata/dasherize}\n * @memberOf PSV.utils\n * @param {string} str\n * @returns {string}\n */\nexport function dasherize(str) {\n  return str.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g, (s, i) => {\n    return (i > 0 ? '-' : '') + s.toLowerCase();\n  });\n}\n\n/**\n * @summary Returns a function, that, when invoked, will only be triggered at most once during a given window of time.\n * @memberOf PSV.utils\n * @copyright underscore.js - modified by Clément Prévost {@link http://stackoverflow.com/a/27078401}\n * @param {Function} func\n * @param {number} wait\n * @returns {Function}\n */\nexport function throttle(func, wait) {\n  /* eslint-disable */\n  let self, args, result;\n  let timeout;\n  let previous = 0;\n  const later = function() {\n    previous = Date.now();\n    timeout = undefined;\n    result = func.apply(self, args);\n    if (!timeout) {\n      self = args = null;\n    }\n  };\n  return function() {\n    const now = Date.now();\n    if (!previous) {\n      previous = now;\n    }\n    const remaining = wait - (now - previous);\n    self = this;\n    args = arguments;\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = undefined;\n      }\n      previous = now;\n      result = func.apply(self, args);\n      if (!timeout) {\n        self = args = null;\n      }\n    }\n    else if (!timeout) {\n      timeout = setTimeout(later, remaining);\n    }\n    return result;\n  };\n  /* eslint-enable */\n}\n\n/**\n * @summary Test if an object is a plain object\n * @memberOf PSV.utils\n * @description Test if an object is a plain object, i.e. is constructed\n * by the built-in Object constructor and inherits directly from Object.prototype\n * or null. Some built-in objects pass the test, e.g. Math which is a plain object\n * and some host or exotic objects may pass also.\n * {@link http://stackoverflow.com/a/5878101/1207670}\n * @param {*} obj\n * @returns {boolean}\n */\nexport function isPlainObject(obj) {\n  // Basic check for Type object that's not null\n  if (typeof obj === 'object' && obj !== null) {\n    // If Object.getPrototypeOf supported, use it\n    if (typeof Object.getPrototypeOf === 'function') {\n      const proto = Object.getPrototypeOf(obj);\n      return proto === Object.prototype || proto === null;\n    }\n\n    // Otherwise, use internal class\n    // This should be reliable as if getPrototypeOf not supported, is pre-ES5\n    return Object.prototype.toString.call(obj) === '[object Object]';\n  }\n\n  // Not an object\n  return false;\n}\n\n/**\n * @summary Merges the enumerable attributes of two objects\n * @memberOf PSV.utils\n * @description Replaces arrays and alters the target object.\n * @copyright Nicholas Fisher <nfisher110@gmail.com>\n * @param {Object} target\n * @param {Object} src\n * @returns {Object} target\n */\nexport function deepmerge(target, src) {\n  /* eslint-disable */\n  let first = src;\n\n  return (function merge(target, src) {\n    if (Array.isArray(src)) {\n      if (!target || !Array.isArray(target)) {\n        target = [];\n      }\n      else {\n        target.length = 0;\n      }\n      src.forEach(function(e, i) {\n        target[i] = merge(null, e);\n      });\n    }\n    else if (typeof src === 'object') {\n      if (!target || Array.isArray(target)) {\n        target = {};\n      }\n      Object.keys(src).forEach(function(key) {\n        if (typeof src[key] !== 'object' || !src[key] || !isPlainObject(src[key])) {\n          target[key] = src[key];\n        }\n        else if (src[key] != first) {\n          if (!target[key]) {\n            target[key] = merge(null, src[key]);\n          }\n          else {\n            merge(target[key], src[key]);\n          }\n        }\n      });\n    }\n    else {\n      target = src;\n    }\n\n    return target;\n  }(target, src));\n  /* eslint-enable */\n}\n\n/**\n * @summary Deeply clones an object\n * @memberOf PSV.utils\n * @param {Object} src\n * @returns {Object}\n */\nexport function clone(src) {\n  return deepmerge(null, src);\n}\n\n/**\n * @summery Test of an object is empty\n * @memberOf PSV.utils\n * @param {object} obj\n * @returns {boolean}\n */\nexport function isEmpty(obj) {\n  return !obj || (Object.keys(obj).length === 0 && obj.constructor === Object);\n}\n\n/**\n * @summary Loops over enumerable properties of an object\n * @memberOf PSV.utils\n * @param {Object} object\n * @param {Function} callback\n */\nexport function each(object, callback) {\n  Object.keys(object).forEach((key) => {\n    callback(object[key], key);\n  });\n}\n\n/**\n * @summary Returns if a valu is null or undefined\n * @memberOf PSV.utils\n * @param {*} val\n * @return {boolean}\n */\nexport function isNil(val) {\n  return val === null || val === undefined;\n}\n\n/**\n * @summary Returns the first non null non undefined parameter\n * @memberOf PSV.utils\n * @param {*} values\n * @return {*}\n */\nexport function firstNonNull(...values) {\n  for (const val of values) {\n    if (!isNil(val)) {\n      return val;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * @summary Returns deep equality between objects\n * {@link https://gist.github.com/egardner/efd34f270cc33db67c0246e837689cb9}\n * @param obj1\n * @param obj2\n * @return {boolean}\n * @private\n */\nexport function deepEqual(obj1, obj2) {\n  if (obj1 === obj2) {\n    return true;\n  }\n  else if (isObject(obj1) && isObject(obj2)) {\n    if (Object.keys(obj1).length !== Object.keys(obj2).length) {\n      return false;\n    }\n    for (const prop of Object.keys(obj1)) {\n      if (!deepEqual(obj1[prop], obj2[prop])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  else {\n    return false;\n  }\n}\n\nfunction isObject(obj) {\n  return typeof obj === 'object' && obj != null;\n}\n\n","import { LinearFilter, MathUtils, Quaternion, Texture } from 'three';\nimport { PSVError } from '../PSVError';\nimport { loop } from './math';\n\n/**\n * @summary Returns the plugin constructor from the imported object\n * For retrocompatibility with previous default exports\n * @memberOf PSV.utils\n * @package\n */\nexport function pluginInterop(plugin, target) {\n  if (plugin) {\n    for (const [, p] of [['_', plugin], ...Object.entries(plugin)]) {\n      if (p.prototype instanceof target) {\n        return p;\n      }\n    }\n  }\n  return null;\n}\n\n/**\n * @summary Builds an Error with name 'AbortError'\n * @memberOf PSV.utils\n * @return {Error}\n */\nexport function getAbortError() {\n  const error = new Error('Loading was aborted.');\n  error.name = 'AbortError';\n  return error;\n}\n\n/**\n * @summary Tests if an Error has name 'AbortError'\n * @memberOf PSV.utils\n * @param {Error} err\n * @return {boolean}\n */\nexport function isAbortError(err) {\n  return err?.name === 'AbortError';\n}\n\n/**\n * @summary Displays a warning in the console\n * @memberOf PSV.utils\n * @param {string} message\n */\nexport function logWarn(message) {\n  console.warn(`PhotoSphereViewer: ${message}`);\n}\n\n/**\n * @summary Checks if an object is a {PSV.ExtendedPosition}, ie has x/y or longitude/latitude\n * @memberOf PSV.utils\n * @param {object} object\n * @returns {boolean}\n */\nexport function isExtendedPosition(object) {\n  return [['x', 'y'], ['longitude', 'latitude']].some(([key1, key2]) => {\n    return object[key1] !== undefined && object[key2] !== undefined;\n  });\n}\n\n/**\n * @summary Returns the value of a given attribute in the panorama metadata\n * @memberOf PSV.utils\n * @param {string} data\n * @param {string} attr\n * @returns (number)\n */\nexport function getXMPValue(data, attr) {\n  // XMP data are stored in children\n  let result = data.match('<GPano:' + attr + '>(.*)</GPano:' + attr + '>');\n  if (result !== null) {\n    const val = parseInt(result[1], 10);\n    return isNaN(val) ? null : val;\n  }\n\n  // XMP data are stored in attributes\n  result = data.match('GPano:' + attr + '=\"(.*?)\"');\n  if (result !== null) {\n    const val = parseInt(result[1], 10);\n    return isNaN(val) ? null : val;\n  }\n\n  return null;\n}\n\n/**\n * @readonly\n * @private\n * @type {{top: string, left: string, bottom: string, center: string, right: string}}\n */\nconst CSS_POSITIONS = {\n  top   : '0%',\n  bottom: '100%',\n  left  : '0%',\n  right : '100%',\n  center: '50%',\n};\n\n/**\n * @summary Translate CSS values like \"top center\" or \"10% 50%\" as top and left positions\n * @memberOf PSV.utils\n * @description The implementation is as close as possible to the \"background-position\" specification\n * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/background-position}\n * @param {string|PSV.Point} value\n * @returns {PSV.Point}\n */\nexport function parsePosition(value) {\n  if (!value) {\n    return { x: 0.5, y: 0.5 };\n  }\n\n  if (typeof value === 'object') {\n    return value;\n  }\n\n  let tokens = value.toLocaleLowerCase().split(' ').slice(0, 2);\n\n  if (tokens.length === 1) {\n    if (CSS_POSITIONS[tokens[0]] !== undefined) {\n      tokens = [tokens[0], 'center'];\n    }\n    else {\n      tokens = [tokens[0], tokens[0]];\n    }\n  }\n\n  const xFirst = tokens[1] !== 'left' && tokens[1] !== 'right' && tokens[0] !== 'top' && tokens[0] !== 'bottom';\n\n  tokens = tokens.map(token => CSS_POSITIONS[token] || token);\n\n  if (!xFirst) {\n    tokens.reverse();\n  }\n\n  const parsed = tokens.join(' ').match(/^([0-9.]+)% ([0-9.]+)%$/);\n\n  if (parsed) {\n    return {\n      x: parseFloat(parsed[1]) / 100,\n      y: parseFloat(parsed[2]) / 100,\n    };\n  }\n  else {\n    return { x: 0.5, y: 0.5 };\n  }\n}\n\n/**\n * @readonly\n * @private\n */\nconst X_VALUES = ['left', 'center', 'right'];\n/**\n * @readonly\n * @private\n */\nconst Y_VALUES = ['top', 'center', 'bottom'];\n/**\n * @readonly\n * @private\n */\nconst POS_VALUES = [...X_VALUES, ...Y_VALUES];\n/**\n * @readonly\n * @private\n */\nconst CENTER = 'center';\n\n/**\n * @summary Parse a CSS-like position into an array of position keywords among top, bottom, left, right and center\n * @memberOf PSV.utils\n * @param {string | string[]} value\n * @param {object} [options]\n * @param {boolean} [options.allowCenter=true] allow \"center center\"\n * @param {boolean} [options.cssOrder=true] force CSS order (y axis then x axis)\n * @return {string[]}\n */\nexport function cleanPosition(value, { allowCenter, cssOrder } = { allowCenter: true, cssOrder: true }) {\n  if (!value) {\n    return null;\n  }\n\n  if (typeof value === 'string') {\n    value = value.split(' ');\n  }\n\n  if (value.length === 1) {\n    if (value[0] === CENTER) {\n      value = [CENTER, CENTER];\n    }\n    else if (X_VALUES.indexOf(value[0]) !== -1) {\n      value = [CENTER, value[0]];\n    }\n    else if (Y_VALUES.indexOf(value[0]) !== -1) {\n      value = [value[0], CENTER];\n    }\n  }\n\n  if (value.length !== 2 || POS_VALUES.indexOf(value[0]) === -1 || POS_VALUES.indexOf(value[1]) === -1) {\n    logWarn(`Unparsable position ${value}`);\n    return null;\n  }\n\n  if (!allowCenter && value[0] === CENTER && value[1] === CENTER) {\n    logWarn(`Invalid position center center`);\n    return null;\n  }\n\n  if (cssOrder && !positionIsOrdered(value)) {\n    value = [value[1], value[0]];\n  }\n  if (value[1] === CENTER && X_VALUES.indexOf(value[0]) !== -1) {\n    value = [CENTER, value[0]];\n  }\n  if (value[0] === CENTER && Y_VALUES.indexOf(value[1]) !== -1) {\n    value = [value[1], CENTER];\n  }\n\n  return value;\n}\n\n/**\n * @summary Checks if an array of two positions is ordered (y axis then x axis)\n * @param {string[]} value\n * @return {boolean}\n */\nexport function positionIsOrdered(value) {\n  return Y_VALUES.indexOf(value[0]) !== -1 && X_VALUES.indexOf(value[1]) !== -1;\n}\n\n/**\n * @summary Parses an speed\n * @memberOf PSV.utils\n * @param {string|number} speed - The speed, in radians/degrees/revolutions per second/minute\n * @returns {number} radians per second\n * @throws {PSV.PSVError} when the speed cannot be parsed\n */\nexport function parseSpeed(speed) {\n  let parsed;\n\n  if (typeof speed === 'string') {\n    const speedStr = speed.toString().trim();\n\n    // Speed extraction\n    let speedValue = parseFloat(speedStr.replace(/^(-?[0-9]+(?:\\.[0-9]*)?).*$/, '$1'));\n    const speedUnit = speedStr.replace(/^-?[0-9]+(?:\\.[0-9]*)?(.*)$/, '$1').trim();\n\n    // \"per minute\" -> \"per second\"\n    if (speedUnit.match(/(pm|per minute)$/)) {\n      speedValue /= 60;\n    }\n\n    // Which unit?\n    switch (speedUnit) {\n      // Degrees per minute / second\n      case 'dpm':\n      case 'degrees per minute':\n      case 'dps':\n      case 'degrees per second':\n        parsed = MathUtils.degToRad(speedValue);\n        break;\n\n      // Radians per minute / second\n      case 'rdpm':\n      case 'radians per minute':\n      case 'rdps':\n      case 'radians per second':\n        parsed = speedValue;\n        break;\n\n      // Revolutions per minute / second\n      case 'rpm':\n      case 'revolutions per minute':\n      case 'rps':\n      case 'revolutions per second':\n        parsed = speedValue * Math.PI * 2;\n        break;\n\n      // Unknown unit\n      default:\n        throw new PSVError('Unknown speed unit \"' + speedUnit + '\"');\n    }\n  }\n  else {\n    parsed = speed;\n  }\n\n  return parsed;\n}\n\n/**\n * @summary Parses an angle value in radians or degrees and returns a normalized value in radians\n * @memberOf PSV.utils\n * @param {string|number} angle - eg: 3.14, 3.14rad, 180deg\n * @param {boolean} [zeroCenter=false] - normalize between -Pi - Pi instead of 0 - 2*Pi\n * @param {boolean} [halfCircle=zeroCenter] - normalize between -Pi/2 - Pi/2 instead of -Pi - Pi\n * @returns {number}\n * @throws {PSV.PSVError} when the angle cannot be parsed\n */\nexport function parseAngle(angle, zeroCenter = false, halfCircle = zeroCenter) {\n  let parsed;\n\n  if (typeof angle === 'string') {\n    const match = angle.toLowerCase().trim().match(/^(-?[0-9]+(?:\\.[0-9]*)?)(.*)$/);\n\n    if (!match) {\n      throw new PSVError('Unknown angle \"' + angle + '\"');\n    }\n\n    const value = parseFloat(match[1]);\n    const unit = match[2];\n\n    if (unit) {\n      switch (unit) {\n        case 'deg':\n        case 'degs':\n          parsed = MathUtils.degToRad(value);\n          break;\n        case 'rad':\n        case 'rads':\n          parsed = value;\n          break;\n        default:\n          throw new PSVError('Unknown angle unit \"' + unit + '\"');\n      }\n    }\n    else {\n      parsed = value;\n    }\n  }\n  else if (typeof angle === 'number' && !isNaN(angle)) {\n    parsed = angle;\n  }\n  else {\n    throw new PSVError('Unknown angle \"' + angle + '\"');\n  }\n\n  parsed = loop(zeroCenter ? parsed + Math.PI : parsed, Math.PI * 2);\n\n  return zeroCenter ? MathUtils.clamp(parsed - Math.PI, -Math.PI / (halfCircle ? 2 : 1), Math.PI / (halfCircle ? 2 : 1)) : parsed;\n}\n\n/**\n * @summary Creates a THREE texture from an image\n * @memberOf PSV.utils\n * @param {HTMLImageElement | HTMLCanvasElement} img\n * @return {external:THREE.Texture}\n */\nexport function createTexture(img) {\n  const texture = new Texture(img);\n  texture.needsUpdate = true;\n  texture.minFilter = LinearFilter;\n  texture.generateMipmaps = false;\n  return texture;\n}\n\nconst quaternion = new Quaternion();\n\n/**\n * @summary Applies the inverse of Euler angles to a vector\n * @memberOf PSV.utils\n * @param {external:THREE.Vector3} vector\n * @param {external:THREE.Euler} euler\n */\nexport function applyEulerInverse(vector, euler) {\n  quaternion.setFromEuler(euler).invert();\n  vector.applyQuaternion(quaternion);\n}\n","import { EASINGS } from '../data/constants';\nimport { each } from './misc';\n\n/**\n * @callback OnTick\n * @summary Function called for each animation frame with computed properties\n * @memberOf PSV.utils.Animation\n * @param {Object.<string, number>} properties - current values\n * @param {float} progress - 0 to 1\n */\n\n/**\n * @summary Interpolation helper for animations\n * @memberOf PSV.utils\n * @description\n * Implements the Promise API with an additional \"cancel\" method.\n * The promise is resolved with `true` when the animation is completed and `false` if the animation is cancelled.\n * @example\n * const anim = new Animation({\n *     properties: {\n *         width: {start: 100, end: 200}\n *     },\n *     duration: 5000,\n *     onTick: (properties) => element.style.width = `${properties.width}px`;\n * });\n *\n * anim.then((completed) => ...);\n *\n * anim.cancel()\n */\nexport class Animation {\n\n  /**\n   * @param {Object} options\n   * @param {Object.<string, Object>} options.properties\n   * @param {number} options.properties[].start\n   * @param {number} options.properties[].end\n   * @param {number} options.duration\n   * @param {number} [options.delay=0]\n   * @param {string} [options.easing='linear']\n   * @param {PSV.utils.Animation.OnTick} options.onTick - called on each frame\n   */\n  constructor(options) {\n    this.__callbacks = [];\n\n    if (options) {\n      if (!options.easing || typeof options.easing === 'string') {\n        options.easing = EASINGS[options.easing || 'linear'];\n      }\n\n      this.__start = null;\n      this.options = options;\n\n      if (options.delay) {\n        this.__delayTimeout = setTimeout(() => {\n          this.__delayTimeout = null;\n          this.__animationFrame = window.requestAnimationFrame(t => this.__run(t));\n        }, options.delay);\n      }\n      else {\n        this.__animationFrame = window.requestAnimationFrame(t => this.__run(t));\n      }\n    }\n    else {\n      this.__resolved = true;\n    }\n  }\n\n  /**\n   * @summary Main loop for the animation\n   * @param {number} timestamp\n   * @private\n   */\n  __run(timestamp) {\n    if (this.__cancelled) {\n      return;\n    }\n\n    // first iteration\n    if (this.__start === null) {\n      this.__start = timestamp;\n    }\n\n    // compute progress\n    const progress = (timestamp - this.__start) / this.options.duration;\n    const current = {};\n\n    if (progress < 1.0) {\n      // interpolate properties\n      each(this.options.properties, (prop, name) => {\n        if (prop) {\n          current[name] = prop.start + (prop.end - prop.start) * this.options.easing(progress);\n        }\n      });\n      this.options.onTick(current, progress);\n\n      this.__animationFrame = window.requestAnimationFrame(t => this.__run(t));\n    }\n    else {\n      // call onTick one last time with final values\n      each(this.options.properties, (prop, name) => {\n        if (prop) {\n          current[name] = prop.end;\n        }\n      });\n      this.options.onTick(current, 1.0);\n\n      this.__animationFrame = window.requestAnimationFrame(() => {\n        this.__resolved = true;\n        this.__resolve(true);\n      });\n    }\n  }\n\n  /**\n   * @private\n   */\n  __resolve(value) {\n    this.__callbacks.forEach(cb => cb(value));\n    this.__callbacks.length = 0;\n  }\n\n  /**\n   * @summary Promise chaining\n   * @param {Function} [onFulfilled] - Called when the animation is complete (true) or cancelled (false)\n   * @returns {Promise}\n   */\n  then(onFulfilled) {\n    if (this.__resolved || this.__cancelled) {\n      return Promise.resolve(this.__resolved)\n        .then(onFulfilled);\n    }\n\n    return new Promise((resolve) => {\n      this.__callbacks.push(resolve);\n    })\n      .then(onFulfilled);\n  }\n\n  /**\n   * @summary Cancels the animation\n   */\n  cancel() {\n    if (!this.__cancelled && !this.__resolved) {\n      this.__cancelled = true;\n      this.__resolve(false);\n\n      if (this.__delayTimeout) {\n        window.clearTimeout(this.__delayTimeout);\n        this.__delayTimeout = null;\n      }\n      if (this.__animationFrame) {\n        window.cancelAnimationFrame(this.__animationFrame);\n        this.__animationFrame = null;\n      }\n    }\n  }\n\n}\n","import { MathUtils } from 'three';\nimport { PSVError } from '../PSVError';\nimport { loop } from './math';\n\n/**\n * @summary Represents a variable that can dynamically change with time (using requestAnimationFrame)\n * @memberOf PSV.utils\n */\nexport class Dynamic {\n\n  static STOP = 0;\n  static INFINITE = 1;\n  static POSITION = 2;\n\n  /**\n   * @param {Function} [fn] Callback function\n   * @param {number} [defaultValue] Default position\n   * @param {number} [min] Minimum position\n   * @param {number} [max] Maximum position\n   * @param {boolean} [loopValue] Loop value between min and max\n   */\n  constructor(fn, defaultValue = 0, min = -Infinity, max = Infinity, loopValue = false) {\n    /**\n     * @type {Function}\n     * @private\n     * @readonly\n     */\n    this.fn = fn;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.mode = Dynamic.STOP;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.speed = 0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.speedMult = 1;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.currentSpeed = 0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.target = 0;\n\n    /**\n     * @type {number}\n     * @readonly\n     */\n    this.current = defaultValue;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.min = min;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.max = max;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.loopValue = loopValue;\n\n    if (loopValue && min !== 0) {\n      throw new PSVError('invalid config');\n    }\n\n    if (this.fn) {\n      this.fn(defaultValue);\n    }\n  }\n\n  /**\n   * Changes base speed\n   * @param {number} speed\n   */\n  setSpeed(speed) {\n    this.speed = speed;\n  }\n\n  /**\n   * Defines the target position\n   * @param {number} position\n   * @param {number} [speedMult=1]\n   */\n  goto(position, speedMult = 1) {\n    this.mode = Dynamic.POSITION;\n    this.target = this.loopValue ? loop(position, this.max) : MathUtils.clamp(position, this.min, this.max);\n    this.speedMult = speedMult;\n  }\n\n  /**\n   * Increase/decrease the target position\n   * @param {number} step\n   * @param {number} [speedMult=1]\n   */\n  step(step, speedMult = 1) {\n    if (this.mode !== Dynamic.POSITION) {\n      this.target = this.current;\n    }\n    this.goto(this.target + step, speedMult);\n  }\n\n  /**\n   * Starts infinite movement\n   * @param {boolean} [invert=false]\n   * @param {number} [speedMult=1]\n   */\n  roll(invert = false, speedMult = 1) {\n    this.mode = Dynamic.INFINITE;\n    this.target = invert ? -Infinity : Infinity;\n    this.speedMult = speedMult;\n  }\n\n  /**\n   * Stops movement\n   */\n  stop() {\n    this.mode = Dynamic.STOP;\n  }\n\n  /**\n   * Defines the current position and immediately stops movement\n   * @param {number} value\n   */\n  setValue(value) {\n    this.target = this.loopValue ? loop(value, this.max) : MathUtils.clamp(value, this.min, this.max);\n    this.mode = Dynamic.STOP;\n    if (this.target !== this.current) {\n      this.current = this.target;\n      if (this.fn) {\n        this.fn(this.current);\n      }\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @package\n   */\n  update(elapsed) {\n    // in position mode switch to stop mode when in the decceleration window\n    if (this.mode === Dynamic.POSITION) {\n      // in loop mode, alter \"current\" to avoid crossing the origin\n      if (this.loopValue && Math.abs(this.target - this.current) > this.max / 2) {\n        this.current = this.current < this.target ? this.current + this.max : this.current - this.max;\n      }\n\n      const dstStop = this.currentSpeed * this.currentSpeed / (this.speed * this.speedMult * 4);\n      if (Math.abs(this.target - this.current) <= dstStop) {\n        this.mode = Dynamic.STOP;\n      }\n    }\n\n    // compute speed\n    let targetSpeed = this.mode === Dynamic.STOP ? 0 : this.speed * this.speedMult;\n    if (this.target < this.current) {\n      targetSpeed = -targetSpeed;\n    }\n    if (this.currentSpeed < targetSpeed) {\n      this.currentSpeed = Math.min(targetSpeed, this.currentSpeed + elapsed / 1000 * this.speed * this.speedMult * 2);\n    }\n    else if (this.currentSpeed > targetSpeed) {\n      this.currentSpeed = Math.max(targetSpeed, this.currentSpeed - elapsed / 1000 * this.speed * this.speedMult * 2);\n    }\n\n    // compute new position\n    let next = null;\n    if (this.current > this.target && this.currentSpeed) {\n      next = Math.max(this.target, this.current + this.currentSpeed * elapsed / 1000);\n    }\n    else if (this.current < this.target && this.currentSpeed) {\n      next = Math.min(this.target, this.current + this.currentSpeed * elapsed / 1000);\n    }\n\n    // apply value\n    if (next !== null) {\n      next = this.loopValue ? loop(next, this.max) : MathUtils.clamp(next, this.min, this.max);\n      if (next !== this.current) {\n        this.current = next;\n        if (this.fn) {\n          this.fn(this.current);\n        }\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n}\n","import { each } from './misc';\n\n/**\n * @summary Wrapper for multiple {@link PSV.utils.Dynamic} evolving together\n * @memberOf PSV.utils\n */\nexport class MultiDynamic {\n\n  /**\n   * @type {Object<string, number>}\n   * @readonly\n   */\n  get current() {\n    const values = {};\n    each(this.dynamics, (dynamic, name) => {\n      values[name] = dynamic.current;\n    });\n    return values;\n  }\n\n  /**\n   * @param {Record<string, PSV.utils.Dynamic>} dynamics\n   * @param {Function} [fn] Callback function\n   */\n  constructor(dynamics, fn) {\n    /**\n     * @type {Function}\n     * @private\n     * @readonly\n     */\n    this.fn = fn;\n\n    /**\n     * @type {Record<string, PSV.utils.Dynamic>}\n     * @private\n     * @readonly\n     */\n    this.dynamics = dynamics;\n\n    if (this.fn) {\n      this.fn(this.current);\n    }\n  }\n\n  /**\n   * Changes base speed\n   * @param {number} speed\n   */\n  setSpeed(speed) {\n    each(this.dynamics, (d) => {\n      d.setSpeed(speed);\n    });\n  }\n\n  /**\n   * Defines the target positions\n   * @param {Record<string, number>} positions\n   * @param {number} [speedMult=1]\n   */\n  goto(positions, speedMult = 1) {\n    each(positions, (position, name) => {\n      this.dynamics[name].goto(position, speedMult);\n    });\n  }\n\n  /**\n   * Increase/decrease the target positions\n   * @param {Record<string, number>} steps\n   * @param {number} [speedMult=1]\n   */\n  step(steps, speedMult = 1) {\n    each(steps, (step, name) => {\n      this.dynamics[name].step(step, speedMult);\n    });\n  }\n\n  /**\n   * Starts infinite movements\n   * @param {Record<string, boolean>} rolls\n   * @param {number} [speedMult=1]\n   */\n  roll(rolls, speedMult = 1) {\n    each(rolls, (roll, name) => {\n      this.dynamics[name].roll(roll, speedMult);\n    });\n  }\n\n  /**\n   * Stops movements\n   */\n  stop() {\n    each(this.dynamics, d => d.stop());\n  }\n\n  /**\n   * Defines the current positions and immediately stops movements\n   * @param {Record<string, number>} values\n   */\n  setValue(values) {\n    let hasUpdates = false;\n    each(values, (value, name) => {\n      hasUpdates |= this.dynamics[name].setValue(value);\n    });\n\n    if (hasUpdates && this.fn) {\n      this.fn(this.current);\n    }\n\n    return hasUpdates;\n  }\n\n  /**\n   * @package\n   */\n  update(elapsed) {\n    let hasUpdates = false;\n    each(this.dynamics, (dynamic) => {\n      hasUpdates |= dynamic.update(elapsed);\n    });\n\n    if (hasUpdates && this.fn) {\n      this.fn(this.current);\n    }\n\n    return hasUpdates;\n  }\n\n}\n","import { EventEmitter } from 'uevent';\n\n/**\n * @summary Helper to make sliders elements\n * @memberOf PSV.utils\n */\nexport class Slider extends EventEmitter {\n\n  static VERTICAL = 1;\n  static HORIZONTAL = 2;\n\n  /**\n   * @type {boolean}\n   * @readonly\n   */\n  get vertical() {\n    return this.prop.direction === Slider.VERTICAL;\n  }\n\n  constructor({ psv, container, direction, onUpdate }) {\n    super();\n\n    /**\n     * @summary Reference to main controller\n     * @type {PSV.Viewer}\n     * @readonly\n     */\n    this.psv = psv;\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     */\n    this.container = container;\n\n    /**\n     * @summary Internal properties\n     * @member {Object}\n     * @protected\n     * @property {boolean} mousedown\n     * @property {number} mediaMinWidth\n     */\n    this.prop = {\n      onUpdate : onUpdate,\n      direction: direction,\n      mousedown: false,\n      mouseover: false,\n    };\n\n    this.container.addEventListener('click', this);\n    this.container.addEventListener('mousedown', this);\n    this.container.addEventListener('mouseenter', this);\n    this.container.addEventListener('mouseleave', this);\n    this.container.addEventListener('touchstart', this);\n    this.container.addEventListener('mousemove', this, true);\n    this.container.addEventListener('touchmove', this, true);\n    window.addEventListener('mouseup', this);\n    window.addEventListener('touchend', this);\n  }\n\n  /**\n   * @protected\n   */\n  destroy() {\n    window.removeEventListener('mouseup', this);\n    window.removeEventListener('touchend', this);\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case 'click':      e.stopPropagation();    break;\n      case 'mousedown':  this.__onMouseDown(e);  break;\n      case 'mouseenter': this.__onMouseEnter(e); break;\n      case 'mouseleave': this.__onMouseLeave(e); break;\n      case 'touchstart': this.__onTouchStart(e); break;\n      case 'mousemove':  this.__onMouseMove(e);  break;\n      case 'touchmove':  this.__onTouchMove(e);  break;\n      case 'mouseup':    this.__onMouseUp(e);    break;\n      case 'touchend':   this.__onTouchEnd(e);   break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @private\n   */\n  __onMouseDown(evt) {\n    this.prop.mousedown = true;\n    this.__update(evt, true);\n  }\n\n  /**\n   * @private\n   */\n  __onMouseEnter(evt) {\n    this.prop.mouseover = true;\n    this.__update(evt, true);\n  }\n\n  /**\n   * @private\n   */\n  __onTouchStart(evt) {\n    this.prop.mouseover = true;\n    this.prop.mousedown = true;\n    this.__update(evt.changedTouches[0], true);\n  }\n\n  /**\n   * @private\n   */\n  __onMouseMove(evt) {\n    if (this.prop.mousedown || this.prop.mouseover) {\n      evt.stopPropagation();\n      this.__update(evt, true);\n    }\n  }\n\n  /**\n   * @private\n   */\n  __onTouchMove(evt) {\n    if (this.prop.mousedown || this.prop.mouseover) {\n      evt.stopPropagation();\n      this.__update(evt.changedTouches[0], true);\n    }\n  }\n\n  /**\n   * @private\n   */\n  __onMouseUp(evt) {\n    if (this.prop.mousedown) {\n      this.prop.mousedown = false;\n      this.__update(evt, false);\n    }\n  }\n\n  /**\n   * @private\n   */\n  __onMouseLeave(evt) {\n    if (this.prop.mouseover) {\n      this.prop.mouseover = false;\n      this.__update(evt, true);\n    }\n  }\n\n  /**\n   * @private\n   */\n  __onTouchEnd(evt) {\n    if (this.prop.mousedown) {\n      this.prop.mouseover = false;\n      this.prop.mousedown = false;\n      this.__update(evt.changedTouches[0], false);\n    }\n  }\n\n  /**\n   * @private\n   */\n  __update(evt, moving) {\n    const boundingClientRect = this.container.getBoundingClientRect();\n    const cursor = evt[this.vertical ? 'clientY' : 'clientX'];\n    const pos = boundingClientRect[this.vertical ? 'bottom' : 'left'];\n    const size = boundingClientRect[this.vertical ? 'height' : 'width'];\n    const val = Math.abs((pos - cursor) / size);\n\n    this.prop.onUpdate({\n      value    : val,\n      click    : !moving,\n      mousedown: this.prop.mousedown,\n      mouseover: this.prop.mouseover,\n      cursor   : evt,\n    });\n  }\n\n}\n","/**\n * @namespace PSV.utils\n */\n\nexport * from './browser';\nexport * from './math';\nexport * from './misc';\nexport * from './psv';\n\nexport * from './Animation';\nexport * from './Dynamic';\nexport * from './MultiDynamic';\nexport * from './Slider';\n","import { MathUtils, Mesh, SphereGeometry, Texture } from 'three';\nimport { SPHERE_RADIUS } from '../../data/constants';\nimport { SYSTEM } from '../../data/system';\nimport { PSVError } from '../../PSVError';\nimport { createTexture, firstNonNull, getXMPValue, logWarn } from '../../utils';\nimport { AbstractAdapter } from '../AbstractAdapter';\n\n\n/**\n * @typedef {Object} PSV.adapters.EquirectangularAdapter.Options\n * @property {number} [resolution=64] - number of faces of the sphere geometry, higher values may decrease performances\n */\n\n\n/**\n * @summary Adapter for equirectangular panoramas\n * @memberof PSV.adapters\n * @extends PSV.adapters.AbstractAdapter\n */\nexport class EquirectangularAdapter extends AbstractAdapter {\n\n  static id = 'equirectangular';\n  static supportsDownload = true;\n  static supportsOverlay = true;\n\n  /**\n   * @param {PSV.Viewer} psv\n   * @param {PSV.adapters.EquirectangularAdapter.Options} options\n   */\n  constructor(psv, options) {\n    super(psv);\n\n    /**\n     * @member {PSV.adapters.EquirectangularAdapter.Options}\n     * @private\n     */\n    this.config = {\n      resolution: 64,\n      ...options,\n    };\n\n    if (!MathUtils.isPowerOfTwo(this.config.resolution)) {\n      throw new PSVError('EquirectangularAdapter resolution must be power of two');\n    }\n\n    this.SPHERE_SEGMENTS = this.config.resolution;\n    this.SPHERE_HORIZONTAL_SEGMENTS = this.SPHERE_SEGMENTS / 2;\n  }\n\n  /**\n   * @override\n   */\n  supportsTransition() {\n    return true;\n  }\n\n  /**\n   * @override\n   */\n  supportsPreload() {\n    return true;\n  }\n\n  /**\n   * @override\n   * @param {string} panorama\n   * @param {PSV.PanoData | PSV.PanoDataProvider} [newPanoData]\n   * @param {boolean} [useXmpPanoData]\n   * @returns {Promise.<PSV.TextureData>}\n   */\n  loadTexture(panorama, newPanoData, useXmpPanoData = this.psv.config.useXmpData) {\n    if (typeof panorama !== 'string') {\n      if (Array.isArray(panorama) || typeof panorama === 'object' && !!panorama.left) {\n        logWarn('Cubemap support now requires an additional adapter, see https://photo-sphere-viewer.js.org/guide/adapters');\n      }\n      return Promise.reject(new PSVError('Invalid panorama url, are you using the right adapter?'));\n    }\n\n    return (\n      useXmpPanoData\n        ? this.__loadXMP(panorama, p => this.psv.loader.setProgress(p))\n          .then(xmpPanoData => this.psv.textureLoader.loadImage(panorama).then(img => ({ img, xmpPanoData })))\n        : this.psv.textureLoader.loadImage(panorama, p => this.psv.loader.setProgress(p))\n          .then(img => ({ img: img, xmpPanoData: null }))\n    )\n      .then(({ img, xmpPanoData }) => {\n        if (typeof newPanoData === 'function') {\n          newPanoData = newPanoData(img);\n        }\n\n        const panoData = {\n          fullWidth    : firstNonNull(newPanoData?.fullWidth, xmpPanoData?.fullWidth, img.width),\n          fullHeight   : firstNonNull(newPanoData?.fullHeight, xmpPanoData?.fullHeight, img.height),\n          croppedWidth : firstNonNull(newPanoData?.croppedWidth, xmpPanoData?.croppedWidth, img.width),\n          croppedHeight: firstNonNull(newPanoData?.croppedHeight, xmpPanoData?.croppedHeight, img.height),\n          croppedX     : firstNonNull(newPanoData?.croppedX, xmpPanoData?.croppedX, 0),\n          croppedY     : firstNonNull(newPanoData?.croppedY, xmpPanoData?.croppedY, 0),\n          poseHeading  : firstNonNull(newPanoData?.poseHeading, xmpPanoData?.poseHeading, 0),\n          posePitch    : firstNonNull(newPanoData?.posePitch, xmpPanoData?.posePitch, 0),\n          poseRoll     : firstNonNull(newPanoData?.poseRoll, xmpPanoData?.poseRoll, 0),\n        };\n\n        if (panoData.croppedWidth !== img.width || panoData.croppedHeight !== img.height) {\n          logWarn(`Invalid panoData, croppedWidth and/or croppedHeight is not coherent with loaded image.\n    panoData: ${panoData.croppedWidth}x${panoData.croppedHeight}, image: ${img.width}x${img.height}`);\n        }\n        if ((newPanoData || xmpPanoData) && panoData.fullWidth !== panoData.fullHeight * 2) {\n          logWarn('Invalid panoData, fullWidth should be twice fullHeight');\n        }\n\n        const texture = this.__createEquirectangularTexture(img, panoData);\n\n        return { panorama, texture, panoData };\n      });\n  }\n\n  /**\n   * @summary Loads the XMP data of an image\n   * @param {string} panorama\n   * @param {function(number)} [onProgress]\n   * @returns {Promise<PSV.PanoData>}\n   * @throws {PSV.PSVError} when the image cannot be loaded\n   * @private\n   */\n  __loadXMP(panorama, onProgress) {\n    return this.psv.textureLoader.loadFile(panorama, onProgress)\n      .then(blob => this.__loadBlobAsString(blob))\n      .then((binary) => {\n        const a = binary.indexOf('<x:xmpmeta');\n        const b = binary.indexOf('</x:xmpmeta>');\n        const data = binary.substring(a, b);\n\n        if (a !== -1 && b !== -1 && data.includes('GPano:')) {\n          return {\n            fullWidth    : getXMPValue(data, 'FullPanoWidthPixels'),\n            fullHeight   : getXMPValue(data, 'FullPanoHeightPixels'),\n            croppedWidth : getXMPValue(data, 'CroppedAreaImageWidthPixels'),\n            croppedHeight: getXMPValue(data, 'CroppedAreaImageHeightPixels'),\n            croppedX     : getXMPValue(data, 'CroppedAreaLeftPixels'),\n            croppedY     : getXMPValue(data, 'CroppedAreaTopPixels'),\n            poseHeading  : getXMPValue(data, 'PoseHeadingDegrees'),\n            posePitch    : getXMPValue(data, 'PosePitchDegrees'),\n            poseRoll     : getXMPValue(data, 'PoseRollDegrees'),\n          };\n        }\n\n        return null;\n      });\n  }\n\n  /**\n   * @summmary read a Blob as string\n   * @param {Blob} blob\n   * @returns {Promise<string>}\n   * @private\n   */\n  __loadBlobAsString(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsText(blob);\n    });\n  }\n\n  /**\n   * @summary Creates the final texture from image and panorama data\n   * @param {Image} img\n   * @param {PSV.PanoData} panoData\n   * @returns {external:THREE.Texture}\n   * @private\n   */\n  __createEquirectangularTexture(img, panoData) {\n    // resize image / fill cropped parts with black\n    if (panoData.fullWidth > SYSTEM.maxTextureWidth\n      || panoData.croppedWidth !== panoData.fullWidth\n      || panoData.croppedHeight !== panoData.fullHeight\n    ) {\n      const ratio = SYSTEM.getMaxCanvasWidth() / panoData.fullWidth;\n\n      const resizedPanoData = { ...panoData };\n      if (ratio < 1) {\n        resizedPanoData.fullWidth *= ratio;\n        resizedPanoData.fullHeight *= ratio;\n        resizedPanoData.croppedWidth *= ratio;\n        resizedPanoData.croppedHeight *= ratio;\n        resizedPanoData.croppedX *= ratio;\n        resizedPanoData.croppedY *= ratio;\n      }\n\n      const buffer = document.createElement('canvas');\n      buffer.width = resizedPanoData.fullWidth;\n      buffer.height = resizedPanoData.fullHeight;\n\n      const ctx = buffer.getContext('2d');\n      ctx.drawImage(img,\n        resizedPanoData.croppedX, resizedPanoData.croppedY,\n        resizedPanoData.croppedWidth, resizedPanoData.croppedHeight);\n\n      return createTexture(buffer);\n    }\n\n    return createTexture(img);\n  }\n\n  /**\n   * @override\n   */\n  createMesh(scale = 1) {\n    // The middle of the panorama is placed at longitude=0\n    const geometry = new SphereGeometry(\n      SPHERE_RADIUS * scale,\n      this.SPHERE_SEGMENTS,\n      this.SPHERE_HORIZONTAL_SEGMENTS,\n      -Math.PI / 2\n    )\n      .scale(-1, 1, 1);\n\n    const material = AbstractAdapter.createOverlayMaterial();\n\n    return new Mesh(geometry, material);\n  }\n\n  /**\n   * @override\n   */\n  setTexture(mesh, textureData) {\n    this.__setUniform(mesh, AbstractAdapter.OVERLAY_UNIFORMS.panorama, textureData.texture);\n    this.setOverlay(mesh, null);\n  }\n\n  /**\n   * @override\n   */\n  setOverlay(mesh, textureData, opacity) {\n    this.__setUniform(mesh, AbstractAdapter.OVERLAY_UNIFORMS.overlayOpacity, opacity);\n    if (!textureData) {\n      this.__setUniform(mesh, AbstractAdapter.OVERLAY_UNIFORMS.overlay, new Texture());\n    }\n    else {\n      this.__setUniform(mesh, AbstractAdapter.OVERLAY_UNIFORMS.overlay, textureData.texture);\n    }\n  }\n\n  /**\n   * @override\n   */\n  setTextureOpacity(mesh, opacity) {\n    this.__setUniform(mesh, AbstractAdapter.OVERLAY_UNIFORMS.globalOpacity, opacity);\n    mesh.material.transparent = opacity < 1;\n  }\n\n  /**\n   * @override\n   */\n  disposeTexture(textureData) {\n    textureData.texture?.dispose();\n  }\n\n  /**\n   * @param {external:THREE.Mesh} mesh\n   * @param {string} uniform\n   * @param {*} value\n   * @private\n   */\n  __setUniform(mesh, uniform, value) {\n    if (mesh.material.uniforms[uniform].value instanceof Texture) {\n      mesh.material.uniforms[uniform].value.dispose();\n    }\n    mesh.material.uniforms[uniform].value = value;\n  }\n\n}\n","/**\n * @namespace PSV.components\n */\n\n/**\n * @summary Base component class\n * @memberof PSV.components\n * @abstract\n */\nexport class AbstractComponent {\n\n  /**\n   * @param {PSV.Viewer | PSV.components.AbstractComponent} parent\n   * @param {string} className - CSS class added to the component's container\n   */\n  constructor(parent, className) {\n    /**\n     * @summary Reference to main controller\n     * @type {PSV.Viewer}\n     * @readonly\n     */\n    this.psv = parent.psv || parent;\n\n    /**\n     * @member {PSV.Viewer|PSV.components.AbstractComponent}\n     * @readonly\n     */\n    this.parent = parent;\n    this.parent.children.push(this);\n\n    /**\n     * @summary All child components\n     * @type {PSV.components.AbstractComponent[]}\n     * @readonly\n     * @package\n     */\n    this.children = [];\n\n    /**\n     * @summary Internal properties\n     * @member {Object}\n     * @protected\n     * @property {boolean} visible - Visibility of the component\n     */\n    this.prop = {\n      visible: true,\n    };\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     */\n    this.container = document.createElement('div');\n    this.container.className = className;\n    this.parent.container.appendChild(this.container);\n  }\n\n  /**\n   * @summary Destroys the component\n   * @protected\n   */\n  destroy() {\n    this.parent.container.removeChild(this.container);\n\n    const childIdx = this.parent.children.indexOf(this);\n    if (childIdx !== -1) {\n      this.parent.children.splice(childIdx, 1);\n    }\n\n    this.children.slice().forEach(child => child.destroy());\n    this.children.length = 0;\n\n    delete this.container;\n    delete this.parent;\n    delete this.psv;\n    delete this.prop;\n  }\n\n  /**\n   * @summary Refresh UI\n   * @description Must be be a very lightweight operation\n   * @package\n   */\n  refreshUi() {\n    this.children.every((child) => {\n      child.refreshUi();\n      return this.psv.prop.uiRefresh === true;\n    });\n  }\n\n  /**\n   * @summary Displays or hides the component\n   * @param {boolean} [visible] - forced state\n   */\n  toggle(visible) {\n    if (visible === false || visible === undefined && this.isVisible()) {\n      this.hide();\n    }\n    else if (visible === true || visible === undefined && !this.isVisible()) {\n      this.show();\n    }\n  }\n\n  /**\n   * @summary Hides the component\n   */\n  hide() {\n    this.container.style.display = 'none';\n    this.prop.visible = false;\n  }\n\n  /**\n   * @summary Displays the component\n   */\n  show() {\n    this.container.style.display = '';\n    this.prop.visible = true;\n  }\n\n  /**\n   * @summary Checks if the component is visible\n   * @returns {boolean}\n   */\n  isVisible() {\n    return this.prop.visible;\n  }\n\n}\n","import { AbstractComponent } from '../components/AbstractComponent';\nimport { KEY_CODES } from '../data/constants';\nimport { PSVError } from '../PSVError';\nimport { isPlainObject, toggleClass } from '../utils';\n\n/**\n * @namespace PSV.buttons\n */\n\n/**\n * @summary Base navbar button class\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.buttons\n * @abstract\n */\nexport class AbstractButton extends AbstractComponent {\n\n  /**\n   * @summary Unique identifier of the button\n   * @member {string}\n   * @readonly\n   * @static\n   */\n  static id = null;\n\n  /**\n   * @summary Identifier to declare a group of buttons\n   * @member {string}\n   * @readonly\n   * @static\n   */\n  static groupId = null;\n\n  /**\n   * @summary SVG icon name injected in the button\n   * @member {string}\n   * @readonly\n   * @static\n   */\n  static icon = null;\n\n  /**\n   * @summary SVG icon name injected in the button when it is active\n   * @member {string}\n   * @readonly\n   * @static\n   */\n  static iconActive = null;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   * @param {string} [className] - Additional CSS classes\n   * @param {boolean} [collapsable=false] - `true` if the button can be moved to menu when the navbar is too small\n   * @param {boolean} [tabbable=true] - `true` if the button is accessible with the keyboard\n   */\n  constructor(navbar, className = '', collapsable = false, tabbable = true) {\n    super(navbar, 'psv-button ' + className);\n\n    /**\n     * @override\n     * @property {string} id - Unique identifier of the button\n     * @property {boolean} enabled\n     * @property {boolean} supported\n     * @property {boolean} collapsed\n     * @property {boolean} active\n     * @property {number} width\n     */\n    this.prop = {\n      ...this.prop,\n      id         : this.constructor.id,\n      collapsable: collapsable,\n      enabled    : true,\n      supported  : true,\n      collapsed  : false,\n      active     : false,\n      width      : this.container.offsetWidth,\n    };\n\n    if (this.constructor.icon) {\n      this.__setIcon(this.constructor.icon);\n    }\n\n    if (this.prop.id && this.psv.config.lang[this.prop.id]) {\n      this.container.title = this.psv.config.lang[this.prop.id];\n    }\n\n    if (tabbable) {\n      this.container.tabIndex = 0;\n    }\n\n    this.container.addEventListener('click', (e) => {\n      if (this.prop.enabled) {\n        this.onClick();\n      }\n      e.stopPropagation();\n    });\n\n    this.container.addEventListener('keydown', (e) => {\n      if (e.key === KEY_CODES.Enter && this.prop.enabled) {\n        this.onClick();\n        e.stopPropagation();\n      }\n    });\n  }\n\n  /**\n   * @package\n   */\n  checkSupported() {\n    const supportedOrObject = this.isSupported();\n    if (isPlainObject(supportedOrObject)) {\n      if (supportedOrObject.initial === false) {\n        this.hide();\n        this.prop.supported = false;\n      }\n\n      supportedOrObject.promise.then((supported) => {\n        if (!this.prop) {\n          return; // the component has been destroyed\n        }\n        this.prop.supported = supported;\n        this.toggle(supported);\n      });\n    }\n    else {\n      this.prop.supported = supportedOrObject;\n      if (!supportedOrObject) {\n        this.hide();\n      }\n    }\n  }\n\n  /**\n   * @summary Checks if the button can be displayed\n   * @returns {boolean|{initial: boolean, promise: Promise<boolean>}}\n   */\n  isSupported() {\n    return true;\n  }\n\n  /**\n   * @summary Changes the active state of the button\n   * @param {boolean} [active] - forced state\n   */\n  toggleActive(active) {\n    this.prop.active = active !== undefined ? active : !this.prop.active;\n    toggleClass(this.container, 'psv-button--active', this.prop.active);\n\n    if (this.constructor.iconActive) {\n      this.__setIcon(this.prop.active ? this.constructor.iconActive : this.constructor.icon);\n    }\n  }\n\n  /**\n   * @override\n   */\n  show(refresh = true) {\n    if (!this.isVisible()) {\n      this.prop.visible = true;\n      if (!this.prop.collapsed) {\n        this.container.style.display = '';\n      }\n      if (refresh) {\n        this.psv.refreshUi(`show button ${this.prop.id}`);\n      }\n    }\n  }\n\n  /**\n   * @override\n   */\n  hide(refresh = true) {\n    if (this.isVisible()) {\n      this.prop.visible = false;\n      this.container.style.display = 'none';\n      if (refresh) {\n        this.psv.refreshUi(`hide button ${this.prop.id}`);\n      }\n    }\n  }\n\n  /**\n   * @summary Disables the button\n   */\n  disable() {\n    this.container.classList.add('psv-button--disabled');\n    this.prop.enabled = false;\n  }\n\n  /**\n   * @summary Enables the button\n   */\n  enable() {\n    this.container.classList.remove('psv-button--disabled');\n    this.prop.enabled = true;\n  }\n\n  /**\n   * @summary Collapses the button in the navbar menu\n   */\n  collapse() {\n    this.prop.collapsed = true;\n    this.container.style.display = 'none';\n  }\n\n  /**\n   * @summary Uncollapses the button from the navbar menu\n   */\n  uncollapse() {\n    this.prop.collapsed = false;\n    if (this.prop.visible) {\n      this.container.style.display = '';\n    }\n  }\n\n  /**\n   * @summary Set the button icon\n   * @param {string} icon SVG\n   * @param {HTMLElement} [container] - default is the main button container\n   * @private\n   */\n  __setIcon(icon, container = this.container) {\n    if (icon) {\n      container.innerHTML = icon;\n      // className is read-only on SVGElement\n      container.querySelector('svg').classList.add('psv-button-svg');\n    }\n    else {\n      container.innerHTML = '';\n    }\n  }\n\n  /**\n   * @summary Action when the button is clicked\n   * @private\n   * @abstract\n   */\n  onClick() {\n    throw new PSVError(`onClick not implemented for button \"${this.prop.id}\".`);\n  }\n\n}\n","import { EVENTS } from '../data/constants';\nimport playActive from '../icons/play-active.svg';\nimport play from '../icons/play.svg';\nimport { AbstractButton } from './AbstractButton';\n\n/**\n * @summary Navigation bar autorotate button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class AutorotateButton extends AbstractButton {\n\n  static id = 'autorotate';\n  static icon = play;\n  static iconActive = playActive;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-autorotate-button', true);\n\n    this.psv.on(EVENTS.AUTOROTATE, this);\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(EVENTS.AUTOROTATE, this);\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case EVENTS.AUTOROTATE: this.toggleActive(e.args[0]); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @description Toggles autorotate\n   */\n  onClick() {\n    if (this.psv.isAutorotateEnabled()) {\n      this.psv.config.autorotateIdle = false;\n      this.psv.resetIdleTimer();\n    }\n    this.psv.toggleAutorotate();\n  }\n\n}\n","import { addClasses } from '../utils';\nimport { AbstractButton } from './AbstractButton';\n\n/**\n * @summary Navigation bar custom button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class CustomButton extends AbstractButton {\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   * @param {PSV.NavbarCustomButton} config\n   */\n  constructor(navbar, config) {\n    super(navbar, 'psv-custom-button', config.collapsable !== false, config.tabbable !== false);\n\n    /**\n     * @member {Object}\n     * @readonly\n     * @private\n     */\n    this.config = config;\n\n    if (this.config.id) {\n      this.prop.id = this.config.id;\n    }\n    else {\n      this.prop.id = 'psvButton-' + Math.random().toString(36).substr(2, 9);\n    }\n\n    if (this.config.className) {\n      addClasses(this.container, this.config.className);\n    }\n\n    if (this.config.title) {\n      this.container.title = this.config.title;\n    }\n\n    if (this.config.content) {\n      this.container.innerHTML = this.config.content;\n    }\n\n    this.prop.width = this.container.offsetWidth;\n\n    if (this.config.enabled === false) {\n      this.disable();\n    }\n\n    if (this.config.visible === false) {\n      this.hide();\n    }\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    delete this.config;\n\n    super.destroy();\n  }\n\n  /**\n   * @override\n   * @description Calls user method\n   */\n  onClick() {\n    if (this.config.onClick) {\n      this.config.onClick.call(this.psv, this.psv);\n    }\n  }\n\n}\n","import { EVENTS, IDS } from '../data/constants';\nimport info from '../icons/info.svg';\nimport { AbstractButton } from './AbstractButton';\n\nconst MODE_NOTIF = 1;\nconst MODE_PANEL = 2;\n\n/**\n * @summary Navigation bar description button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class DescriptionButton extends AbstractButton {\n\n  static id = 'description';\n  static icon = info;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-description-button');\n\n    /**\n     * @override\n     * @property {string} mode - notification or panel\n     */\n    this.prop = {\n      ...this.prop,\n      mode: null,\n    };\n\n    this.psv.on(EVENTS.HIDE_NOTIFICATION, this);\n    this.psv.on(EVENTS.SHOW_NOTIFICATION, this);\n    this.psv.on(EVENTS.CLOSE_PANEL, this);\n    this.psv.on(EVENTS.OPEN_PANEL, this);\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(EVENTS.HIDE_NOTIFICATION, this);\n    this.psv.off(EVENTS.SHOW_NOTIFICATION, this);\n    this.psv.off(EVENTS.CLOSE_PANEL, this);\n    this.psv.off(EVENTS.OPEN_PANEL, this);\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    if (!this.prop.mode) {\n      return;\n    }\n\n    let closed = false;\n    switch (e.type) {\n      case EVENTS.HIDE_NOTIFICATION:\n        closed = this.prop.mode === MODE_NOTIF;\n        break;\n\n      case EVENTS.SHOW_NOTIFICATION:\n        closed = this.prop.mode === MODE_NOTIF && e.args[0] !== IDS.DESCRIPTION;\n        break;\n\n      case EVENTS.CLOSE_PANEL:\n        closed = this.prop.mode === MODE_PANEL;\n        break;\n\n      case EVENTS.OPEN_PANEL:\n        closed = this.prop.mode === MODE_PANEL && e.args[0] !== IDS.DESCRIPTION;\n        break;\n\n      default:\n    }\n\n    if (closed) {\n      this.toggleActive(false);\n      this.prop.mode = null;\n    }\n  }\n\n  /**\n   * @override\n   */\n  hide(refresh) {\n    super.hide(refresh);\n\n    if (this.prop.mode) {\n      this.__close();\n    }\n  }\n\n  /**\n   * This button can only be refresh from NavbarCaption\n   * @override\n   */\n  refreshUi(refresh = false) {\n    if (refresh) {\n      const caption = this.psv.navbar.getButton('caption', false);\n      const captionHidden = caption && !caption.isVisible();\n      const hasDescription = !!this.psv.config.description;\n\n      if (captionHidden || hasDescription) {\n        this.show(false);\n      }\n      else {\n        this.hide(false);\n      }\n    }\n  }\n\n  /**\n   * @override\n   * @description Toggles caption\n   */\n  onClick() {\n    if (this.prop.mode) {\n      this.__close();\n    }\n    else {\n      this.__open();\n    }\n  }\n\n  /**\n   * @private\n   */\n  __close() {\n    switch (this.prop.mode) {\n      case MODE_NOTIF:\n        this.psv.notification.hide(IDS.DESCRIPTION);\n        break;\n      case MODE_PANEL:\n        this.psv.panel.hide(IDS.DESCRIPTION);\n        break;\n      default:\n    }\n  }\n\n  /**\n   * @private\n   */\n  __open() {\n    this.toggleActive(true);\n\n    if (this.psv.config.description) {\n      this.prop.mode = MODE_PANEL;\n      this.psv.panel.show({\n        id     : IDS.DESCRIPTION,\n        content: `${this.psv.config.caption ? `<p>${this.psv.config.caption}</p>` : ''}${this.psv.config.description}`,\n      });\n    }\n    else {\n      this.prop.mode = MODE_NOTIF;\n      this.psv.notification.show({\n        id     : IDS.DESCRIPTION,\n        content: this.psv.config.caption,\n      });\n    }\n  }\n\n}\n","import download from '../icons/download.svg';\nimport { AbstractButton } from './AbstractButton';\n\n/**\n * @summary Navigation bar download button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class DownloadButton extends AbstractButton {\n\n  static id = 'download';\n  static icon = download;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-download-button', true);\n  }\n\n  /**\n   * @override\n   * @description Asks the browser to download the panorama source file\n   */\n  onClick() {\n    const link = document.createElement('a');\n    link.href = this.psv.config.downloadUrl || this.psv.config.panorama;\n    link.download = link.href.split('/').pop();\n    this.psv.container.appendChild(link);\n    link.click();\n\n    setTimeout(() => {\n      this.psv.container.removeChild(link);\n    }, 100);\n  }\n\n  /**\n   * @override\n   */\n  refreshUi() {\n    const supported = this.psv.adapter.constructor.supportsDownload || this.psv.config.downloadUrl;\n    if (supported && !this.prop.visible) {\n      this.show();\n    }\n    else if (!supported && this.prop.visible) {\n      this.hide();\n    }\n  }\n\n}\n","import { EVENTS } from '../data/constants';\nimport fullscreenIn from '../icons/fullscreen-in.svg';\nimport fullscreenOut from '../icons/fullscreen-out.svg';\nimport { AbstractButton } from './AbstractButton';\n\n/**\n * @summary Navigation bar fullscreen button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class FullscreenButton extends AbstractButton {\n\n  static id = 'fullscreen';\n  static icon = fullscreenIn;\n  static iconActive = fullscreenOut;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-fullscreen-button');\n\n    this.psv.on(EVENTS.FULLSCREEN_UPDATED, this);\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(EVENTS.FULLSCREEN_UPDATED, this);\n\n    super.destroy();\n  }\n\n  /**\n   * Handle events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case EVENTS.FULLSCREEN_UPDATED: this.toggleActive(e.args[0]); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @description Toggles fullscreen\n   */\n  onClick() {\n    this.psv.toggleFullscreen();\n  }\n\n}\n","import { EVENTS, IDS } from '../data/constants';\nimport menuIcon from '../icons/menu.svg';\nimport { dasherize, getClosest } from '../utils';\nimport { AbstractButton } from './AbstractButton';\n\n/**\n * @summary Navigation bar menu button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class MenuButton extends AbstractButton {\n\n  static id = 'menu';\n  static icon = menuIcon;\n\n  /**\n   * @summary Property name added to buttons list\n   * @type {string}\n   * @constant\n   */\n  static BUTTON_DATA = 'psvButton';\n\n  /**\n   * @summary Menu template\n   * @param {AbstractButton[]} buttons\n   * @param {PSV.Viewer} psv\n   * @param {string} dataKey\n   * @returns {string}\n   */\n  static MENU_TEMPLATE = (buttons, psv, dataKey) => `\n<div class=\"psv-panel-menu psv-panel-menu--stripped\">\n  <h1 class=\"psv-panel-menu-title\">${menuIcon} ${psv.config.lang.menu}</h1>\n  <ul class=\"psv-panel-menu-list\">\n    ${buttons.map(button => `\n    <li data-${dataKey}=\"${button.prop.id}\" class=\"psv-panel-menu-item\" tabindex=\"0\">\n      <span class=\"psv-panel-menu-item-icon\">${button.container.innerHTML}</span>\n      <span class=\"psv-panel-menu-item-label\">${button.container.title}</span>\n    </li>\n    `).join('')}\n  </ul>\n</div>\n`;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-menu-button');\n\n    this.psv.on(EVENTS.OPEN_PANEL, this);\n    this.psv.on(EVENTS.CLOSE_PANEL, this);\n\n    super.hide();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(EVENTS.OPEN_PANEL, this);\n    this.psv.off(EVENTS.CLOSE_PANEL, this);\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case EVENTS.OPEN_PANEL:  this.toggleActive(e.args[0] === IDS.MENU); break;\n      case EVENTS.CLOSE_PANEL: this.toggleActive(false); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   */\n  hide(refresh) {\n    super.hide(refresh);\n    this.__hideMenu();\n  }\n\n  /**\n   * @override\n   */\n  show(refresh) {\n    super.show(refresh);\n\n    if (this.prop.active) {\n      this.__showMenu();\n    }\n  }\n\n  /**\n   * @override\n   * @description Toggles menu\n   */\n  onClick() {\n    if (this.prop.active) {\n      this.__hideMenu();\n    }\n    else {\n      this.__showMenu();\n    }\n  }\n\n  __showMenu() {\n    this.psv.panel.show({\n      id          : IDS.MENU,\n      content     : MenuButton.MENU_TEMPLATE(this.parent.collapsed, this.psv, dasherize(MenuButton.BUTTON_DATA)),\n      noMargin    : true,\n      clickHandler: (e) => {\n        const li = e.target ? getClosest(e.target, 'li') : undefined;\n        const buttonId = li ? li.dataset[MenuButton.BUTTON_DATA] : undefined;\n\n        if (buttonId) {\n          this.parent.getButton(buttonId).onClick();\n          this.__hideMenu();\n        }\n      },\n    });\n  }\n\n  __hideMenu() {\n    this.psv.panel.hide(IDS.MENU);\n  }\n\n}\n","/**\n * @summary Helper for pressable things (buttons, keyboard)\n * @description When the pressed thing goes up and was not pressed long enough, wait a bit more before execution\n * @private\n */\nexport class PressHandler {\n\n  constructor(delay = 200) {\n    this.delay = delay;\n    this.time = 0;\n    this.timeout = null;\n  }\n\n  down() {\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      this.timeout = null;\n    }\n\n    this.time = new Date().getTime();\n  }\n\n  up(cb) {\n    if (!this.time) {\n      return;\n    }\n\n    const elapsed = new Date().getTime() - this.time;\n    if (elapsed < this.delay) {\n      this.timeout = setTimeout(() => {\n        cb();\n        this.timeout = null;\n        this.time = 0;\n      }, this.delay);\n    }\n    else {\n      cb();\n      this.time = 0;\n    }\n  }\n\n}\n","import { KEY_CODES } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport arrow from '../icons/arrow.svg';\nimport { PressHandler } from '../utils/PressHandler';\nimport { AbstractButton } from './AbstractButton';\n\nexport function getOrientedArrow(direction) {\n  let angle = 0;\n  switch (direction) {\n    // @formatter:off\n    case 'up': angle = 90; break;\n    case 'right': angle = 180; break;\n    case 'down': angle = -90; break;\n    default: angle = 0; break;\n    // @formatter:on\n  }\n\n  return arrow.replace('rotate(0', `rotate(${angle}`);\n}\n\n/**\n * @summary Navigation bar move button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class AbstractMoveButton extends AbstractButton {\n\n  static groupId = 'move';\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   * @param {number} value\n   */\n  constructor(navbar, value) {\n    super(navbar, 'psv-button--hover-scale psv-move-button');\n\n    this.container.title = this.psv.config.lang.move;\n\n    /**\n     * @override\n     * @property {{longitude: boolean, latitude: boolean}} value\n     * @property {PressHandler} handler\n     */\n    this.prop = {\n      ...this.prop,\n      value  : value,\n      handler: new PressHandler(),\n    };\n\n    this.container.addEventListener('mousedown', this);\n    this.container.addEventListener('keydown', this);\n    this.container.addEventListener('keyup', this);\n    this.psv.container.addEventListener('mouseup', this);\n    this.psv.container.addEventListener('touchend', this);\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.__onMouseUp();\n\n    this.psv.container.removeEventListener('mouseup', this);\n    this.psv.container.removeEventListener('touchend', this);\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case 'mousedown': this.__onMouseDown(); break;\n      case 'mouseup':   this.__onMouseUp(); break;\n      case 'touchend':  this.__onMouseUp(); break;\n      case 'keydown':   e.key === KEY_CODES.Enter && this.__onMouseDown(); break;\n      case 'keyup':     e.key === KEY_CODES.Enter && this.__onMouseUp(); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   */\n  isSupported() {\n    return {\n      initial: !SYSTEM.isTouchEnabled.initial,\n      promise: SYSTEM.isTouchEnabled.promise.then(enabled => !enabled),\n    };\n  }\n\n  /**\n   * @override\n   */\n  onClick() {\n    // nothing\n  }\n\n  /**\n   * @private\n   */\n  __onMouseDown() {\n    if (!this.prop.enabled) {\n      return;\n    }\n\n    this.psv.__stopAll();\n    this.psv.dynamics.position.roll(this.prop.value);\n    this.prop.handler.down();\n  }\n\n  /**\n   * @private\n   */\n  __onMouseUp() {\n    if (!this.prop.enabled) {\n      return;\n    }\n\n    this.prop.handler.up(() => {\n      this.psv.dynamics.position.stop();\n      this.psv.resetIdleTimer();\n    });\n  }\n\n}\n","import { AbstractMoveButton, getOrientedArrow } from './AbstractMoveButton';\n\n/**\n * @summary Navigation bar move down button class\n * @extends PSV.buttons.AbstractMoveButton\n * @memberof PSV.buttons\n */\nexport class MoveDownButton extends AbstractMoveButton {\n\n  static id = 'moveDown';\n  static icon = getOrientedArrow('down');\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, { latitude: true });\n  }\n\n}\n","import { AbstractMoveButton, getOrientedArrow } from './AbstractMoveButton';\n\n/**\n * @summary Navigation bar move left button class\n * @extends PSV.buttons.AbstractMoveButton\n * @memberof PSV.buttons\n */\nexport class MoveLeftButton extends AbstractMoveButton {\n\n  static id = 'moveLeft';\n  static icon = getOrientedArrow('left');\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, { longitude: true });\n  }\n\n}\n","import { AbstractMoveButton, getOrientedArrow } from './AbstractMoveButton';\n\n/**\n * @summary Navigation bar move right button class\n * @extends PSV.buttons.AbstractMoveButton\n * @memberof PSV.buttons\n */\nexport class MoveRightButton extends AbstractMoveButton {\n\n  static id = 'moveRight';\n  static icon = getOrientedArrow('right');\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, { longitude: false });\n  }\n\n}\n","import { AbstractMoveButton, getOrientedArrow } from './AbstractMoveButton';\n\n/**\n * @summary Navigation bar move up button class\n * @extends PSV.buttons.AbstractMoveButton\n * @memberof PSV.buttons\n */\nexport class MoveUpButton extends AbstractMoveButton {\n\n  static id = 'moveUp';\n  static icon = getOrientedArrow('up');\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, { latitude: false });\n  }\n\n}\n","import { KEY_CODES } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { PressHandler } from '../utils/PressHandler';\nimport { AbstractButton } from './AbstractButton';\n\n/**\n * @summary Navigation bar zoom button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class AbstractZoomButton extends AbstractButton {\n\n  static groupId = 'zoom';\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   * @param {number} value\n   */\n  constructor(navbar, value) {\n    super(navbar, 'psv-button--hover-scale psv-zoom-button');\n\n    /**\n     * @override\n     * @property {boolean} value\n     * @property {PressHandler} handler\n     */\n    this.prop = {\n      ...this.prop,\n      value  : value,\n      handler: new PressHandler(),\n    };\n\n    this.container.addEventListener('mousedown', this);\n    this.container.addEventListener('keydown', this);\n    this.container.addEventListener('keyup', this);\n    this.psv.container.addEventListener('mouseup', this);\n    this.psv.container.addEventListener('touchend', this);\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.__onMouseUp();\n\n    this.psv.container.removeEventListener('mouseup', this);\n    this.psv.container.removeEventListener('touchend', this);\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case 'mousedown': this.__onMouseDown(); break;\n      case 'mouseup':   this.__onMouseUp(); break;\n      case 'touchend':  this.__onMouseUp(); break;\n      case 'keydown':   e.key === KEY_CODES.Enter && this.__onMouseDown(); break;\n      case 'keyup':     e.key === KEY_CODES.Enter && this.__onMouseUp(); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   */\n  isSupported() {\n    return {\n      initial: !SYSTEM.isTouchEnabled.initial,\n      promise: SYSTEM.isTouchEnabled.promise.then(enabled => !enabled),\n    };\n  }\n\n  /**\n   * @override\n   */\n  onClick() {\n    // nothing\n  }\n\n  /**\n   * @private\n   */\n  __onMouseDown() {\n    if (!this.prop.enabled) {\n      return;\n    }\n\n    this.psv.dynamics.zoom.roll(this.prop.value);\n    this.prop.handler.down();\n  }\n\n  /**\n   * @private\n   */\n  __onMouseUp() {\n    if (!this.prop.enabled) {\n      return;\n    }\n\n    this.prop.handler.up(() => this.psv.dynamics.zoom.stop());\n  }\n\n}\n","import { AbstractZoomButton } from './AbstractZoomButton';\nimport zoomIn from '../icons/zoom-in.svg';\n\n/**\n * @summary Navigation bar zoom-in button class\n * @extends PSV.buttons.AbstractZoomButton\n * @memberof PSV.buttons\n */\nexport class ZoomInButton extends AbstractZoomButton {\n\n  static id = 'zoomIn';\n  static icon = zoomIn;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, false);\n  }\n\n}\n","import { AbstractZoomButton } from './AbstractZoomButton';\nimport zoomOut from '../icons/zoom-out.svg';\n\n/**\n * @summary Navigation bar zoom-out button class\n * @extends PSV.buttons.AbstractZoomButton\n * @memberof PSV.buttons\n */\nexport class ZoomOutButton extends AbstractZoomButton {\n\n  static id = 'zoomOut';\n  static icon = zoomOut;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, true);\n  }\n\n}\n","import { EVENTS } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { getStyle, Slider } from '../utils';\nimport { AbstractButton } from './AbstractButton';\n\n/**\n * @summary Navigation bar zoom button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class ZoomRangeButton extends AbstractButton {\n\n  static id = 'zoomRange';\n  static groupId = 'zoom';\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-zoom-range', false, false);\n\n    /**\n     * @override\n     * @property {number} mediaMinWidth\n     */\n    this.prop = {\n      ...this.prop,\n      mediaMinWidth: 0,\n    };\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.zoomRange = document.createElement('div');\n    this.zoomRange.className = 'psv-zoom-range-line';\n    this.container.appendChild(this.zoomRange);\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.zoomValue = document.createElement('div');\n    this.zoomValue.className = 'psv-zoom-range-handle';\n    this.zoomRange.appendChild(this.zoomValue);\n\n    /**\n     * @member {PSV.Slider}\n     * @readonly\n     * @private\n     */\n    this.slider = new Slider({\n      container: this.container,\n      direction: Slider.HORIZONTAL,\n      onUpdate : e => this.__onSliderUpdate(e),\n    });\n\n    this.prop.mediaMinWidth = parseInt(getStyle(this.container, 'maxWidth'), 10);\n\n    this.psv.on(EVENTS.ZOOM_UPDATED, this);\n    if (this.psv.prop.ready) {\n      this.__moveZoomValue(this.psv.getZoomLevel());\n    }\n    else {\n      this.psv.once(EVENTS.READY, this);\n    }\n\n    this.refreshUi();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.slider.destroy();\n\n    delete this.zoomRange;\n    delete this.zoomValue;\n\n    this.psv.off(EVENTS.ZOOM_UPDATED, this);\n    this.psv.off(EVENTS.READY, this);\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case EVENTS.ZOOM_UPDATED: this.__moveZoomValue(e.args[0]); break;\n      case EVENTS.READY:        this.__moveZoomValue(this.psv.getZoomLevel()); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   */\n  isSupported() {\n    return {\n      initial: !SYSTEM.isTouchEnabled.initial,\n      promise: SYSTEM.isTouchEnabled.promise.then(enabled => !enabled),\n    };\n  }\n\n  /**\n   * @override\n   */\n  refreshUi() {\n    if (this.prop.supported) {\n      if (this.psv.prop.size.width <= this.prop.mediaMinWidth && this.prop.visible) {\n        this.hide();\n      }\n      else if (this.psv.prop.size.width > this.prop.mediaMinWidth && !this.prop.visible) {\n        this.show();\n      }\n    }\n  }\n\n  /**\n   * @override\n   */\n  onClick() {\n    // nothing\n  }\n\n  /**\n   * @summary Moves the zoom cursor\n   * @param {number} level\n   * @private\n   */\n  __moveZoomValue(level) {\n    this.zoomValue.style.left = (level / 100 * this.zoomRange.offsetWidth - this.zoomValue.offsetWidth / 2) + 'px';\n  }\n\n\n  /**\n   * @summary Zoom change\n   * @private\n   */\n  __onSliderUpdate(e) {\n    if (e.mousedown) {\n      this.psv.zoom(e.value * 100);\n    }\n  }\n\n}\n","import { EventEmitter } from 'uevent';\n\n/**\n * @namespace PSV.plugins\n */\n\n/**\n * @summary Base plugins class\n * @memberof PSV.plugins\n * @abstract\n */\nexport class AbstractPlugin extends EventEmitter {\n\n  /**\n   * @summary Unique identifier of the plugin\n   * @member {string}\n   * @readonly\n   * @static\n   */\n  static id = null;\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super();\n\n    /**\n     * @summary Reference to main controller\n     * @type {PSV.Viewer}\n     * @readonly\n     */\n    this.psv = psv;\n  }\n\n  /**\n   * @summary Initializes the plugin\n   * @package\n   */\n  init() {\n  }\n\n  /**\n   * @summary Destroys the plugin\n   * @package\n   */\n  destroy() {\n    delete this.psv;\n  }\n\n}\n","import { MathUtils } from 'three';\nimport { AbstractAdapter } from '../adapters/AbstractAdapter';\nimport { EquirectangularAdapter } from '../adapters/equirectangular';\nimport { AbstractPlugin } from '../plugins/AbstractPlugin';\nimport { PSVError } from '../PSVError';\nimport { clone, deepmerge, each, isNil, logWarn, parseAngle, parseSpeed, pluginInterop } from '../utils';\nimport { ACTIONS, KEY_CODES } from './constants';\n\n/**\n * @summary Default options\n * @type {PSV.Options}\n * @memberOf PSV\n * @constant\n */\nexport const DEFAULTS = {\n  panorama           : null,\n  overlay            : null,\n  overlayOpacity     : 1,\n  container          : null,\n  adapter            : null,\n  plugins            : [],\n  caption            : null,\n  description        : null,\n  downloadUrl        : null,\n  loadingImg         : null,\n  loadingTxt         : 'Loading...',\n  size               : null,\n  fisheye            : false,\n  minFov             : 30,\n  maxFov             : 90,\n  defaultZoomLvl     : 50,\n  defaultLong        : 0,\n  defaultLat         : 0,\n  sphereCorrection   : null,\n  moveSpeed          : 1,\n  zoomSpeed          : 1,\n  autorotateDelay    : null,\n  autorotateIdle     : false,\n  autorotateSpeed    : '2rpm',\n  autorotateLat      : null,\n  autorotateZoomLvl  : null,\n  moveInertia        : true,\n  mousewheel         : true,\n  mousemove          : true,\n  mousewheelCtrlKey  : false,\n  touchmoveTwoFingers: false,\n  useXmpData         : true,\n  panoData           : null,\n  requestHeaders     : null,\n  canvasBackground   : '#000',\n  withCredentials    : false,\n  navbar             : [\n    'autorotate',\n    'zoom',\n    'move',\n    'download',\n    'description',\n    'caption',\n    'fullscreen',\n  ],\n  lang               : {\n    autorotate: 'Automatic rotation',\n    zoom      : 'Zoom',\n    zoomOut   : 'Zoom out',\n    zoomIn    : 'Zoom in',\n    move      : 'Move',\n    download  : 'Download',\n    fullscreen: 'Fullscreen',\n    menu      : 'Menu',\n    twoFingers: 'Use two fingers to navigate',\n    ctrlZoom  : 'Use ctrl + scroll to zoom the image',\n    loadError : 'The panorama can\\'t be loaded',\n  },\n  keyboard           : {\n    [KEY_CODES.ArrowUp]   : ACTIONS.ROTATE_LAT_UP,\n    [KEY_CODES.ArrowDown] : ACTIONS.ROTATE_LAT_DOWN,\n    [KEY_CODES.ArrowRight]: ACTIONS.ROTATE_LONG_RIGHT,\n    [KEY_CODES.ArrowLeft] : ACTIONS.ROTATE_LONG_LEFT,\n    [KEY_CODES.PageUp]    : ACTIONS.ZOOM_IN,\n    [KEY_CODES.PageDown]  : ACTIONS.ZOOM_OUT,\n    [KEY_CODES.Plus]      : ACTIONS.ZOOM_IN,\n    [KEY_CODES.Minus]     : ACTIONS.ZOOM_OUT,\n    [KEY_CODES.Space]     : ACTIONS.TOGGLE_AUTOROTATE,\n  },\n};\n\n/**\n * @summary List of unmodifiable options and their error messages\n * @private\n */\nexport const READONLY_OPTIONS = {\n  panorama : 'Use setPanorama method to change the panorama',\n  panoData : 'Use setPanorama method to change the panorama',\n  container: 'Cannot change viewer container',\n  adapter  : 'Cannot change adapter',\n  plugins  : 'Cannot change plugins',\n};\n\n/**\n * @summary List of deprecated options and their warning messages\n * @private\n */\nexport const DEPRECATED_OPTIONS = {\n  captureCursor: 'captureCursor is deprecated',\n};\n\n/**\n * @summary Parsers/validators for each option\n * @private\n */\nexport const CONFIG_PARSERS = {\n  container        : (container) => {\n    if (!container) {\n      throw new PSVError('No value given for container.');\n    }\n    return container;\n  },\n  adapter          : (adapter) => {\n    if (!adapter) {\n      adapter = [EquirectangularAdapter];\n    }\n    else if (Array.isArray(adapter)) {\n      adapter = [pluginInterop(adapter[0], AbstractAdapter), adapter[1]];\n    }\n    else {\n      adapter = [pluginInterop(adapter, AbstractAdapter)];\n    }\n    if (!adapter[0]) {\n      throw new PSVError('Un undefined value with given for adapter.');\n    }\n    return adapter;\n  },\n  overlayOpacity   : (overlayOpacity) => {\n    return MathUtils.clamp(overlayOpacity, 0, 1);\n  },\n  defaultLong      : (defaultLong) => {\n    // defaultLat is between 0 and PI\n    return parseAngle(defaultLong);\n  },\n  defaultLat       : (defaultLat) => {\n    // defaultLat is between -PI/2 and PI/2\n    return parseAngle(defaultLat, true);\n  },\n  defaultZoomLvl   : (defaultZoomLvl) => {\n    return MathUtils.clamp(defaultZoomLvl, 0, 100);\n  },\n  minFov           : (minFov, config) => {\n    // minFov and maxFov must be ordered\n    if (config.maxFov < minFov) {\n      logWarn('maxFov cannot be lower than minFov');\n      minFov = config.maxFov;\n    }\n    // minFov between 1 and 179\n    return MathUtils.clamp(minFov, 1, 179);\n  },\n  maxFov           : (maxFov, config) => {\n    // minFov and maxFov must be ordered\n    if (maxFov < config.minFov) {\n      maxFov = config.minFov;\n    }\n    // maxFov between 1 and 179\n    return MathUtils.clamp(maxFov, 1, 179);\n  },\n  lang             : (lang) => {\n    if (Array.isArray(lang.twoFingers)) {\n      logWarn('lang.twoFingers must not be an array');\n      lang.twoFingers = lang.twoFingers[0];\n    }\n    return {\n      ...DEFAULTS.lang,\n      ...lang,\n    };\n  },\n  keyboard         : (keyboard) => {\n    // keyboard=true becomes the default map\n    if (keyboard === true) {\n      return clone(DEFAULTS.keyboard);\n    }\n    return keyboard;\n  },\n  autorotateLat    : (autorotateLat, config) => {\n    // default autorotateLat is defaultLat\n    if (autorotateLat === null) {\n      return parseAngle(config.defaultLat, true);\n    }\n    // autorotateLat is between -PI/2 and PI/2\n    else {\n      return parseAngle(autorotateLat, true);\n    }\n  },\n  autorotateZoomLvl: (autorotateZoomLvl) => {\n    if (isNil(autorotateZoomLvl)) {\n      return null;\n    }\n    else {\n      return MathUtils.clamp(autorotateZoomLvl, 0, 100);\n    }\n  },\n  autorotateSpeed  : (autorotateSpeed) => {\n    return parseSpeed(autorotateSpeed);\n  },\n  autorotateIdle   : (autorotateIdle, config) => {\n    if (autorotateIdle && isNil(config.autorotateDelay)) {\n      logWarn('autorotateIdle requires a non null autorotateDelay');\n      return false;\n    }\n    return autorotateIdle;\n  },\n  fisheye          : (fisheye) => {\n    // translate boolean fisheye to amount\n    if (fisheye === true) {\n      return 1;\n    }\n    else if (fisheye === false) {\n      return 0;\n    }\n    return fisheye;\n  },\n  plugins          : (plugins) => {\n    return plugins\n      .map((plugin) => {\n        if (Array.isArray(plugin)) {\n          plugin = [pluginInterop(plugin[0], AbstractPlugin), plugin[1]];\n        }\n        else {\n          plugin = [pluginInterop(plugin, AbstractPlugin)];\n        }\n        if (!plugin[0]) {\n          throw new PSVError('Un undefined value was given for plugins.');\n        }\n        return plugin;\n      });\n  },\n};\n\n/**\n * @summary Merge user config with default config and performs validation\n * @param {PSV.Options} options\n * @returns {PSV.Options}\n * @memberOf PSV\n * @private\n */\nexport function getConfig(options) {\n  const tempConfig = clone(DEFAULTS);\n  deepmerge(tempConfig, options);\n\n  const config = {};\n\n  each(tempConfig, (value, key) => {\n    if (DEPRECATED_OPTIONS[key]) {\n      logWarn(DEPRECATED_OPTIONS[key]);\n      return;\n    }\n\n    if (!Object.prototype.hasOwnProperty.call(DEFAULTS, key)) {\n      throw new PSVError(`Unknown option ${key}`);\n    }\n\n    if (CONFIG_PARSERS[key]) {\n      config[key] = CONFIG_PARSERS[key](value, tempConfig);\n    }\n    else {\n      config[key] = value;\n    }\n  });\n\n  return config;\n}\n","import { DescriptionButton } from '../buttons/DescriptionButton';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * @summary Navbar caption class\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.components\n */\nexport class NavbarCaption extends AbstractComponent {\n\n  static id = 'caption';\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   * @param {string} caption\n   */\n  constructor(navbar, caption) {\n    super(navbar, 'psv-caption');\n\n    /**\n     * @override\n     * @property {string} id\n     * @property {boolean} collapsable\n     * @property {number} width\n     * @property {number} contentWidth - width of the caption content\n     */\n    this.prop = {\n      ...this.prop,\n      id          : this.constructor.id,\n      collapsable : false,\n      width       : 0,\n      contentWidth: 0,\n    };\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.content = document.createElement('div');\n    this.content.className = 'psv-caption-content';\n    this.container.appendChild(this.content);\n\n    this.setCaption(caption);\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    delete this.content;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Sets the bar caption\n   * @param {string} html\n   */\n  setCaption(html) {\n    this.show();\n    this.content.innerHTML = html;\n    this.prop.contentWidth = html ? this.content.offsetWidth : 0;\n    this.refreshUi();\n  }\n\n  /**\n   * @summary Toggles content and icon depending on available space\n   * @private\n   */\n  refreshUi() {\n    this.toggle(this.container.offsetWidth >= this.prop.contentWidth);\n    this.__refreshButton();\n  }\n\n  /**\n   * @override\n   */\n  hide() {\n    this.content.style.display = 'none';\n    this.prop.visible = false;\n  }\n\n  /**\n   * @override\n   */\n  show() {\n    this.content.style.display = '';\n    this.prop.visible = true;\n  }\n\n  /**\n   * @private\n   */\n  __refreshButton() {\n    this.psv.navbar.getButton(DescriptionButton.id, false)?.refreshUi(true);\n  }\n\n}\n","import { AutorotateButton } from '../buttons/AutorotateButton';\nimport { CustomButton } from '../buttons/CustomButton';\nimport { DescriptionButton } from '../buttons/DescriptionButton';\nimport { DownloadButton } from '../buttons/DownloadButton';\nimport { FullscreenButton } from '../buttons/FullscreenButton';\nimport { MenuButton } from '../buttons/MenuButton';\nimport { MoveDownButton } from '../buttons/MoveDownButton';\nimport { MoveLeftButton } from '../buttons/MoveLeftButton';\nimport { MoveRightButton } from '../buttons/MoveRightButton';\nimport { MoveUpButton } from '../buttons/MoveUpButton';\nimport { ZoomInButton } from '../buttons/ZoomInButton';\nimport { ZoomOutButton } from '../buttons/ZoomOutButton';\nimport { ZoomRangeButton } from '../buttons/ZoomRangeButton';\nimport { DEFAULTS } from '../data/config';\nimport { PSVError } from '../PSVError';\nimport { clone, logWarn } from '../utils';\nimport { AbstractComponent } from './AbstractComponent';\nimport { NavbarCaption } from './NavbarCaption';\n\n/**\n * @summary List of available buttons\n * @type {Object<string, Class<PSV.buttons.AbstractButton>>}\n * @private\n */\nconst AVAILABLE_BUTTONS = {};\n\n/**\n * @summary List of available buttons\n * @type {Object<string, Array<Class<PSV.buttons.AbstractButton>>>}\n * @private\n */\nconst AVAILABLE_GROUPS = {};\n\n/**\n * @summary Register a new button available for all viewers\n * @param {Class<PSV.buttons.AbstractButton>} button\n * @param {'start' | 'end' | '[id]:left' | '[id]:right'} [defaultPosition]\n *    If provided the default configuration of the navbar will be modified.\n * @memberOf PSV\n */\nexport function registerButton(button, defaultPosition) {\n  if (!button.id) {\n    throw new PSVError('Button ID is required');\n  }\n\n  AVAILABLE_BUTTONS[button.id] = button;\n\n  if (button.groupId) {\n    AVAILABLE_GROUPS[button.groupId] = AVAILABLE_GROUPS[button.groupId] || [];\n    AVAILABLE_GROUPS[button.groupId].push(button);\n  }\n\n  if (typeof defaultPosition === 'string') {\n    switch (defaultPosition) {\n      case 'start':\n        DEFAULTS.navbar.unshift(button.id);\n        break;\n      case 'end':\n        DEFAULTS.navbar.push(button.id);\n        break;\n      default:\n        const [id, pos] = defaultPosition.split(':');\n        DEFAULTS.navbar.splice(DEFAULTS.navbar.indexOf(id) + (pos === 'right' ? 1 : 0), 0, button.id);\n    }\n  }\n}\n\n[\n  AutorotateButton,\n  ZoomOutButton,\n  ZoomRangeButton,\n  ZoomInButton,\n  DescriptionButton,\n  DownloadButton,\n  FullscreenButton,\n  MoveLeftButton,\n  MoveRightButton,\n  MoveUpButton,\n  MoveDownButton,\n].forEach(registerButton);\n\n/**\n * @summary Navigation bar component\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.components\n */\nexport class Navbar extends AbstractComponent {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv, 'psv-navbar psv--capture-event');\n\n    /**\n     * @summary List of buttons of the navbar\n     * @member {PSV.buttons.AbstractButton[]}\n     * @override\n     */\n    this.children = [];\n\n    /**\n     * @summary List of collapsed buttons\n     * @member {PSV.buttons.AbstractButton[]}\n     * @private\n     */\n    this.collapsed = [];\n  }\n\n  /**\n   * @summary Change the buttons visible on the navbar\n   * @param {string|Array<string|PSV.NavbarCustomButton>} buttons\n   * @throws {PSV.PSVError} when a button is unknown\n   */\n  setButtons(buttons) {\n    this.children.slice().forEach(item => item.destroy());\n    this.children.length = 0;\n\n    const cleanedButtons = this.__cleanButtons(buttons);\n\n    // force description button if caption is present (used on narrow screens)\n    if (cleanedButtons.indexOf(NavbarCaption.id) !== -1 && cleanedButtons.indexOf(DescriptionButton.id) === -1) {\n      cleanedButtons.splice(cleanedButtons.indexOf(NavbarCaption.id), 0, DescriptionButton.id);\n    }\n\n    /* eslint-disable no-new */\n    cleanedButtons.forEach((button) => {\n      if (typeof button === 'object') {\n        new CustomButton(this, button);\n      }\n      else if (AVAILABLE_BUTTONS[button]) {\n        new AVAILABLE_BUTTONS[button](this);\n      }\n      else if (AVAILABLE_GROUPS[button]) {\n        AVAILABLE_GROUPS[button].forEach(buttonCtor => new buttonCtor(this)); // eslint-disable-line new-cap\n      }\n      else if (button === NavbarCaption.id) {\n        new NavbarCaption(this, this.psv.config.caption);\n      }\n      else {\n        throw new PSVError('Unknown button ' + button);\n      }\n    });\n\n    new MenuButton(this);\n    /* eslint-enable no-new */\n\n    this.children.forEach((item) => {\n      if (typeof item.checkSupported === 'function') {\n        item.checkSupported();\n      }\n    });\n  }\n\n  /**\n   * @summary Sets the bar caption\n   * @param {string} html\n   */\n  setCaption(html) {\n    const caption = this.getButton(NavbarCaption.id, false);\n    caption?.setCaption(html);\n  }\n\n  /**\n   * @summary Returns a button by its identifier\n   * @param {string} id\n   * @param {boolean} [warnNotFound=true]\n   * @returns {PSV.buttons.AbstractButton}\n   */\n  getButton(id, warnNotFound = true) {\n    let button = null;\n\n    this.children.some((item) => {\n      if (item.prop.id === id) {\n        button = item;\n        return true;\n      }\n      else {\n        return false;\n      }\n    });\n\n    if (!button && warnNotFound) {\n      logWarn(`button \"${id}\" not found in the navbar`);\n    }\n\n    return button;\n  }\n\n  /**\n   * @summary Shows the navbar\n   */\n  show() {\n    this.container.classList.add('psv-navbar--open');\n    this.prop.visible = true;\n  }\n\n  /**\n   * @summary Hides the navbar\n   */\n  hide() {\n    this.container.classList.remove('psv-navbar--open');\n    this.prop.visible = false;\n  }\n\n  /**\n   * @override\n   */\n  refreshUi() {\n    super.refreshUi();\n\n    if (this.psv.prop.uiRefresh === true) {\n      const availableWidth = this.container.offsetWidth;\n\n      let totalWidth = 0;\n      const visibleButtons = [];\n      const collapsableButtons = [];\n\n      this.children.forEach((item) => {\n        if (item.prop.visible) {\n          totalWidth += item.prop.width;\n          visibleButtons.push(item);\n          if (item.prop.collapsable) {\n            collapsableButtons.push(item);\n          }\n        }\n      });\n\n      if (!visibleButtons.length) {\n        return;\n      }\n\n      if (availableWidth < totalWidth && collapsableButtons.length > 0) {\n        collapsableButtons.forEach(item => item.collapse());\n        this.collapsed = collapsableButtons;\n\n        this.getButton(MenuButton.id).show(false);\n      }\n      else if (availableWidth >= totalWidth && this.collapsed.length > 0) {\n        this.collapsed.forEach(item => item.uncollapse());\n        this.collapsed = [];\n\n        this.getButton(MenuButton.id).hide(false);\n      }\n\n      const caption = this.getButton(NavbarCaption.id, false);\n      if (caption) {\n        caption.refreshUi();\n      }\n    }\n  }\n\n  /**\n   * @summary Ensure the buttons configuration is correct\n   * @private\n   */\n  __cleanButtons(buttons) {\n    // true becomes the default array\n    if (buttons === true) {\n      return clone(DEFAULTS.navbar);\n    }\n    // can be a space or coma separated list\n    else if (typeof buttons === 'string') {\n      return buttons.split(/[ ,]/);\n    }\n    else {\n      return buttons || [];\n    }\n  }\n\n}\n","import { MathUtils } from 'three';\nimport { EVENTS } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { getStyle } from '../utils';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * @summary Loader component\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.components\n */\nexport class Loader extends AbstractComponent {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv, 'psv-loader-container');\n\n    /**\n     * @summary Inner container for vertical center\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.loader = document.createElement('div');\n    this.loader.className = 'psv-loader';\n    this.container.appendChild(this.loader);\n\n    /**\n     * @summary Animation canvas\n     * @member {HTMLCanvasElement}\n     * @readonly\n     * @private\n     */\n    this.canvas = document.createElement('canvas');\n    this.canvas.className = 'psv-loader-canvas';\n\n    this.canvas.width = this.loader.clientWidth * SYSTEM.pixelRatio;\n    this.canvas.height = this.loader.clientWidth * SYSTEM.pixelRatio;\n    this.loader.appendChild(this.canvas);\n\n    /**\n     * @override\n     * @property {number} thickness\n     * @property {string} current\n     */\n    this.prop = {\n      ...this.prop,\n      tickness: (this.loader.offsetWidth - this.loader.clientWidth) / 2 * SYSTEM.pixelRatio,\n      current : null,\n    };\n\n    this.refreshUi();\n    this.hide();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    delete this.loader;\n    delete this.canvas;\n\n    super.destroy();\n  }\n\n  /**\n   * @override\n   */\n  refreshUi() {\n    if (this.prop.current !== (this.psv.config.loadingImg || this.psv.config.loadingTxt)) {\n      if (this.prop.current) {\n        this.loader.removeChild(this.loader.lastChild);\n      }\n\n      let inner;\n      if (this.psv.config.loadingImg) {\n        inner = document.createElement('img');\n        inner.className = 'psv-loader-image';\n        inner.src = this.psv.config.loadingImg;\n      }\n      else if (this.psv.config.loadingTxt) {\n        inner = document.createElement('div');\n        inner.className = 'psv-loader-text';\n        inner.innerHTML = this.psv.config.loadingTxt;\n      }\n      if (inner) {\n        const size = Math.round(Math.sqrt(2 * Math.pow((this.canvas.width / 2 - this.prop.tickness / 2) / SYSTEM.pixelRatio, 2)));\n        inner.style.maxWidth = size + 'px';\n        inner.style.maxHeight = size + 'px';\n        this.loader.appendChild(inner);\n      }\n\n      this.prop.current = this.psv.config.loadingImg || this.psv.config.loadingTxt;\n    }\n  }\n\n  /**\n   * @summary Sets the loader progression\n   * @param {number} value - from 0 to 100\n   */\n  setProgress(value) {\n    const context = this.canvas.getContext('2d');\n\n    context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n    context.lineWidth = this.prop.tickness;\n    context.strokeStyle = getStyle(this.loader, 'color');\n\n    context.beginPath();\n    context.arc(\n      this.canvas.width / 2, this.canvas.height / 2,\n      this.canvas.width / 2 - this.prop.tickness / 2,\n      -Math.PI / 2, MathUtils.clamp(value, 0, 100) / 100 * 2 * Math.PI - Math.PI / 2\n    );\n    context.stroke();\n\n    this.psv.trigger(EVENTS.LOAD_PROGRESS, Math.round(value));\n  }\n\n}\n","import { EVENTS } from '../data/constants';\nimport { PSVError } from '../PSVError';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * @summary Notification component\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.components\n */\nexport class Notification extends AbstractComponent {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv, 'psv-notification');\n\n    /**\n     * @override\n     * @property {*} timeout\n     */\n    this.prop = {\n      ...this.prop,\n      visible  : false,\n      contentId: undefined,\n      timeout  : null,\n    };\n\n    /**\n     * Notification content\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.content = document.createElement('div');\n    this.content.className = 'psv-notification-content';\n    this.container.appendChild(this.content);\n\n    this.content.addEventListener('click', () => this.hide());\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    delete this.content;\n\n    super.destroy();\n  }\n\n  /**\n   * @override\n   * @param {string} [id]\n   */\n  isVisible(id) {\n    return this.prop.visible && (!id || !this.prop.contentId || this.prop.contentId === id);\n  }\n\n  /**\n   * @override\n   * @summary This method is not supported\n   * @throws {PSV.PSVError} always\n   */\n  toggle() {\n    throw new PSVError('Notification cannot be toggled');\n  }\n\n  /**\n   * @summary Displays a notification on the viewer\n   * @param {Object|string} config\n   * @param {string} [config.id] - unique identifier to use with \"hide\"\n   * @param {string} config.content\n   * @param {number} [config.timeout]\n   * @fires PSV.show-notification\n   *\n   * @example\n   * viewer.showNotification({ content: 'Hello world', timeout: 5000 })\n   * @example\n   * viewer.showNotification('Hello world')\n   */\n  show(config) {\n    if (this.prop.timeout) {\n      clearTimeout(this.prop.timeout);\n      this.prop.timeout = null;\n    }\n\n    if (typeof config === 'string') {\n      config = { content: config };\n    }\n\n    this.prop.contentId = config.id;\n    this.content.innerHTML = config.content;\n\n    this.container.classList.add('psv-notification--visible');\n    this.prop.visible = true;\n\n    this.psv.trigger(EVENTS.SHOW_NOTIFICATION, config.id);\n\n    if (config.timeout) {\n      this.prop.timeout = setTimeout(() => this.hide(config.id), config.timeout);\n    }\n  }\n\n  /**\n   * @summary Hides the notification\n   * @param {string} [id]\n   * @fires PSV.hide-notification\n   */\n  hide(id) {\n    if (this.isVisible(id)) {\n      const contentId = this.prop.contentId;\n\n      this.container.classList.remove('psv-notification--visible');\n      this.prop.visible = false;\n\n      this.prop.contentId = undefined;\n\n      this.psv.trigger(EVENTS.HIDE_NOTIFICATION, contentId);\n    }\n  }\n\n}\n","import { EVENTS, KEY_CODES } from '../data/constants';\nimport { PSVError } from '../PSVError';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * @summary Overlay component\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.components\n */\nexport class Overlay extends AbstractComponent {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv, 'psv-overlay');\n\n    /**\n     * @override\n     * @property {string} contentId\n     * @property {boolean} dissmisable\n     */\n    this.prop = {\n      ...this.prop,\n      contentId  : undefined,\n      dissmisable: true,\n    };\n\n    /**\n     * Image container\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.image = document.createElement('div');\n    this.image.className = 'psv-overlay-image';\n    this.container.appendChild(this.image);\n\n    /**\n     * Text container\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.text = document.createElement('div');\n    this.text.className = 'psv-overlay-text';\n    this.container.appendChild(this.text);\n\n    /**\n     * Subtext container\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.subtext = document.createElement('div');\n    this.subtext.className = 'psv-overlay-subtext';\n    this.container.appendChild(this.subtext);\n\n    this.psv.on(EVENTS.CLICK, this);\n    this.psv.on(EVENTS.KEY_PRESS, this);\n\n    super.hide();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(EVENTS.CLICK, this);\n    this.psv.off(EVENTS.KEY_PRESS, this);\n\n    delete this.image;\n    delete this.text;\n    delete this.subtext;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      case EVENTS.CLICK:\n        if (this.isVisible() && this.prop.dissmisable) {\n          this.hide();\n          e.stopPropagation();\n        }\n        break;\n      case EVENTS.KEY_PRESS:\n        if (this.isVisible() && this.prop.dissmisable && e.args[0] === KEY_CODES.Escape) {\n          this.hide();\n          e.preventDefault();\n        }\n        break;\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @param {string} [id]\n   */\n  isVisible(id) {\n    return this.prop.visible && (!id || !this.prop.contentId || this.prop.contentId === id);\n  }\n\n  /**\n   * @override\n   * @summary This method is not supported\n   * @throws {PSV.PSVError} always\n   */\n  toggle() {\n    throw new PSVError('Overlay cannot be toggled');\n  }\n\n  /**\n   * @summary Displays an overlay on the viewer\n   * @param {Object|string} config\n   * @param {string} [config.id] - unique identifier to use with \"hide\"\n   * @param {string} config.image - SVG image/icon displayed above the text\n   * @param {string} config.text - main message\n   * @param {string} [config.subtext] - secondary message\n   * @param {boolean} [config.dissmisable=true] - if the user can hide the overlay by clicking\n   * @fires PSV.show-overlay\n   */\n  show(config) {\n    if (typeof config === 'string') {\n      config = { text: config };\n    }\n\n    this.prop.contentId = config.id;\n    this.prop.dissmisable = config.dissmisable !== false;\n    this.image.innerHTML = config.image || '';\n    this.text.innerHTML = config.text || '';\n    this.subtext.innerHTML = config.subtext || '';\n\n    super.show();\n\n    this.psv.trigger(EVENTS.SHOW_OVERLAY, config.id);\n  }\n\n  /**\n   * @summary Hides the overlay\n   * @param {string} [id]\n   * @fires PSV.hide-overlay\n   */\n  hide(id) {\n    if (this.isVisible(id)) {\n      const contentId = this.prop.contentId;\n\n      super.hide();\n\n      this.prop.contentId = undefined;\n\n      this.psv.trigger(EVENTS.HIDE_OVERLAY, contentId);\n    }\n  }\n\n}\n","import { EVENTS, KEY_CODES } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { PSVError } from '../PSVError';\nimport { toggleClass } from '../utils';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * @summary Minimum width of the panel\n * @type {number}\n * @constant\n * @private\n */\nconst PANEL_MIN_WIDTH = 200;\n\n/**\n * @summary Panel component\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.components\n */\nexport class Panel extends AbstractComponent {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv, 'psv-panel psv--capture-event');\n\n    /**\n     * @override\n     * @property {string} contentId\n     * @property {number} mouseX\n     * @property {number} mouseY\n     * @property {boolean} mousedown\n     * @property {function} clickHandler\n     * @property {function} keyHandler\n     */\n    this.prop = {\n      ...this.prop,\n      visible     : false,\n      contentId   : undefined,\n      mouseX      : 0,\n      mouseY      : 0,\n      mousedown   : false,\n      clickHandler: null,\n      keyHandler  : null,\n      width       : {},\n    };\n\n    const resizer = document.createElement('div');\n    resizer.className = 'psv-panel-resizer';\n    this.container.appendChild(resizer);\n\n    const closeBtn = document.createElement('div');\n    closeBtn.className = 'psv-panel-close-button';\n    this.container.appendChild(closeBtn);\n\n    /**\n     * @summary Content container\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.content = document.createElement('div');\n    this.content.className = 'psv-panel-content';\n    this.container.appendChild(this.content);\n\n    // Stop wheel event bubbling from panel\n    this.container.addEventListener(SYSTEM.mouseWheelEvent, e => e.stopPropagation());\n\n    closeBtn.addEventListener('click', () => this.hide());\n\n    // Event for panel resizing + stop bubling\n    resizer.addEventListener('mousedown', this);\n    resizer.addEventListener('touchstart', this);\n    this.psv.container.addEventListener('mouseup', this);\n    this.psv.container.addEventListener('touchend', this);\n    this.psv.container.addEventListener('mousemove', this);\n    this.psv.container.addEventListener('touchmove', this);\n\n    this.psv.on(EVENTS.KEY_PRESS, this);\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(EVENTS.KEY_PRESS, this);\n\n    this.psv.container.removeEventListener('mousemove', this);\n    this.psv.container.removeEventListener('touchmove', this);\n    this.psv.container.removeEventListener('mouseup', this);\n    this.psv.container.removeEventListener('touchend', this);\n\n    delete this.prop;\n    delete this.content;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case 'mousedown':  this.__onMouseDown(e);  break;\n      case 'touchstart': this.__onTouchStart(e); break;\n      case 'mousemove':  this.__onMouseMove(e);  break;\n      case 'touchmove':  this.__onTouchMove(e);  break;\n      case 'mouseup':    this.__onMouseUp(e);    break;\n      case 'touchend':   this.__onMouseUp(e);    break;\n      case EVENTS.KEY_PRESS:\n        if (this.isVisible() && e.args[0] === KEY_CODES.Escape) {\n          this.hide();\n          e.preventDefault();\n        }\n        break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @param {string} [id]\n   */\n  isVisible(id) {\n    return this.prop.visible && (!id || !this.prop.contentId || this.prop.contentId === id);\n  }\n\n  /**\n   * @override\n   * @summary This method is not supported\n   * @throws {PSV.PSVError} always\n   */\n  toggle() {\n    throw new PSVError('Panel cannot be toggled');\n  }\n\n  /**\n   * @summary Shows the panel\n   * @param {string|Object} config\n   * @param {string} [config.id] - unique identifier to use with \"hide\" and to store the user desired width\n   * @param {string} config.content - HTML content of the panel\n   * @param {boolean} [config.noMargin=false] - remove the default margins\n   * @param {string} [config.width] - initial width\n   * @param {Function} [config.clickHandler] - called when the user clicks inside the panel or presses the Enter key while an element focused\n   * @fires PSV.open-panel\n   */\n  show(config) {\n    const wasVisible = this.isVisible(config.id);\n\n    if (typeof config === 'string') {\n      config = { content: config };\n    }\n\n    this.prop.contentId = config.id;\n    this.prop.visible = true;\n\n    if (this.prop.clickHandler) {\n      this.content.removeEventListener('click', this.prop.clickHandler);\n      this.content.removeEventListener('keydown', this.prop.keyHandler);\n      this.prop.clickHandler = null;\n      this.prop.keyHandler = null;\n    }\n\n    if (config.id && this.prop.width[config.id]) {\n      this.container.style.width = this.prop.width[config.id];\n    }\n    else if (config.width) {\n      this.container.style.width = config.width;\n    }\n    else {\n      this.container.style.width = null;\n    }\n\n    this.content.innerHTML = config.content;\n    this.content.scrollTop = 0;\n    this.container.classList.add('psv-panel--open');\n\n    toggleClass(this.content, 'psv-panel-content--no-margin', config.noMargin === true);\n\n    if (config.clickHandler) {\n      this.prop.clickHandler = config.clickHandler;\n      this.prop.keyHandler = (e) => {\n        if (e.key === KEY_CODES.Enter) {\n          config.clickHandler(e);\n        }\n      };\n      this.content.addEventListener('click', this.prop.clickHandler);\n      this.content.addEventListener('keydown', this.prop.keyHandler);\n\n      // focus the first element if possible, after animation ends\n      if (!wasVisible) {\n        setTimeout(() => {\n          this.content.querySelector('a,button,[tabindex]')?.focus();\n        }, 300);\n      }\n    }\n\n    this.psv.trigger(EVENTS.OPEN_PANEL, config.id);\n  }\n\n  /**\n   * @summary Hides the panel\n   * @param {string} [id]\n   * @fires PSV.close-panel\n   */\n  hide(id) {\n    if (this.isVisible(id)) {\n      const contentId = this.prop.contentId;\n\n      this.prop.visible = false;\n      this.prop.contentId = undefined;\n\n      this.content.innerHTML = null;\n      this.container.classList.remove('psv-panel--open');\n\n      if (this.prop.clickHandler) {\n        this.content.removeEventListener('click', this.prop.clickHandler);\n        this.prop.clickHandler = null;\n      }\n\n      this.psv.trigger(EVENTS.CLOSE_PANEL, contentId);\n    }\n  }\n\n  /**\n   * @summary Handles mouse down events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  __onMouseDown(evt) {\n    evt.stopPropagation();\n    this.__startResize(evt);\n  }\n\n  /**\n   * @summary Handles touch events\n   * @param {TouchEvent} evt\n   * @private\n   */\n  __onTouchStart(evt) {\n    evt.stopPropagation();\n    this.__startResize(evt.changedTouches[0]);\n  }\n\n  /**\n   * @summary Handles mouse up events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  __onMouseUp(evt) {\n    if (this.prop.mousedown) {\n      evt.stopPropagation();\n      this.prop.mousedown = false;\n      this.content.classList.remove('psv-panel-content--no-interaction');\n    }\n  }\n\n  /**\n   * @summary Handles mouse move events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  __onMouseMove(evt) {\n    if (this.prop.mousedown) {\n      evt.stopPropagation();\n      this.__resize(evt);\n    }\n  }\n\n  /**\n   * @summary Handles touch move events\n   * @param {TouchEvent} evt\n   * @private\n   */\n  __onTouchMove(evt) {\n    if (this.prop.mousedown) {\n      this.__resize(evt.touches[0]);\n    }\n  }\n\n  /**\n   * @summary Initializes the panel resize\n   * @param {MouseEvent|Touch} evt\n   * @private\n   */\n  __startResize(evt) {\n    this.prop.mouseX = evt.clientX;\n    this.prop.mouseY = evt.clientY;\n    this.prop.mousedown = true;\n    this.content.classList.add('psv-panel-content--no-interaction');\n  }\n\n  /**\n   * @summary Resizes the panel\n   * @param {MouseEvent|Touch} evt\n   * @private\n   */\n  __resize(evt) {\n    const x = evt.clientX;\n    const y = evt.clientY;\n    const width = Math.max(PANEL_MIN_WIDTH, this.container.offsetWidth - (x - this.prop.mouseX)) + 'px';\n\n    if (this.prop.contentId) {\n      this.prop.width[this.prop.contentId] = width;\n    }\n\n    this.container.style.width = width;\n\n    this.prop.mouseX = x;\n    this.prop.mouseY = y;\n  }\n\n}\n","/**\n * @namespace PSV.services\n */\n\n/**\n * @summary Base services class\n * @memberof PSV.services\n * @abstract\n */\nexport class AbstractService {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    /**\n     * @summary Reference to main controller\n     * @type {PSV.Viewer}\n     * @readonly\n     */\n    this.psv = psv;\n\n    /**\n     * @summary Configuration holder\n     * @type {PSV.Options}\n     * @readonly\n     */\n    this.config = psv.config;\n\n    /**\n     * @summary Properties holder\n     * @type {Object}\n     * @readonly\n     */\n    this.prop = psv.prop;\n  }\n\n  /**\n   * @summary Destroys the service\n   */\n  destroy() {\n    delete this.psv;\n    delete this.config;\n    delete this.prop;\n  }\n\n}\n","import { Euler, MathUtils, Vector2, Vector3 } from 'three';\nimport { MESH_USER_DATA, SPHERE_RADIUS } from '../data/constants';\nimport { PSVError } from '../PSVError';\nimport { applyEulerInverse, parseAngle, parseSpeed } from '../utils';\nimport { AbstractService } from './AbstractService';\n\nconst vector2 = new Vector2();\nconst vector3 = new Vector3();\nconst eulerZero = new Euler(0, 0, 0, 'ZXY');\n\n/**\n * @summary Collections of data converters for the current viewer\n * @extends PSV.services.AbstractService\n * @memberof PSV.services\n */\nexport class DataHelper extends AbstractService {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv);\n  }\n\n  /**\n   * @summary Converts vertical FOV to zoom level\n   * @param {number} fov\n   * @returns {number}\n   */\n  fovToZoomLevel(fov) {\n    const temp = Math.round((fov - this.config.minFov) / (this.config.maxFov - this.config.minFov) * 100);\n    return temp - 2 * (temp - 50);\n  }\n\n  /**\n   * @summary Converts zoom level to vertical FOV\n   * @param {number} level\n   * @returns {number}\n   */\n  zoomLevelToFov(level) {\n    return this.config.maxFov + (level / 100) * (this.config.minFov - this.config.maxFov);\n  }\n\n  /**\n   * @summary Convert vertical FOV to horizontal FOV\n   * @param {number} vFov\n   * @returns {number}\n   */\n  vFovToHFov(vFov) {\n    return MathUtils.radToDeg(2 * Math.atan(Math.tan(MathUtils.degToRad(vFov) / 2) * this.prop.aspect));\n  }\n\n  /**\n   * @summary Converts a speed into a duration from current position to a new position\n   * @param {string|number} value\n   * @param {number} angle\n   * @returns {number}\n   */\n  speedToDuration(value, angle) {\n    if (!value || typeof value !== 'number') {\n      // desired radial speed\n      const speed = value ? parseSpeed(value) : this.config.autorotateSpeed;\n      // compute duration\n      return angle / Math.abs(speed) * 1000;\n    }\n    else {\n      return Math.abs(value);\n    }\n  }\n\n  /**\n   * @summary Converts pixel texture coordinates to spherical radians coordinates\n   * @param {PSV.Point} point\n   * @returns {PSV.Position}\n   * @throws {PSV.PSVError} when the current adapter does not support texture coordinates\n   */\n  textureCoordsToSphericalCoords(point) {\n    const panoData = this.prop.panoData;\n    if (!panoData) {\n      throw new PSVError('Current adapter does not support texture coordinates.');\n    }\n\n    const relativeX = (point.x + panoData.croppedX) / panoData.fullWidth * Math.PI * 2;\n    const relativeY = (point.y + panoData.croppedY) / panoData.fullHeight * Math.PI;\n\n    const result = {\n      longitude: relativeX >= Math.PI ? relativeX - Math.PI : relativeX + Math.PI,\n      latitude : Math.PI / 2 - relativeY,\n    };\n\n    // Apply panoData pose and sphereCorrection\n    if (!eulerZero.equals(this.psv.renderer.mesh.rotation) || !eulerZero.equals(this.psv.renderer.meshContainer.rotation)) {\n      this.sphericalCoordsToVector3(result, vector3);\n      vector3.applyEuler(this.psv.renderer.mesh.rotation);\n      vector3.applyEuler(this.psv.renderer.meshContainer.rotation);\n      return this.vector3ToSphericalCoords(vector3);\n    }\n    else {\n      return result;\n    }\n  }\n\n  /**\n   * @summary Converts spherical radians coordinates to pixel texture coordinates\n   * @param {PSV.Position} position\n   * @returns {PSV.Point}\n   * @throws {PSV.PSVError} when the current adapter does not support texture coordinates\n   */\n  sphericalCoordsToTextureCoords(position) {\n    const panoData = this.prop.panoData;\n    if (!panoData) {\n      throw new PSVError('Current adapter does not support texture coordinates.');\n    }\n\n    // Apply panoData pose and sphereCorrection\n    if (!eulerZero.equals(this.psv.renderer.mesh.rotation) || !eulerZero.equals(this.psv.renderer.meshContainer.rotation)) {\n      this.sphericalCoordsToVector3(position, vector3);\n      applyEulerInverse(vector3, this.psv.renderer.meshContainer.rotation);\n      applyEulerInverse(vector3, this.psv.renderer.mesh.rotation);\n      position = this.vector3ToSphericalCoords(vector3);\n    }\n\n    const relativeLong = position.longitude / Math.PI / 2 * panoData.fullWidth;\n    const relativeLat = position.latitude / Math.PI * panoData.fullHeight;\n\n    return {\n      x: Math.round(position.longitude < Math.PI ? relativeLong + panoData.fullWidth / 2 : relativeLong - panoData.fullWidth / 2) - panoData.croppedX,\n      y: Math.round(panoData.fullHeight / 2 - relativeLat) - panoData.croppedY,\n    };\n  }\n\n  /**\n   * @summary Converts spherical radians coordinates to a THREE.Vector3\n   * @param {PSV.Position} position\n   * @param {external:THREE.Vector3} [vector]\n   * @returns {external:THREE.Vector3}\n   */\n  sphericalCoordsToVector3(position, vector) {\n    if (!vector) {\n      vector = new Vector3();\n    }\n    vector.x = SPHERE_RADIUS * -Math.cos(position.latitude) * Math.sin(position.longitude);\n    vector.y = SPHERE_RADIUS * Math.sin(position.latitude);\n    vector.z = SPHERE_RADIUS * Math.cos(position.latitude) * Math.cos(position.longitude);\n    return vector;\n  }\n\n  /**\n   * @summary Converts a THREE.Vector3 to spherical radians coordinates\n   * @param {external:THREE.Vector3} vector\n   * @returns {PSV.Position}\n   */\n  vector3ToSphericalCoords(vector) {\n    const phi = Math.acos(vector.y / Math.sqrt(vector.x * vector.x + vector.y * vector.y + vector.z * vector.z));\n    const theta = Math.atan2(vector.x, vector.z);\n\n    return {\n      longitude: theta < 0 ? -theta : Math.PI * 2 - theta,\n      latitude : Math.PI / 2 - phi,\n    };\n  }\n\n  /**\n   * @summary Converts position on the viewer to a THREE.Vector3\n   * @param {PSV.Point} viewerPoint\n   * @returns {external:THREE.Vector3}\n   */\n  viewerCoordsToVector3(viewerPoint) {\n    const sphereIntersect = this.getIntersections(viewerPoint).filter(i => i.object.userData[MESH_USER_DATA]);\n\n    if (sphereIntersect.length) {\n      return sphereIntersect[0].point;\n    }\n    else {\n      return null;\n    }\n  }\n\n  /**\n   * @summary Converts a THREE.Vector3 to position on the viewer\n   * @param {external:THREE.Vector3} vector\n   * @returns {PSV.Point}\n   */\n  vector3ToViewerCoords(vector) {\n    const vectorClone = vector.clone();\n    vectorClone.project(this.psv.renderer.camera);\n\n    return {\n      x: Math.round((vectorClone.x + 1) / 2 * this.prop.size.width),\n      y: Math.round((1 - vectorClone.y) / 2 * this.prop.size.height),\n    };\n  }\n\n  /**\n   * @summary Converts spherical radians coordinates to position on the viewer\n   * @param {PSV.Position} position\n   * @returns {PSV.Point}\n   */\n  sphericalCoordsToViewerCoords(position) {\n    return this.vector3ToViewerCoords(this.sphericalCoordsToVector3(position, vector3));\n  }\n\n  /**\n   * @summary Returns intersections with objects in the scene\n   * @param {PSV.Point} viewerPoint\n   * @return {external:THREE.Intersection[]}\n   */\n  getIntersections(viewerPoint) {\n    vector2.x = 2 * viewerPoint.x / this.prop.size.width - 1;\n    vector2.y = -2 * viewerPoint.y / this.prop.size.height + 1;\n\n    this.psv.renderer.raycaster.setFromCamera(vector2, this.psv.renderer.camera);\n\n    return this.psv.renderer.raycaster.intersectObjects(this.psv.renderer.scene.children, true)\n      .filter(i => !!i.object.userData);\n  }\n\n  /**\n   * @summary Converts x/y to latitude/longitude if present and ensure boundaries\n   * @param {PSV.ExtendedPosition} position\n   * @returns {PSV.Position}\n   */\n  cleanPosition(position) {\n    if (position.x !== undefined && position.y !== undefined) {\n      return this.textureCoordsToSphericalCoords(position);\n    }\n    else {\n      return {\n        longitude: parseAngle(position.longitude),\n        latitude : parseAngle(position.latitude, !this.prop.littlePlanet),\n      };\n    }\n  }\n\n  /**\n   * @summary Ensure a SphereCorrection object is valid\n   * @param {PSV.SphereCorrection} sphereCorrection\n   * @returns {PSV.SphereCorrection}\n   */\n  cleanSphereCorrection(sphereCorrection) {\n    return {\n      pan : parseAngle(sphereCorrection?.pan || 0),\n      tilt: parseAngle(sphereCorrection?.tilt || 0, true),\n      roll: parseAngle(sphereCorrection?.roll || 0, true, false),\n    };\n  }\n\n  /**\n   * @summary Parse the pose angles of the pano data\n   * @param {PSV.PanoData} panoData\n   * @returns {PSV.SphereCorrection}\n   */\n  cleanPanoramaPose(panoData) {\n    return {\n      pan : MathUtils.degToRad(panoData?.poseHeading || 0),\n      tilt: MathUtils.degToRad(panoData?.posePitch || 0),\n      roll: MathUtils.degToRad(panoData?.poseRoll || 0),\n    };\n  }\n\n}\n","import { MathUtils, SplineCurve, Vector2 } from 'three';\nimport {\n  ACTIONS,\n  CTRLZOOM_TIMEOUT,\n  DBLCLICK_DELAY,\n  EVENTS,\n  IDS,\n  INERTIA_WINDOW,\n  KEY_CODES,\n  LONGTOUCH_DELAY,\n  MESH_USER_DATA,\n  MOVE_THRESHOLD,\n  OBJECT_EVENTS,\n  TWOFINGERSOVERLAY_DELAY\n} from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport gestureIcon from '../icons/gesture.svg';\nimport mousewheelIcon from '../icons/mousewheel.svg';\nimport {\n  clone,\n  distance,\n  each,\n  getClosest,\n  getPosition,\n  hasParent,\n  isEmpty,\n  isFullscreenEnabled,\n  normalizeWheel,\n  throttle\n} from '../utils';\nimport { Animation } from '../utils/Animation';\nimport { PressHandler } from '../utils/PressHandler';\nimport { AbstractService } from './AbstractService';\n\nconst IDLE = 0;\nconst MOVING = 1;\nconst INERTIA = 2;\n\n/**\n * @summary Events handler\n * @extends PSV.services.AbstractService\n * @memberof PSV.services\n */\nexport class EventsHandler extends AbstractService {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv);\n\n    /**\n     * @summary Internal properties\n     * @member {Object}\n     * @property {number} moveThreshold - computed threshold based on device pixel ratio\n     * @property {number} step\n     * @property {boolean} mousedown - before moving past the threshold\n     * @property {number} startMouseX - start x position of the click/touch\n     * @property {number} startMouseY - start y position of the click/touch\n     * @property {number} mouseX - current x position of the cursor\n     * @property {number} mouseY - current y position of the cursor\n     * @property {number[][]} mouseHistory - list of latest positions of the cursor, [time, x, y]\n     * @property {number} pinchDist - distance between fingers when zooming\n     * @property {PressHandler} keyHandler\n     * @property {boolean} ctrlKeyDown - when the Ctrl key is pressed\n     * @property {PSV.ClickData} dblclickData - temporary storage of click data between two clicks\n     * @property {number} dblclickTimeout - timeout id for double click\n     * @property {number} twofingersTimeout - timeout id for \"two fingers\" overlay\n     * @property {number} ctrlZoomTimeout - timeout id for \"ctrol zoom\" overlay\n     * @protected\n     */\n    this.state = {\n      moveThreshold    : MOVE_THRESHOLD * SYSTEM.pixelRatio,\n      keyboardEnabled  : false,\n      step             : IDLE,\n      mousedown        : false,\n      startMouseX      : 0,\n      startMouseY      : 0,\n      mouseX           : 0,\n      mouseY           : 0,\n      mouseHistory     : [],\n      pinchDist        : 0,\n      keyHandler       : new PressHandler(),\n      ctrlKeyDown      : false,\n      dblclickData     : null,\n      dblclickTimeout  : null,\n      longtouchTimeout : null,\n      twofingersTimeout: null,\n      ctrlZoomTimeout  : null,\n    };\n\n    /**\n     * @summary Throttled wrapper of {@link PSV.Viewer#autoSize}\n     * @type {Function}\n     * @private\n     */\n    this.__onResize = throttle(() => this.psv.autoSize(), 50);\n  }\n\n  /**\n   * @summary Initializes event handlers\n   * @protected\n   */\n  init() {\n    window.addEventListener('resize', this);\n    window.addEventListener('keydown', this, { passive: false });\n    window.addEventListener('keyup', this);\n    this.psv.container.addEventListener('mousedown', this);\n    window.addEventListener('mousemove', this, { passive: false });\n    window.addEventListener('mouseup', this);\n    this.psv.container.addEventListener('touchstart', this, { passive: false });\n    window.addEventListener('touchmove', this, { passive: false });\n    window.addEventListener('touchend', this, { passive: false });\n    this.psv.container.addEventListener(SYSTEM.mouseWheelEvent, this, { passive: false });\n\n    if (SYSTEM.fullscreenEvent) {\n      document.addEventListener(SYSTEM.fullscreenEvent, this);\n    }\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    window.removeEventListener('resize', this);\n    window.removeEventListener('keydown', this);\n    window.removeEventListener('keyup', this);\n    this.psv.container.removeEventListener('mousedown', this);\n    window.removeEventListener('mousemove', this);\n    window.removeEventListener('mouseup', this);\n    this.psv.container.removeEventListener('touchstart', this);\n    window.removeEventListener('touchmove', this);\n    window.removeEventListener('touchend', this);\n    this.psv.container.removeEventListener(SYSTEM.mouseWheelEvent, this);\n\n    if (SYSTEM.fullscreenEvent) {\n      document.removeEventListener(SYSTEM.fullscreenEvent, this);\n    }\n\n    clearTimeout(this.state.dblclickTimeout);\n    clearTimeout(this.state.longtouchTimeout);\n    clearTimeout(this.state.twofingersTimeout);\n    clearTimeout(this.state.ctrlZoomTimeout);\n\n    delete this.state;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} evt\n   * @private\n   */\n  handleEvent(evt) {\n    /* eslint-disable */\n    switch (evt.type) {\n      // @formatter:off\n      case 'resize':    this.__onResize(); break;\n      case 'keydown':   this.__onKeyDown(evt); break;\n      case 'keyup':     this.__onKeyUp(); break;\n      case 'mousemove': this.__onMouseMove(evt); break;\n      case 'mouseup':   this.__onMouseUp(evt); break;\n      case 'touchmove': this.__onTouchMove(evt); break;\n      case 'touchend':  this.__onTouchEnd(evt); break;\n      case SYSTEM.fullscreenEvent: this.__fullscreenToggled(); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n\n    if (!getClosest(evt.target, '.psv--capture-event')) {\n      /* eslint-disable */\n      switch (evt.type) {\n        // @formatter:off\n        case 'mousedown':  this.__onMouseDown(evt); break;\n        case 'touchstart': this.__onTouchStart(evt); break;\n        case SYSTEM.mouseWheelEvent: this.__onMouseWheel(evt); break;\n        // @formatter:on\n      }\n      /* eslint-enable */\n    }\n  }\n\n  /**\n   * @summary Enables the keyboard controls\n   * @protected\n   */\n  enableKeyboard() {\n    this.state.keyboardEnabled = true;\n  }\n\n  /**\n   * @summary Disables the keyboard controls\n   * @protected\n   */\n  disableKeyboard() {\n    this.state.keyboardEnabled = false;\n  }\n\n  /**\n   * @summary Handles keyboard events\n   * @param {KeyboardEvent} e\n   * @private\n   */\n  __onKeyDown(e) {\n    if (this.config.mousewheelCtrlKey) {\n      this.state.ctrlKeyDown = e.key === KEY_CODES.Control;\n\n      if (this.state.ctrlKeyDown) {\n        clearTimeout(this.state.ctrlZoomTimeout);\n        this.psv.overlay.hide(IDS.CTRL_ZOOM);\n      }\n    }\n\n    const e2 = this.psv.trigger(EVENTS.KEY_PRESS, e.key);\n    if (e2.isDefaultPrevented()) {\n      return;\n    }\n\n    if (!this.state.keyboardEnabled) {\n      return;\n    }\n\n    const action = this.config.keyboard[e.key];\n    if (action === ACTIONS.TOGGLE_AUTOROTATE) {\n      this.psv.toggleAutorotate();\n      e.preventDefault();\n    }\n    else if (action && !this.state.keyHandler.time) {\n      if (action !== ACTIONS.ZOOM_IN && action !== ACTIONS.ZOOM_OUT) {\n        this.psv.__stopAll();\n      }\n\n      /* eslint-disable */\n      switch (action) {\n        // @formatter:off\n        case ACTIONS.ROTATE_LAT_UP: this.psv.dynamics.position.roll({latitude: false}); break;\n        case ACTIONS.ROTATE_LAT_DOWN: this.psv.dynamics.position.roll({latitude: true});  break;\n        case ACTIONS.ROTATE_LONG_RIGHT: this.psv.dynamics.position.roll({longitude: false}); break;\n        case ACTIONS.ROTATE_LONG_LEFT: this.psv.dynamics.position.roll({longitude: true}); break;\n        case ACTIONS.ZOOM_IN: this.psv.dynamics.zoom.roll(false); break;\n        case ACTIONS.ZOOM_OUT: this.psv.dynamics.zoom.roll(true); break;\n        // @formatter:on\n      }\n      /* eslint-enable */\n\n      this.state.keyHandler.down();\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * @summary Handles keyboard events\n   * @private\n   */\n  __onKeyUp() {\n    this.state.ctrlKeyDown = false;\n\n    if (!this.state.keyboardEnabled) {\n      return;\n    }\n\n    this.state.keyHandler.up(() => {\n      this.psv.dynamics.position.stop();\n      this.psv.dynamics.zoom.stop();\n      this.psv.resetIdleTimer();\n    });\n  }\n\n  /**\n   * @summary Handles mouse down events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  __onMouseDown(evt) {\n    this.state.mousedown = true;\n    this.state.startMouseX = evt.clientX;\n    this.state.startMouseY = evt.clientY;\n  }\n\n  /**\n   * @summary Handles mouse up events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  __onMouseUp(evt) {\n    if (this.state.mousedown || this.state.step === MOVING) {\n      this.__stopMove(evt.clientX, evt.clientY, evt.target, evt.button === 2);\n    }\n  }\n\n  /**\n   * @summary Handles mouse move events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  __onMouseMove(evt) {\n    if (this.config.mousemove && (this.state.mousedown || this.state.step === MOVING)) {\n      evt.preventDefault();\n      this.__move(evt.clientX, evt.clientY);\n    }\n\n    if (!isEmpty(this.prop.objectsObservers) && hasParent(evt.target, this.psv.container)) {\n      const viewerPos = getPosition(this.psv.container);\n\n      const viewerPoint = {\n        x: evt.clientX - viewerPos.left,\n        y: evt.clientY - viewerPos.top,\n      };\n\n      const intersections = this.psv.dataHelper.getIntersections(viewerPoint);\n\n      const emit = (observer, key, type) => {\n        observer.listener.handleEvent(new CustomEvent(type, {\n          detail: {\n            originalEvent: evt,\n            object       : observer.object,\n            data         : observer.object.userData[key],\n            viewerPoint  : viewerPoint,\n          },\n        }));\n      };\n\n      each(this.prop.objectsObservers, (observer, key) => {\n        const intersection = intersections.find(i => i.object.userData[key]);\n\n        if (intersection) {\n          if (observer.object && intersection.object !== observer.object) {\n            emit(observer, key, OBJECT_EVENTS.LEAVE_OBJECT);\n            delete observer.object;\n          }\n\n          if (!observer.object) {\n            observer.object = intersection.object;\n            emit(observer, key, OBJECT_EVENTS.ENTER_OBJECT);\n          }\n          else {\n            emit(observer, key, OBJECT_EVENTS.HOVER_OBJECT);\n          }\n        }\n        else if (observer.object) {\n          emit(observer, key, OBJECT_EVENTS.LEAVE_OBJECT);\n          delete observer.object;\n        }\n      });\n    }\n  }\n\n  /**\n   * @summary Handles touch events\n   * @param {TouchEvent} evt\n   * @private\n   */\n  __onTouchStart(evt) {\n    if (evt.touches.length === 1) {\n      this.state.mousedown = true;\n      this.state.startMouseX = evt.touches[0].clientX;\n      this.state.startMouseY = evt.touches[0].clientY;\n\n      if (!this.prop.longtouchTimeout) {\n        this.prop.longtouchTimeout = setTimeout(() => {\n          const touch = evt.touches[0];\n          this.__stopMove(touch.clientX, touch.clientY, touch.target, true);\n          this.prop.longtouchTimeout = null;\n        }, LONGTOUCH_DELAY);\n      }\n    }\n    else if (evt.touches.length === 2) {\n      this.state.mousedown = false;\n      this.__cancelLongTouch();\n\n      if (this.config.mousemove) {\n        this.__cancelTwoFingersOverlay();\n        this.__startMoveZoom(evt);\n        evt.preventDefault();\n      }\n    }\n  }\n\n  /**\n   * @summary Handles touch events\n   * @param {TouchEvent} evt\n   * @private\n   */\n  __onTouchEnd(evt) {\n    this.__cancelLongTouch();\n\n    if (this.state.mousedown || this.state.step === MOVING) {\n      evt.preventDefault();\n      this.__cancelTwoFingersOverlay();\n\n      if (evt.touches.length === 1) {\n        this.__stopMove(this.state.mouseX, this.state.mouseY);\n      }\n      else if (evt.touches.length === 0) {\n        const touch = evt.changedTouches[0];\n        this.__stopMove(touch.clientX, touch.clientY, touch.target);\n      }\n    }\n  }\n\n  /**\n   * @summary Handles touch move events\n   * @param {TouchEvent} evt\n   * @private\n   */\n  __onTouchMove(evt) {\n    this.__cancelLongTouch();\n\n    if (!this.config.mousemove) {\n      return;\n    }\n\n    if (evt.touches.length === 1) {\n      if (this.config.touchmoveTwoFingers) {\n        if (this.state.mousedown && !this.prop.twofingersTimeout) {\n          this.prop.twofingersTimeout = setTimeout(() => {\n            this.psv.overlay.show({\n              id   : IDS.TWO_FINGERS,\n              image: gestureIcon,\n              text : this.config.lang.twoFingers,\n            });\n          }, TWOFINGERSOVERLAY_DELAY);\n        }\n      }\n      else if (this.state.mousedown || this.state.step === MOVING) {\n        evt.preventDefault();\n        const touch = evt.touches[0];\n        this.__move(touch.clientX, touch.clientY);\n      }\n    }\n    else {\n      evt.preventDefault();\n      this.__moveZoom(evt);\n      this.__cancelTwoFingersOverlay();\n    }\n  }\n\n  /**\n   * @summary Cancel the long touch timer if any\n   * @private\n   */\n  __cancelLongTouch() {\n    if (this.prop.longtouchTimeout) {\n      clearTimeout(this.prop.longtouchTimeout);\n      this.prop.longtouchTimeout = null;\n    }\n  }\n\n  /**\n   * @summary Cancel the two fingers overlay timer if any\n   * @private\n   */\n  __cancelTwoFingersOverlay() {\n    if (this.config.touchmoveTwoFingers) {\n      if (this.prop.twofingersTimeout) {\n        clearTimeout(this.prop.twofingersTimeout);\n        this.prop.twofingersTimeout = null;\n      }\n      this.psv.overlay.hide(IDS.TWO_FINGERS);\n    }\n  }\n\n  /**\n   * @summary Handles mouse wheel events\n   * @param {WheelEvent} evt\n   * @private\n   */\n  __onMouseWheel(evt) {\n    if (!this.config.mousewheel) {\n      return;\n    }\n\n    if (this.config.mousewheelCtrlKey && !this.state.ctrlKeyDown) {\n      this.psv.overlay.show({\n        id   : IDS.CTRL_ZOOM,\n        image: mousewheelIcon,\n        text : this.config.lang.ctrlZoom,\n      });\n\n      clearTimeout(this.state.ctrlZoomTimeout);\n      this.state.ctrlZoomTimeout = setTimeout(() => this.psv.overlay.hide(IDS.CTRL_ZOOM), CTRLZOOM_TIMEOUT);\n\n      return;\n    }\n\n    evt.preventDefault();\n    evt.stopPropagation();\n\n    const delta = normalizeWheel(evt).spinY * 5 * this.config.zoomSpeed;\n    if (delta !== 0) {\n      this.psv.dynamics.zoom.step(-delta, 5);\n    }\n  }\n\n  /**\n   * @summary Handles fullscreen events\n   * @param {boolean} [force] force state\n   * @fires PSV.fullscreen-updated\n   * @package\n   */\n  __fullscreenToggled(force) {\n    this.prop.fullscreen = force !== undefined ? force : isFullscreenEnabled(this.psv.container);\n\n    if (this.config.keyboard) {\n      if (this.prop.fullscreen) {\n        this.psv.startKeyboardControl();\n      }\n      else {\n        this.psv.stopKeyboardControl();\n      }\n    }\n\n    this.psv.trigger(EVENTS.FULLSCREEN_UPDATED, this.prop.fullscreen);\n  }\n\n  /**\n   * @summary Resets all state variables\n   * @private\n   */\n  __resetMove() {\n    this.state.step = IDLE;\n    this.state.mousedown = false;\n    this.state.mouseX = 0;\n    this.state.mouseY = 0;\n    this.state.startMouseX = 0;\n    this.state.startMouseY = 0;\n    this.state.mouseHistory.length = 0;\n  }\n\n  /**\n   * @summary Initializes the combines move and zoom\n   * @param {TouchEvent} evt\n   * @private\n   */\n  __startMoveZoom(evt) {\n    this.psv.__stopAll();\n    this.__resetMove();\n\n    const p1 = { x: evt.touches[0].clientX, y: evt.touches[0].clientY };\n    const p2 = { x: evt.touches[1].clientX, y: evt.touches[1].clientY };\n\n    this.state.step = MOVING;\n    this.state.pinchDist = distance(p1, p2);\n    this.state.mouseX = (p1.x + p2.x) / 2;\n    this.state.mouseY = (p1.y + p2.y) / 2;\n    this.__logMouseMove(this.state.mouseX, this.state.mouseY);\n  }\n\n  /**\n   * @summary Stops the movement\n   * @description If the move threshold was not reached a click event is triggered, otherwise an animation is launched to simulate inertia\n   * @param {int} clientX\n   * @param {int} clientY\n   * @param {EventTarget} [target]\n   * @param {boolean} [rightclick=false]\n   * @private\n   */\n  __stopMove(clientX, clientY, target = null, rightclick = false) {\n    if (this.state.step === MOVING) {\n      if (this.config.moveInertia) {\n        this.__logMouseMove(clientX, clientY);\n        this.__stopMoveInertia(clientX, clientY);\n      }\n      else {\n        this.__resetMove();\n        this.psv.resetIdleTimer();\n      }\n    }\n    else if (this.state.mousedown) {\n      this.psv.stopAnimation();\n      this.__click(clientX, clientY, target, rightclick);\n      this.__resetMove();\n      this.psv.resetIdleTimer();\n    }\n  }\n\n  /**\n   * @summary Performs an animation to simulate inertia when the movement stops\n   * @param {int} clientX\n   * @param {int} clientY\n   * @private\n   */\n  __stopMoveInertia(clientX, clientY) {\n    // get direction at end of movement\n    const curve = new SplineCurve(this.state.mouseHistory.map(([, x, y]) => new Vector2(x, y)));\n    const direction = curve.getTangent(1);\n\n    // average speed\n    const speed = this.state.mouseHistory.slice(1).reduce(({ total, prev }, curr) => {\n      return {\n        total: total + distance({ x: prev[1], y: prev[2] }, { x: curr[1], y: curr[2] }) / (curr[0] - prev[0]),\n        prev : curr,\n      };\n    }, {\n      total: 0,\n      prev : this.state.mouseHistory[0],\n    }).total / this.state.mouseHistory.length;\n\n    if (!speed) {\n      this.__resetMove();\n      this.psv.resetIdleTimer();\n      return;\n    }\n\n    this.state.step = INERTIA;\n\n    let currentClientX = clientX;\n    let currentClientY = clientY;\n\n    this.prop.animationPromise = new Animation({\n      properties: {\n        speed: { start: speed, end: 0 },\n      },\n      duration  : 1000,\n      easing    : 'outQuad',\n      onTick    : (properties) => {\n        // 3 is a magic number\n        currentClientX += properties.speed * direction.x * 3 * SYSTEM.pixelRatio;\n        currentClientY += properties.speed * direction.y * 3 * SYSTEM.pixelRatio;\n        this.__applyMove(currentClientX, currentClientY);\n      },\n    });\n\n    this.prop.animationPromise\n      .then((done) => {\n        this.prop.animationPromise = null;\n        if (done) {\n          this.__resetMove();\n          this.psv.resetIdleTimer();\n        }\n      });\n  }\n\n  /**\n   * @summary Triggers an event with all coordinates when a simple click is performed\n   * @param {int} clientX\n   * @param {int} clientY\n   * @param {EventTarget} target\n   * @param {boolean} [rightclick=false]\n   * @fires PSV.click\n   * @fires PSV.dblclick\n   * @private\n   */\n  __click(clientX, clientY, target, rightclick = false) {\n    const boundingRect = this.psv.container.getBoundingClientRect();\n\n    /**\n     * @type {PSV.ClickData}\n     */\n    const data = {\n      rightclick: rightclick,\n      target    : target,\n      clientX   : clientX,\n      clientY   : clientY,\n      viewerX   : clientX - boundingRect.left,\n      viewerY   : clientY - boundingRect.top,\n    };\n\n    const intersections = this.psv.dataHelper.getIntersections({\n      x: data.viewerX,\n      y: data.viewerY,\n    });\n\n    const sphereIntersection = intersections.find(i => i.object.userData[MESH_USER_DATA]);\n\n    if (sphereIntersection) {\n      const sphericalCoords = this.psv.dataHelper.vector3ToSphericalCoords(sphereIntersection.point);\n      data.longitude = sphericalCoords.longitude;\n      data.latitude = sphericalCoords.latitude;\n\n      data.objects = intersections.map(i => i.object).filter(o => !o.userData[MESH_USER_DATA]);\n\n      try {\n        const textureCoords = this.psv.dataHelper.sphericalCoordsToTextureCoords(data);\n        data.textureX = textureCoords.x;\n        data.textureY = textureCoords.y;\n      }\n      catch (e) {\n        data.textureX = NaN;\n        data.textureY = NaN;\n      }\n\n      if (!this.state.dblclickTimeout) {\n        this.psv.trigger(EVENTS.CLICK, data);\n\n        this.state.dblclickData = clone(data);\n        this.state.dblclickTimeout = setTimeout(() => {\n          this.state.dblclickTimeout = null;\n          this.state.dblclickData = null;\n        }, DBLCLICK_DELAY);\n      }\n      else {\n        if (Math.abs(this.state.dblclickData.clientX - data.clientX) < this.state.moveThreshold\n          && Math.abs(this.state.dblclickData.clientY - data.clientY) < this.state.moveThreshold) {\n          this.psv.trigger(EVENTS.DOUBLE_CLICK, this.state.dblclickData);\n        }\n\n        clearTimeout(this.state.dblclickTimeout);\n        this.state.dblclickTimeout = null;\n        this.state.dblclickData = null;\n      }\n    }\n  }\n\n  /**\n   * @summary Starts moving when crossing moveThreshold and performs movement\n   * @param {int} clientX\n   * @param {int} clientY\n   * @private\n   */\n  __move(clientX, clientY) {\n    if (this.state.mousedown\n      && (Math.abs(clientX - this.state.startMouseX) >= this.state.moveThreshold\n        || Math.abs(clientY - this.state.startMouseY) >= this.state.moveThreshold)) {\n      this.psv.__stopAll();\n      this.__resetMove();\n      this.state.step = MOVING;\n      this.state.mouseX = clientX;\n      this.state.mouseY = clientY;\n      this.__logMouseMove(clientX, clientY);\n    }\n    else if (this.state.step === MOVING) {\n      this.__applyMove(clientX, clientY);\n      this.__logMouseMove(clientX, clientY);\n    }\n  }\n\n  /**\n   * @summary Raw method for movement, called from mouse event and move inertia\n   * @param {int} clientX\n   * @param {int} clientY\n   * @private\n   */\n  __applyMove(clientX, clientY) {\n    const rotation = {\n      longitude: (clientX - this.state.mouseX) / this.prop.size.width * this.config.moveSpeed\n        * MathUtils.degToRad(this.prop.littlePlanet ? 90 : this.prop.hFov),\n      latitude : (clientY - this.state.mouseY) / this.prop.size.height * this.config.moveSpeed\n        * MathUtils.degToRad(this.prop.littlePlanet ? 90 : this.prop.vFov),\n    };\n\n    const currentPosition = this.psv.getPosition();\n    this.psv.rotate({\n      longitude: currentPosition.longitude - rotation.longitude,\n      latitude : currentPosition.latitude + rotation.latitude,\n    });\n\n    this.state.mouseX = clientX;\n    this.state.mouseY = clientY;\n  }\n\n  /**\n   * @summary Perfoms combined move and zoom\n   * @param {TouchEvent} evt\n   * @private\n   */\n  __moveZoom(evt) {\n    if (this.state.step === MOVING) {\n      const p1 = { x: evt.touches[0].clientX, y: evt.touches[0].clientY };\n      const p2 = { x: evt.touches[1].clientX, y: evt.touches[1].clientY };\n\n      const p = distance(p1, p2);\n      const delta = (p - this.state.pinchDist) / SYSTEM.pixelRatio * this.config.zoomSpeed;\n\n      this.psv.zoom(this.psv.getZoomLevel() + delta);\n\n      this.__move((p1.x + p2.x) / 2, (p1.y + p2.y) / 2);\n\n      this.state.pinchDist = p;\n    }\n  }\n\n  /**\n   * @summary Stores each mouse position during a mouse move\n   * @description Positions older than \"INERTIA_WINDOW\" are removed<br>\n   *     Positions before a pause of \"INERTIA_WINDOW\" / 10 are removed\n   * @param {int} clientX\n   * @param {int} clientY\n   * @private\n   */\n  __logMouseMove(clientX, clientY) {\n    const now = Date.now();\n\n    const last = this.state.mouseHistory.length ? this.state.mouseHistory[this.state.mouseHistory.length - 1] : [0, -1, -1];\n\n    // avoid duplicates\n    if (last[1] === clientX && last[2] === clientY) {\n      last[0] = now;\n    }\n    else if (now === last[0]) {\n      last[1] = clientX;\n      last[2] = clientY;\n    }\n    else {\n      this.state.mouseHistory.push([now, clientX, clientY]);\n    }\n\n    let previous = null;\n\n    for (let i = 0; i < this.state.mouseHistory.length;) {\n      if (this.state.mouseHistory[i][0] < now - INERTIA_WINDOW) {\n        this.state.mouseHistory.splice(i, 1);\n      }\n      else if (previous && this.state.mouseHistory[i][0] - previous > INERTIA_WINDOW / 10) {\n        this.state.mouseHistory.splice(0, i);\n        i = 0;\n        previous = this.state.mouseHistory[i][0];\n      }\n      else {\n        previous = this.state.mouseHistory[i][0];\n        i++;\n      }\n    }\n  }\n\n}\n","import { Group, PerspectiveCamera, Raycaster, Scene, Vector3, WebGLRenderer } from 'three';\nimport { EVENTS, MESH_USER_DATA, SPHERE_RADIUS } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { Animation, each, isExtendedPosition } from '../utils';\nimport { AbstractService } from './AbstractService';\n\n/**\n * @summary Viewer and renderer\n * @extends PSV.services.AbstractService\n * @memberof PSV.services\n */\nexport class Renderer extends AbstractService {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv);\n\n    /**\n     * @member {external:THREE.WebGLRenderer}\n     * @readonly\n     * @protected\n     */\n    this.renderer = new WebGLRenderer({ alpha: true, antialias: true });\n    this.renderer.setPixelRatio(SYSTEM.pixelRatio);\n    this.renderer.domElement.className = 'psv-canvas';\n\n    /**\n     * @member {external:THREE.Scene}\n     * @readonly\n     * @protected\n     */\n    this.scene = new Scene();\n\n    /**\n     * @member {external:THREE.PerspectiveCamera}\n     * @readonly\n     * @protected\n     */\n    this.camera = new PerspectiveCamera(50, 16 / 9, 0.1, 2 * SPHERE_RADIUS);\n\n    /**\n     * @member {external:THREE.Mesh}\n     * @readonly\n     * @protected\n     */\n    this.mesh = this.psv.adapter.createMesh();\n    this.mesh.userData = { [MESH_USER_DATA]: true };\n\n    /**\n     * @member {external:THREE.Group}\n     * @readonly\n     * @private\n     */\n    this.meshContainer = new Group();\n    this.meshContainer.add(this.mesh);\n    this.scene.add(this.meshContainer);\n\n    /**\n     * @member {external:THREE.Raycaster}\n     * @readonly\n     * @protected\n     */\n    this.raycaster = new Raycaster();\n\n    /**\n     * @member {number}\n     * @private\n     */\n    this.timestamp = null;\n\n    /**\n     * @member {boolean}\n     * @private\n     */\n    this.ready = false;\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     * @package\n     */\n    this.canvasContainer = document.createElement('div');\n    this.canvasContainer.className = 'psv-canvas-container';\n    this.canvasContainer.style.background = this.psv.config.canvasBackground;\n    this.canvasContainer.style.cursor = this.psv.config.mousemove ? 'move' : 'default';\n    this.canvasContainer.appendChild(this.renderer.domElement);\n    this.psv.container.appendChild(this.canvasContainer);\n\n    psv.on(EVENTS.SIZE_UPDATED, this);\n    psv.on(EVENTS.ZOOM_UPDATED, this);\n    psv.on(EVENTS.POSITION_UPDATED, this);\n    psv.on(EVENTS.CONFIG_CHANGED, this);\n\n    this.hide();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    // cancel render loop\n    this.renderer.setAnimationLoop(null);\n\n    // destroy ThreeJS view\n    this.__cleanTHREEScene(this.scene);\n\n    // remove container\n    this.psv.container.removeChild(this.canvasContainer);\n\n    delete this.canvasContainer;\n    delete this.renderer;\n    delete this.scene;\n    delete this.camera;\n    delete this.mesh;\n    delete this.meshContainer;\n    delete this.raycaster;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} evt\n   * @private\n   */\n  handleEvent(evt) {\n    /* eslint-disable */\n    switch (evt.type) {\n      // @formatter:off\n      case EVENTS.SIZE_UPDATED:     this.__onSizeUpdated(); break;\n      case EVENTS.ZOOM_UPDATED:     this.__onZoomUpdated(); break;\n      case EVENTS.POSITION_UPDATED: this.__onPositionUpdated(); break;\n      case EVENTS.CONFIG_CHANGED:\n        if (evt.args[0].includes('fisheye')) {\n          this.__onPositionUpdated();\n        }\n        if (evt.args[0].includes('mousemove')) {\n          this.canvasContainer.style.cursor = this.psv.config.mousemove ? 'move' : 'default';\n        }\n        break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @summary Hides the viewer\n   */\n  hide() {\n    this.canvasContainer.style.opacity = 0;\n  }\n\n  /**\n   * @summary Shows the viewer\n   */\n  show() {\n    this.canvasContainer.style.opacity = 1;\n  }\n\n  /**\n   * @summary Updates the size of the renderer and the aspect of the camera\n   * @private\n   */\n  __onSizeUpdated() {\n    this.renderer.setSize(this.prop.size.width, this.prop.size.height);\n    this.camera.aspect = this.prop.aspect;\n    this.camera.updateProjectionMatrix();\n    this.prop.needsUpdate = true;\n  }\n\n  /**\n   * @summary Updates the fov of the camera\n   * @private\n   */\n  __onZoomUpdated() {\n    this.camera.fov = this.prop.vFov;\n    this.camera.updateProjectionMatrix();\n    this.prop.needsUpdate = true;\n  }\n\n  /**\n   * @summary Updates the position of the camera\n   * @private\n   */\n  __onPositionUpdated() {\n    this.camera.position.set(0, 0, 0);\n    this.camera.lookAt(this.prop.direction);\n    if (this.config.fisheye) {\n      this.camera.position.copy(this.prop.direction).multiplyScalar(this.config.fisheye / 2).negate();\n    }\n    this.prop.needsUpdate = true;\n  }\n\n  /**\n   * @summary Main event loop, calls {@link render} if `prop.needsUpdate` is true\n   * @param {number} timestamp\n   * @fires PSV.before-render\n   * @private\n   */\n  __renderLoop(timestamp) {\n    const elapsed = this.timestamp !== null ? timestamp - this.timestamp : 0;\n    this.timestamp = timestamp;\n\n    this.psv.trigger(EVENTS.BEFORE_RENDER, timestamp, elapsed);\n    each(this.psv.dynamics, d => d.update(elapsed));\n\n    if (this.prop.idleTime > 0 && timestamp - this.prop.idleTime > this.config.autorotateDelay) {\n      this.psv.startAutorotate();\n    }\n\n    if (this.prop.needsUpdate) {\n      this.render();\n      this.prop.needsUpdate = false;\n    }\n  }\n\n  /**\n   * @summary Performs a render\n   * @description Do not call this method directly, instead call\n   * {@link PSV.Viewer#needsUpdate} on {@link PSV.event:before-render}.\n   * @fires PSV.render\n   */\n  render() {\n    this.renderer.render(this.scene, this.camera);\n    this.psv.trigger(EVENTS.RENDER);\n  }\n\n  /**\n   * @summary Applies the texture to the scene, creates the scene if needed\n   * @param {PSV.TextureData} textureData\n   * @fires PSV.panorama-loaded\n   * @package\n   */\n  setTexture(textureData) {\n    this.prop.panoData = textureData.panoData;\n\n    this.psv.adapter.setTexture(this.mesh, textureData);\n\n    if (!this.ready) {\n      this.renderer.setAnimationLoop(t => this.__renderLoop(t));\n      this.ready = true;\n    }\n\n    this.psv.needsUpdate();\n\n    this.psv.trigger(EVENTS.PANORAMA_LOADED, textureData);\n  }\n\n  /**\n   * @summary Applies the overlay to the mesh\n   * @param {PSV.TextureData} textureData\n   * @param {number} opacity\n   * @package\n   */\n  setOverlay(textureData, opacity) {\n    this.psv.adapter.setOverlay(this.mesh, textureData, opacity);\n    this.psv.needsUpdate();\n  }\n\n  /**\n   * @summary Apply a panorama data pose to a Mesh\n   * @param {PSV.PanoData} [panoData]\n   * @param {external:THREE.Mesh} [mesh=this.mesh]\n   * @package\n   */\n  setPanoramaPose(panoData, mesh = this.mesh) {\n    // By Google documentation the angles are applied on the camera in order : heading, pitch, roll\n    // here we apply the reverse transformation on the sphere\n    const cleanCorrection = this.psv.dataHelper.cleanPanoramaPose(panoData);\n\n    mesh.rotation.set(\n      -cleanCorrection.tilt,\n      -cleanCorrection.pan,\n      -cleanCorrection.roll,\n      'ZXY'\n    );\n  }\n\n  /**\n   * @summary Apply a SphereCorrection to a Mesh\n   * @param {PSV.SphereCorrection} [sphereCorrection]\n   * @param {external:THREE.Mesh} [mesh=this.meshContainer]\n   * @package\n   */\n  setSphereCorrection(sphereCorrection, mesh = this.meshContainer) {\n    const cleanCorrection = this.psv.dataHelper.cleanSphereCorrection(sphereCorrection);\n\n    mesh.rotation.set(\n      cleanCorrection.tilt,\n      cleanCorrection.pan,\n      cleanCorrection.roll,\n      'ZXY'\n    );\n  }\n\n  /**\n   * @summary Performs transition between the current and a new texture\n   * @param {PSV.TextureData} textureData\n   * @param {PSV.PanoramaOptions} options\n   * @returns {PSV.utils.Animation}\n   * @package\n   */\n  transition(textureData, options) {\n    const positionProvided = isExtendedPosition(options);\n    const zoomProvided = 'zoom' in options;\n\n    // create temp group and new mesh, half size to be in \"front\" of the first one\n    const group = new Group();\n    const mesh = this.psv.adapter.createMesh(0.5);\n    this.psv.adapter.setTexture(mesh, textureData, true);\n    this.psv.adapter.setTextureOpacity(mesh, 0);\n    this.setPanoramaPose(textureData.panoData, mesh);\n    this.setSphereCorrection(options.sphereCorrection, group);\n\n    // rotate the new sphere to make the target position face the camera\n    if (positionProvided) {\n      const cleanPosition = this.psv.dataHelper.cleanPosition(options);\n      const currentPosition = this.psv.getPosition();\n\n      // Longitude rotation along the vertical axis\n      const verticalAxis = new Vector3(0, 1, 0);\n      group.rotateOnWorldAxis(verticalAxis, cleanPosition.longitude - currentPosition.longitude);\n\n      // Latitude rotation along the camera horizontal axis\n      const horizontalAxis = new Vector3(0, 1, 0).cross(this.camera.getWorldDirection(new Vector3())).normalize();\n      group.rotateOnWorldAxis(horizontalAxis, cleanPosition.latitude - currentPosition.latitude);\n    }\n\n    group.add(mesh);\n    this.scene.add(group);\n\n    const animation = new Animation({\n      properties: {\n        opacity: { start: 0.0, end: 1.0 },\n        zoom   : zoomProvided ? { start: this.psv.getZoomLevel(), end: options.zoom } : undefined,\n      },\n      duration  : options.transition,\n      easing    : 'outCubic',\n      onTick    : (properties) => {\n        this.psv.adapter.setTextureOpacity(mesh, properties.opacity);\n        this.psv.adapter.setTextureOpacity(this.mesh, 1 - properties.opacity);\n\n        if (zoomProvided) {\n          this.psv.zoom(properties.zoom);\n        }\n\n        this.psv.needsUpdate();\n      },\n    });\n\n    animation\n      .then((completed) => {\n        if (completed) {\n          // remove temp sphere and transfer the texture to the main mesh\n          this.setTexture(textureData);\n          this.psv.adapter.setTextureOpacity(this.mesh, 1);\n          this.setPanoramaPose(textureData.panoData);\n          this.setSphereCorrection(options.sphereCorrection);\n\n          // actually rotate the camera\n          if (positionProvided) {\n            this.psv.rotate(options);\n          }\n        }\n        else {\n          this.psv.adapter.disposeTexture(textureData);\n        }\n\n        this.scene.remove(group);\n        mesh.geometry.dispose();\n        mesh.geometry = null;\n      });\n\n    return animation;\n  }\n\n  /**\n   * @summary Calls `dispose` on all objects and textures\n   * @param {external:THREE.Object3D} object\n   * @private\n   */\n  __cleanTHREEScene(object) {\n    object.traverse((item) => {\n      if (item.geometry) {\n        item.geometry.dispose();\n      }\n\n      if (item.material) {\n        if (Array.isArray(item.material)) {\n          item.material.forEach((material) => {\n            if (material.map) {\n              material.map.dispose();\n            }\n\n            material.dispose();\n          });\n        }\n        else {\n          if (item.material.map) {\n            item.material.map.dispose();\n          }\n\n          item.material.dispose();\n        }\n      }\n\n      if (item.dispose && !(item instanceof Scene)) {\n        item.dispose();\n      }\n\n      if (item !== object) {\n        this.__cleanTHREEScene(item);\n      }\n    });\n  }\n\n}\n","import { FileLoader } from 'three';\nimport { AbstractService } from './AbstractService';\n\n/**\n * @summary Texture loader\n * @extends PSV.services.AbstractService\n * @memberof PSV.services\n */\nexport class TextureLoader extends AbstractService {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv);\n\n    /**\n     * @summary THREE file loader\n     * @type {external:THREE:FileLoader}\n     * @private\n     */\n    this.loader = new FileLoader();\n    this.loader.setResponseType('blob');\n    if (this.config.withCredentials) {\n      this.loader.setWithCredentials(true);\n    }\n    if (this.config.requestHeaders && typeof this.config.requestHeaders === 'object') {\n      this.loader.setRequestHeader(this.config.requestHeaders);\n    }\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.abortLoading();\n    super.destroy();\n  }\n\n  /**\n   * @summary Cancels current HTTP requests\n   * @package\n   */\n  abortLoading() {\n    // noop implementation waiting for https://github.com/mrdoob/three.js/pull/23070\n  }\n\n  /**\n   * @summary Loads a Blob with FileLoader\n   * @param {string} url\n   * @param {function(number)} [onProgress]\n   * @returns {Promise<Blob>}\n   */\n  loadFile(url, onProgress) {\n    if (this.config.requestHeaders && typeof this.config.requestHeaders === 'function') {\n      this.loader.setRequestHeader(this.config.requestHeaders(url));\n    }\n\n    return new Promise((resolve, reject) => {\n      let progress = 0;\n      onProgress?.(progress);\n\n      this.loader.load(\n        url,\n        (result) => {\n          progress = 100;\n          onProgress?.(progress);\n          resolve(result);\n        },\n        (e) => {\n          if (e.lengthComputable) {\n            const newProgress = e.loaded / e.total * 100;\n            if (newProgress > progress) {\n              progress = newProgress;\n              onProgress?.(progress);\n            }\n          }\n        },\n        (err) => {\n          reject(err);\n        }\n      );\n    });\n  }\n\n  /**\n   * @summary Loads an Image using FileLoader to have progress events\n   * @param {string} url\n   * @param {function(number)} [onProgress]\n   * @returns {Promise<HTMLImageElement>}\n   */\n  loadImage(url, onProgress) {\n    return this.loadFile(url, onProgress)\n      .then(result => new Promise((resolve, reject) => {\n        const img = document.createElementNS('http://www.w3.org/1999/xhtml', 'img');\n        img.onload = () => {\n          URL.revokeObjectURL(img.src);\n          resolve(img);\n        };\n        img.onerror = reject;\n        img.src = URL.createObjectURL(result);\n      }));\n  }\n\n  /**\n   * @summary Preload a panorama file without displaying it\n   * @param {*} panorama\n   * @returns {Promise}\n   */\n  preloadPanorama(panorama) {\n    if (this.psv.adapter.supportsPreload(panorama)) {\n      return this.psv.adapter.loadTexture(panorama);\n    }\n    else {\n      return Promise.resolve();\n    }\n  }\n\n}\n","import { EVENTS } from '../data/constants';\nimport { PSVError } from '../PSVError';\nimport { addClasses, cleanPosition, positionIsOrdered } from '../utils';\nimport { AbstractComponent } from './AbstractComponent';\n\nconst STATE = { NONE: 0, SHOWING: 1, HIDING: 2, READY: 3 };\n\n/**\n * @typedef {Object} PSV.components.Tooltip.Position\n * @summary Object defining the tooltip position\n * @property {number} top - Position of the tip of the arrow of the tooltip, in pixels\n * @property {number} left - Position of the tip of the arrow of the tooltip, in pixels\n * @property {string|string[]} [position='top center'] - Tooltip position toward it's arrow tip.\n *           Accepted values are combinations of `top`, `center`, `bottom` and `left`, `center`, `right`\n * @property {Object} [box] - Used when displaying a tooltip on a marker\n * @property {number} [box.width=0]\n * @property {number} [box.height=0]\n */\n\n/**\n * @typedef {PSV.components.Tooltip.Position} PSV.components.Tooltip.Config\n * @summary Object defining the tooltip configuration\n * @property {string} content - HTML content of the tooltip\n * @property {string} [className] - Additional CSS class added to the tooltip\n * @property {*} [data] - Userdata associated to the tooltip\n */\n\n/**\n * @summary Tooltip component\n * @description Never instanciate tooltips directly use {@link PSV.services.TooltipRenderer} instead\n * @extends PSV.components.AbstractComponent\n * @memberof PSV.components\n */\nexport class Tooltip extends AbstractComponent {\n\n  /**\n   * @param {PSV.Viewer} psv\n   * @param {{arrow: number, border: number}} size\n   */\n  constructor(psv, size) {\n    super(psv, 'psv-tooltip');\n\n    /**\n     * @override\n     * @property {number} arrow\n     * @property {number} border\n     * @property {number} width\n     * @property {number} height\n     * @property {string} pos\n     * @property {string} state\n     * @property {*} data\n     */\n    this.prop = {\n      ...this.prop,\n      ...size,\n      state : STATE.NONE,\n      width : 0,\n      height: 0,\n      pos   : '',\n      config: null,\n      data  : null,\n    };\n\n    /**\n     * Tooltip content\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.content = document.createElement('div');\n    this.content.className = 'psv-tooltip-content';\n    this.container.appendChild(this.content);\n\n    /**\n     * Tooltip arrow\n     * @member {HTMLElement}\n     * @readonly\n     * @package\n     */\n    this.arrow = document.createElement('div');\n    this.arrow.className = 'psv-tooltip-arrow';\n    this.container.appendChild(this.arrow);\n\n    this.container.addEventListener('transitionend', this);\n\n    this.container.style.top = '-1000px';\n    this.container.style.left = '-1000px';\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    delete this.arrow;\n    delete this.content;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case 'transitionend': this.__onTransitionEnd(e); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @summary This method is not supported\n   * @throws {PSV.PSVError} always\n   */\n  toggle() {\n    throw new PSVError('Tooltip cannot be toggled');\n  }\n\n  /**\n   * @summary Displays the tooltip on the viewer\n   * Do not call this method directly, use {@link PSV.services.TooltipRenderer} instead.\n   * @param {PSV.components.Tooltip.Config} config\n   *\n   * @fires PSV.show-tooltip\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   *\n   * @package\n   */\n  show(config) {\n    if (this.prop.state !== STATE.NONE) {\n      throw new PSVError('Initialized tooltip cannot be re-initialized');\n    }\n\n    if (config.className) {\n      addClasses(this.container, config.className);\n    }\n\n    this.content.innerHTML = config.content;\n\n    const rect = this.container.getBoundingClientRect();\n    this.prop.width = rect.right - rect.left;\n    this.prop.height = rect.bottom - rect.top;\n\n    this.prop.state = STATE.READY;\n\n    this.move(config);\n\n    this.prop.data = config.data;\n    this.prop.state = STATE.SHOWING;\n\n    this.psv.trigger(EVENTS.SHOW_TOOLTIP, this.prop.data, this);\n\n    this.__waitImages();\n  }\n\n  /**\n   * @summary Moves the tooltip to a new position\n   * @param {PSV.components.Tooltip.Position} config\n   *\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   */\n  move(config) {\n    if (this.prop.state !== STATE.SHOWING && this.prop.state !== STATE.READY) {\n      throw new PSVError('Uninitialized tooltip cannot be moved');\n    }\n\n    if (!config.box) {\n      config.box = {\n        width : 0,\n        height: 0,\n      };\n    }\n\n    this.config = config;\n\n    const t = this.container;\n    const a = this.arrow;\n\n    // compute size\n    const style = {\n      posClass : cleanPosition(config.position, { allowCenter: false, cssOrder: false }) || ['top', 'center'],\n      width    : this.prop.width,\n      height   : this.prop.height,\n      top      : 0,\n      left     : 0,\n      arrowTop : 0,\n      arrowLeft: 0,\n    };\n\n    // set initial position\n    this.__computeTooltipPosition(style, config);\n\n    // correct position if overflow\n    let swapY = null;\n    let swapX = null;\n    if (style.top < 0) {\n      swapY = 'bottom';\n    }\n    else if (style.top + style.height > this.psv.prop.size.height) {\n      swapY = 'top';\n    }\n    if (style.left < 0) {\n      swapX = 'right';\n    }\n    else if (style.left + style.width > this.psv.prop.size.width) {\n      swapX = 'left';\n    }\n    if (swapX || swapY) {\n      const ordered = positionIsOrdered(style.posClass);\n      if (swapY) {\n        style.posClass[ordered ? 0 : 1] = swapY;\n      }\n      if (swapX) {\n        style.posClass[ordered ? 1 : 0] = swapX;\n      }\n      this.__computeTooltipPosition(style, config);\n    }\n\n    // apply position\n    t.style.top = style.top + 'px';\n    t.style.left = style.left + 'px';\n\n    a.style.top = style.arrowTop + 'px';\n    a.style.left = style.arrowLeft + 'px';\n\n    const newPos = style.posClass.join('-');\n    if (newPos !== this.prop.pos) {\n      t.classList.remove(`psv-tooltip--${this.prop.pos}`);\n\n      this.prop.pos = newPos;\n      t.classList.add(`psv-tooltip--${this.prop.pos}`);\n    }\n  }\n\n  /**\n   * @summary Hides the tooltip\n   * @fires PSV.hide-tooltip\n   */\n  hide() {\n    this.container.classList.remove('psv-tooltip--visible');\n    this.prop.state = STATE.HIDING;\n\n    this.psv.trigger(EVENTS.HIDE_TOOLTIP, this.prop.data);\n  }\n\n  /**\n   * @summary Finalize transition\n   * @param {TransitionEvent} e\n   * @private\n   */\n  __onTransitionEnd(e) {\n    if (e.propertyName === 'transform') {\n      switch (this.prop.state) {\n        case STATE.SHOWING:\n          this.container.classList.add('psv-tooltip--visible');\n          this.prop.state = STATE.READY;\n          break;\n\n        case STATE.HIDING:\n          this.prop.state = STATE.NONE;\n          this.destroy();\n          break;\n\n        default:\n        // nothing\n      }\n    }\n  }\n\n  /**\n   * @summary Computes the position of the tooltip and its arrow\n   * @param {Object} style\n   * @param {Object} config\n   * @private\n   */\n  __computeTooltipPosition(style, config) {\n    const arrow = this.prop.arrow;\n    const top = config.top;\n    const height = style.height;\n    const left = config.left;\n    const width = style.width;\n    const offsetSide = arrow + this.prop.border;\n    const offsetX = config.box.width / 2 + arrow * 2;\n    const offsetY = config.box.height / 2 + arrow * 2;\n\n    switch (style.posClass.join('-')) {\n      case 'top-left':\n        style.top = top - offsetY - height;\n        style.left = left + offsetSide - width;\n        style.arrowTop = height;\n        style.arrowLeft = width - offsetSide - arrow;\n        break;\n      case 'top-center':\n        style.top = top - offsetY - height;\n        style.left = left - width / 2;\n        style.arrowTop = height;\n        style.arrowLeft = width / 2 - arrow;\n        break;\n      case 'top-right':\n        style.top = top - offsetY - height;\n        style.left = left - offsetSide;\n        style.arrowTop = height;\n        style.arrowLeft = arrow;\n        break;\n      case 'bottom-left':\n        style.top = top + offsetY;\n        style.left = left + offsetSide - width;\n        style.arrowTop = -arrow * 2;\n        style.arrowLeft = width - offsetSide - arrow;\n        break;\n      case 'bottom-center':\n        style.top = top + offsetY;\n        style.left = left - width / 2;\n        style.arrowTop = -arrow * 2;\n        style.arrowLeft = width / 2 - arrow;\n        break;\n      case 'bottom-right':\n        style.top = top + offsetY;\n        style.left = left - offsetSide;\n        style.arrowTop = -arrow * 2;\n        style.arrowLeft = arrow;\n        break;\n      case 'left-top':\n        style.top = top + offsetSide - height;\n        style.left = left - offsetX - width;\n        style.arrowTop = height - offsetSide - arrow;\n        style.arrowLeft = width;\n        break;\n      case 'center-left':\n        style.top = top - height / 2;\n        style.left = left - offsetX - width;\n        style.arrowTop = height / 2 - arrow;\n        style.arrowLeft = width;\n        break;\n      case 'left-bottom':\n        style.top = top - offsetSide;\n        style.left = left - offsetX - width;\n        style.arrowTop = arrow;\n        style.arrowLeft = width;\n        break;\n      case 'right-top':\n        style.top = top + offsetSide - height;\n        style.left = left + offsetX;\n        style.arrowTop = height - offsetSide - arrow;\n        style.arrowLeft = -arrow * 2;\n        break;\n      case 'center-right':\n        style.top = top - height / 2;\n        style.left = left + offsetX;\n        style.arrowTop = height / 2 - arrow;\n        style.arrowLeft = -arrow * 2;\n        break;\n      case 'right-bottom':\n        style.top = top - offsetSide;\n        style.left = left + offsetX;\n        style.arrowTop = arrow;\n        style.arrowLeft = -arrow * 2;\n        break;\n\n      // no default\n    }\n  }\n\n  /**\n   * @summary If the tooltip contains images, recompute its size once they are loaded\n   * @private\n   */\n  __waitImages() {\n    const images = this.content.querySelectorAll('img');\n\n    if (images.length > 0) {\n      const promises = [];\n\n      images.forEach((image) => {\n        promises.push(new Promise((resolve) => {\n          image.onload = resolve;\n          image.onerror = resolve;\n        }));\n      });\n\n      Promise.all(promises)\n        .then(() => {\n          if (this.prop.state === STATE.SHOWING || this.prop.state === STATE.READY) {\n            const rect = this.container.getBoundingClientRect();\n            this.prop.width = rect.right - rect.left;\n            this.prop.height = rect.bottom - rect.top;\n            this.move(this.config);\n          }\n        });\n    }\n  }\n\n}\n","import { Tooltip } from '../components/Tooltip';\nimport { getStyle } from '../utils';\nimport { AbstractService } from './AbstractService';\n\n/**\n * @summary Tooltip renderer\n * @extends PSV.services.AbstractService\n * @memberof PSV.services\n */\nexport class TooltipRenderer extends AbstractService {\n\n  /**\n   * @param {PSV.Viewer} psv\n   */\n  constructor(psv) {\n    super(psv);\n\n    const testTooltip = new Tooltip(this.psv, { arrow: 0, border: 0 });\n\n    /**\n     * @summary Computed static sizes\n     * @member {Object}\n     * @package\n     * @property {number} arrow\n     * @property {number} border\n     */\n    this.size = {\n      arrow : parseInt(getStyle(testTooltip.arrow, 'borderTopWidth'), 10),\n      border: parseInt(getStyle(testTooltip.container, 'borderTopLeftRadius'), 10),\n    };\n\n    testTooltip.destroy();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    delete this.size;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Displays a tooltip on the viewer\n   * @param {PSV.components.Tooltip.Config} config\n   * @returns {PSV.components.Tooltip}\n   *\n   * @fires PSV.show-tooltip\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   *\n   * @example\n   * viewer.tooltip.create({ content: 'Hello world', top: 200, left: 450, position: 'center bottom'})\n   */\n  create(config) {\n    const tooltip = new Tooltip(this.psv, this.size);\n    tooltip.show(config);\n\n    return tooltip;\n  }\n\n}\n","import { Cache, MathUtils, Vector3 } from 'three';\nimport { EventEmitter } from 'uevent';\nimport { Loader } from './components/Loader';\nimport { Navbar } from './components/Navbar';\nimport { Notification } from './components/Notification';\nimport { Overlay } from './components/Overlay';\nimport { Panel } from './components/Panel';\nimport { CONFIG_PARSERS, DEFAULTS, DEPRECATED_OPTIONS, getConfig, READONLY_OPTIONS } from './data/config';\nimport { CHANGE_EVENTS, DEFAULT_TRANSITION, EVENTS, IDS, SPHERE_RADIUS, VIEWER_DATA } from './data/constants';\nimport { SYSTEM } from './data/system';\nimport errorIcon from './icons/error.svg';\nimport { AbstractPlugin } from './plugins/AbstractPlugin';\nimport { PSVError } from './PSVError';\nimport { DataHelper } from './services/DataHelper';\nimport { EventsHandler } from './services/EventsHandler';\nimport { Renderer } from './services/Renderer';\nimport { TextureLoader } from './services/TextureLoader';\nimport { TooltipRenderer } from './services/TooltipRenderer';\nimport {\n  Animation,\n  Dynamic,\n  each,\n  exitFullscreen,\n  getAbortError,\n  getAngle,\n  getShortestArc,\n  isAbortError,\n  isExtendedPosition,\n  isFullscreenEnabled,\n  isNil,\n  logWarn,\n  MultiDynamic,\n  pluginInterop,\n  requestFullscreen,\n  throttle,\n  toggleClass\n} from './utils';\n\nCache.enabled = true;\n\n/**\n * @summary Main class\n * @memberOf PSV\n * @extends {external:uEvent.EventEmitter}\n */\nexport class Viewer extends EventEmitter {\n\n  /**\n   * @param {PSV.Options} options\n   * @fires PSV.ready\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   */\n  constructor(options) {\n    super();\n\n    SYSTEM.load();\n\n    // must support WebGL\n    if (!SYSTEM.isWebGLSupported) {\n      throw new PSVError('WebGL is not supported.');\n    }\n\n    if (SYSTEM.maxTextureWidth === 0) {\n      throw new PSVError('Unable to detect system capabilities');\n    }\n\n    /**\n     * @summary Internal properties\n     * @member {Object}\n     * @protected\n     * @property {boolean} ready - when all components are loaded\n     * @property {boolean} uiRefresh - if the UI needs to be renderer\n     * @property {boolean} needsUpdate - if the view needs to be renderer\n     * @property {boolean} fullscreen - if the viewer is currently fullscreen\n     * @property {external:THREE.Vector3} direction - direction of the camera\n     * @property {number} vFov - vertical FOV\n     * @property {number} hFov - horizontal FOV\n     * @property {number} aspect - viewer aspect ratio\n     * @property {boolean} autorotateEnabled - automatic rotation is enabled\n     * @property {PSV.utils.Animation} animationPromise - promise of the current animation\n     * @property {Promise} loadingPromise - promise of the setPanorama method\n     * @property {boolean} littlePlanet - special tweaks for LittlePlanetAdapter\n     * @property {number} idleTime - time of the last user action\n     * @property {object} objectsObservers\n     * @property {PSV.Size} size - size of the container\n     * @property {PSV.PanoData} panoData - panorama metadata, if supported\n     */\n    this.prop = {\n      ready            : false,\n      uiRefresh        : false,\n      needsUpdate      : false,\n      fullscreen       : false,\n      direction        : new Vector3(0, 0, SPHERE_RADIUS),\n      vFov             : null,\n      hFov             : null,\n      aspect           : null,\n      autorotateEnabled: false,\n      animationPromise : null,\n      loadingPromise   : null,\n      littlePlanet     : false,\n      idleTime         : -1,\n      objectsObservers : {},\n      size             : {\n        width : 0,\n        height: 0,\n      },\n      panoData         : {\n        fullWidth    : 0,\n        fullHeight   : 0,\n        croppedWidth : 0,\n        croppedHeight: 0,\n        croppedX     : 0,\n        croppedY     : 0,\n        poseHeading  : 0,\n        posePitch    : 0,\n        poseRoll     : 0,\n      },\n    };\n\n    /**\n     * @summary Configuration holder\n     * @type {PSV.Options}\n     * @readonly\n     */\n    this.config = getConfig(options);\n\n    /**\n     * @summary Top most parent\n     * @member {HTMLElement}\n     * @readonly\n     */\n    this.parent = (typeof options.container === 'string') ? document.getElementById(options.container) : options.container;\n    this.parent[VIEWER_DATA] = this;\n\n    /**\n     * @summary Main container\n     * @member {HTMLElement}\n     * @readonly\n     */\n    this.container = document.createElement('div');\n    this.container.classList.add('psv-container');\n    this.parent.appendChild(this.container);\n\n    /**\n     * @summary Render adapter\n     * @type {PSV.adapters.AbstractAdapter}\n     * @readonly\n     * @package\n     */\n    this.adapter = new this.config.adapter[0](this, this.config.adapter[1]); // eslint-disable-line new-cap\n\n    /**\n     * @summary All child components\n     * @type {PSV.components.AbstractComponent[]}\n     * @readonly\n     * @package\n     */\n    this.children = [];\n\n    /**\n     * @summary All plugins\n     * @type {Object<string, PSV.plugins.AbstractPlugin>}\n     * @readonly\n     * @package\n     */\n    this.plugins = {};\n\n    /**\n     * @type {PSV.services.Renderer}\n     * @readonly\n     */\n    this.renderer = new Renderer(this);\n\n    /**\n     * @type {PSV.services.TextureLoader}\n     * @readonly\n     */\n    this.textureLoader = new TextureLoader(this);\n\n    /**\n     * @type {PSV.services.EventsHandler}\n     * @readonly\n     */\n    this.eventsHandler = new EventsHandler(this);\n\n    /**\n     * @type {PSV.services.DataHelper}\n     * @readonly\n     */\n    this.dataHelper = new DataHelper(this);\n\n    /**\n     * @member {PSV.components.Loader}\n     * @readonly\n     */\n    this.loader = new Loader(this);\n\n    /**\n     * @member {PSV.components.Navbar}\n     * @readonly\n     */\n    this.navbar = new Navbar(this);\n\n    /**\n     * @member {PSV.components.Panel}\n     * @readonly\n     */\n    this.panel = new Panel(this);\n\n    /**\n     * @member {PSV.services.TooltipRenderer}\n     * @readonly\n     */\n    this.tooltip = new TooltipRenderer(this);\n\n    /**\n     * @member {PSV.components.Notification}\n     * @readonly\n     */\n    this.notification = new Notification(this);\n\n    /**\n     * @member {PSV.components.Overlay}\n     * @readonly\n     */\n    this.overlay = new Overlay(this);\n\n    /**\n     * @member {Record<string, PSV.utils.Dynamic>}\n     * @package\n     */\n    this.dynamics = {\n      zoom: new Dynamic((value) => {\n        this.prop.vFov = this.dataHelper.zoomLevelToFov(value);\n        this.prop.hFov = this.dataHelper.vFovToHFov(this.prop.vFov);\n        this.trigger(EVENTS.ZOOM_UPDATED, value);\n      }, this.config.defaultZoomLvl, 0, 100),\n\n      position: new MultiDynamic({\n        longitude: new Dynamic(null, this.config.defaultLong, 0, 2 * Math.PI, true),\n        latitude : this.prop.littlePlanet\n          ? new Dynamic(null, this.config.defaultLat, 0, Math.PI * 2, true)\n          : new Dynamic(null, this.config.defaultLat, -Math.PI / 2, Math.PI / 2),\n      }, (position) => {\n        this.dataHelper.sphericalCoordsToVector3(position, this.prop.direction);\n        this.trigger(EVENTS.POSITION_UPDATED, position);\n      }),\n    };\n\n    this.__updateSpeeds();\n\n    this.eventsHandler.init();\n\n    this.__resizeRefresh = throttle(() => this.refreshUi('resize'), 500);\n\n    // apply container size\n    this.resize(this.config.size);\n\n    // init plugins\n    this.config.plugins.forEach(([plugin, opts]) => {\n      this.plugins[plugin.id] = new plugin(this, opts); // eslint-disable-line new-cap\n    });\n    each(this.plugins, plugin => plugin.init?.());\n\n    // init buttons\n    this.navbar.setButtons(this.config.navbar);\n\n    // load panorama\n    if (this.config.panorama) {\n      this.setPanorama(this.config.panorama);\n    }\n\n    toggleClass(this.container, 'psv--is-touch', SYSTEM.isTouchEnabled.initial);\n    SYSTEM.isTouchEnabled.promise.then(enabled => toggleClass(this.container, 'psv--is-touch', enabled));\n\n    // enable GUI after first render\n    this.once(EVENTS.RENDER, () => {\n      if (this.config.navbar) {\n        this.container.classList.add('psv--has-navbar');\n        this.navbar.show();\n      }\n\n      // Queue autorotate\n      if (!isNil(this.config.autorotateDelay)) {\n        this.prop.idleTime = performance.now();\n      }\n\n      this.prop.ready = true;\n\n      setTimeout(() => {\n        this.refreshUi('init');\n\n        this.trigger(EVENTS.READY);\n      }, 0);\n    });\n  }\n\n  /**\n   * @summary Destroys the viewer\n   * @description The memory used by the ThreeJS context is not totally cleared. This will be fixed as soon as possible.\n   */\n  destroy() {\n    this.__stopAll();\n    this.stopKeyboardControl();\n    this.exitFullscreen();\n\n    each(this.plugins, plugin => plugin.destroy());\n    delete this.plugins;\n\n    this.children.slice().forEach(child => child.destroy());\n    this.children.length = 0;\n\n    this.eventsHandler.destroy();\n    this.renderer.destroy();\n    this.textureLoader.destroy();\n    this.dataHelper.destroy();\n    this.adapter.destroy();\n\n    this.parent.removeChild(this.container);\n    delete this.parent[VIEWER_DATA];\n\n    delete this.parent;\n    delete this.container;\n\n    delete this.loader;\n    delete this.navbar;\n    delete this.panel;\n    delete this.tooltip;\n    delete this.notification;\n    delete this.overlay;\n    delete this.dynamics;\n\n    delete this.config;\n  }\n\n  /**\n   * @summary Refresh UI\n   * @package\n   */\n  refreshUi(reason) {\n    if (!this.prop.ready) {\n      return;\n    }\n\n    if (!this.prop.uiRefresh) {\n      // console.log(`PhotoSphereViewer: UI Refresh, ${reason}`);\n\n      this.prop.uiRefresh = true;\n\n      this.children.every((child) => {\n        child.refreshUi();\n        return this.prop.uiRefresh === true;\n      });\n\n      this.prop.uiRefresh = false;\n    }\n    else if (this.prop.uiRefresh !== 'new') {\n      this.prop.uiRefresh = 'new';\n\n      // wait for current refresh to cancel\n      setTimeout(() => {\n        this.prop.uiRefresh = false;\n        this.refreshUi(reason);\n      });\n    }\n  }\n\n  /**\n   * @summary Returns the instance of a plugin if it exists\n   * @param {Class<PSV.plugins.AbstractPlugin>|string} pluginId\n   * @returns {PSV.plugins.AbstractPlugin}\n   */\n  getPlugin(pluginId) {\n    if (typeof pluginId === 'string') {\n      return this.plugins[pluginId];\n    }\n    else {\n      const pluginCtor = pluginInterop(pluginId, AbstractPlugin);\n      return pluginCtor ? this.plugins[pluginCtor.id] : undefined;\n    }\n  }\n\n  /**\n   * @summary Returns the current position of the camera\n   * @returns {PSV.Position}\n   */\n  getPosition() {\n    return this.dataHelper.cleanPosition(this.dynamics.position.current);\n  }\n\n  /**\n   * @summary Returns the current zoom level\n   * @returns {number}\n   */\n  getZoomLevel() {\n    return this.dynamics.zoom.current;\n  }\n\n  /**\n   * @summary Returns the current viewer size\n   * @returns {PSV.Size}\n   */\n  getSize() {\n    return { ...this.prop.size };\n  }\n\n  /**\n   * @summary Checks if the automatic rotation is enabled\n   * @returns {boolean}\n   */\n  isAutorotateEnabled() {\n    return this.prop.autorotateEnabled;\n  }\n\n  /**\n   * @summary Checks if the viewer is in fullscreen\n   * @returns {boolean}\n   */\n  isFullscreenEnabled() {\n    if (SYSTEM.fullscreenEvent) {\n      return isFullscreenEnabled(this.container);\n    }\n    else {\n      return this.prop.fullscreen;\n    }\n  }\n\n  /**\n   * @summary Flags the view has changed for the next render\n   */\n  needsUpdate() {\n    this.prop.needsUpdate = true;\n  }\n\n  /**\n   * @summary Resizes the canvas when the window is resized\n   * @fires PSV.size-updated\n   */\n  autoSize() {\n    if (this.container.clientWidth !== this.prop.size.width || this.container.clientHeight !== this.prop.size.height) {\n      this.prop.size.width = Math.round(this.container.clientWidth);\n      this.prop.size.height = Math.round(this.container.clientHeight);\n      this.prop.aspect = this.prop.size.width / this.prop.size.height;\n      this.prop.hFov = this.dataHelper.vFovToHFov(this.prop.vFov);\n\n      this.trigger(EVENTS.SIZE_UPDATED, this.getSize());\n      this.__resizeRefresh();\n    }\n  }\n\n  /**\n   * @summary Loads a new panorama file\n   * @description Loads a new panorama file, optionally changing the camera position/zoom and activating the transition animation.<br>\n   * If the \"options\" parameter is not defined, the camera will not move and the ongoing animation will continue.<br>\n   * If another loading is already in progress it will be aborted.\n   * @param {*} path - URL of the new panorama file\n   * @param {PSV.PanoramaOptions} [options]\n   * @returns {Promise<boolean>} resolves false if the loading was aborted by another call\n   */\n  setPanorama(path, options = {}) {\n    this.textureLoader.abortLoading();\n    this.prop.transitionAnimation?.cancel();\n\n    // apply default parameters on first load\n    if (!this.prop.ready) {\n      ['sphereCorrection', 'panoData', 'overlay', 'overlayOpacity'].forEach((opt) => {\n        if (!(opt in options)) {\n          options[opt] = this.config[opt];\n        }\n      });\n    }\n\n    if (options.transition === undefined || options.transition === true) {\n      options.transition = DEFAULT_TRANSITION;\n    }\n    if (options.showLoader === undefined) {\n      options.showLoader = true;\n    }\n    if (options.caption === undefined) {\n      options.caption = this.config.caption;\n    }\n    if (options.description === undefined) {\n      options.description = this.config.description;\n    }\n    if (!options.panoData && typeof this.config.panoData === 'function') {\n      options.panoData = this.config.panoData;\n    }\n\n    const positionProvided = isExtendedPosition(options);\n    const zoomProvided = 'zoom' in options;\n\n    if (positionProvided || zoomProvided) {\n      this.__stopAll();\n    }\n\n    this.hideError();\n\n    this.config.panorama = path;\n    this.config.caption = options.caption;\n    this.config.description = options.description;\n\n    const done = (err) => {\n      this.loader.hide();\n\n      this.prop.loadingPromise = null;\n\n      if (isAbortError(err)) {\n        return false;\n      }\n      else if (err) {\n        this.navbar.setCaption('');\n        this.showError(this.config.lang.loadError);\n        console.error(err);\n        throw err;\n      }\n      else {\n        this.resetIdleTimer();\n        this.setOverlay(options.overlay, options.overlayOpacity);\n        this.navbar.setCaption(this.config.caption);\n        return true;\n      }\n    };\n\n    this.navbar.setCaption(`<em>${this.config.loadingTxt || ''}</em>`);\n    if (options.showLoader || !this.prop.ready) {\n      this.loader.show();\n    }\n\n    const loadingPromise = this.adapter.loadTexture(this.config.panorama, options.panoData)\n      .then((textureData) => {\n        // check if another panorama was requested\n        if (textureData.panorama !== this.config.panorama) {\n          this.adapter.disposeTexture(textureData);\n          throw getAbortError();\n        }\n        return textureData;\n      });\n\n    if (!options.transition || !this.prop.ready || !this.adapter.supportsTransition(this.config.panorama)) {\n      this.prop.loadingPromise = loadingPromise\n        .then((textureData) => {\n          this.renderer.show();\n          this.renderer.setTexture(textureData);\n          this.renderer.setPanoramaPose(textureData.panoData);\n          this.renderer.setSphereCorrection(options.sphereCorrection);\n\n          if (zoomProvided) {\n            this.zoom(options.zoom);\n          }\n          if (positionProvided) {\n            this.rotate(options);\n          }\n        })\n        .then(done, done);\n    }\n    else {\n      this.prop.loadingPromise = loadingPromise\n        .then((textureData) => {\n          this.loader.hide();\n\n          this.prop.transitionAnimation = this.renderer.transition(textureData, options);\n          return this.prop.transitionAnimation;\n        })\n        .then((completed) => {\n          this.prop.transitionAnimation = null;\n          if (!completed) {\n            throw getAbortError();\n          }\n        })\n        .then(done, done);\n    }\n\n    return this.prop.loadingPromise;\n  }\n\n  /**\n   * @summary Loads a new overlay\n   * @param {*} path - URL of the new overlay file\n   * @param {number} [opacity=1]\n   * @returns {Promise}\n   */\n  setOverlay(path, opacity = 1) {\n    if (!path) {\n      if (this.adapter.constructor.supportsOverlay) {\n        this.renderer.setOverlay(null, 0);\n      }\n\n      return Promise.resolve();\n    }\n    else {\n      if (!this.adapter.constructor.supportsOverlay) {\n        return Promise.reject(new PSVError(`${this.adapter.constructor.id} adapter does not supports overlay`));\n      }\n\n      return this.adapter.loadTexture(path, (image) => {\n        const p = this.prop.panoData;\n        const r = image.width / p.croppedWidth;\n        return {\n          fullWidth    : r * p.fullWidth,\n          fullHeight   : r * p.fullHeight,\n          croppedWidth : r * p.croppedWidth,\n          croppedHeight: r * p.croppedHeight,\n          croppedX     : r * p.croppedX,\n          croppedY     : r * p.croppedY,\n        };\n      }, false)\n        .then((textureData) => {\n          this.renderer.setOverlay(textureData, opacity);\n        });\n    }\n  }\n\n  /**\n   * @summary Update options\n   * @param {PSV.Options} options\n   * @fires PSV.config-changed\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   */\n  setOptions(options) {\n    const rawConfig = {\n      ...this.config,\n      ...options,\n    };\n\n    each(options, (value, key) => {\n      if (DEPRECATED_OPTIONS[key]) {\n        logWarn(DEPRECATED_OPTIONS[key]);\n        return;\n      }\n\n      if (!Object.prototype.hasOwnProperty.call(DEFAULTS, key)) {\n        throw new PSVError(`Unknown option ${key}`);\n      }\n\n      if (READONLY_OPTIONS[key]) {\n        throw new PSVError(READONLY_OPTIONS[key]);\n      }\n\n      if (CONFIG_PARSERS[key]) {\n        this.config[key] = CONFIG_PARSERS[key](value, rawConfig);\n      }\n      else {\n        this.config[key] = value;\n      }\n\n      switch (key) {\n        case 'overlay':\n        case 'overlayOpacity':\n          this.setOverlay(this.config.overlay, this.config.overlayOpacity);\n          break;\n\n        case 'caption':\n        case 'description':\n          this.navbar.setCaption(this.config.caption);\n          break;\n\n        case 'size':\n          this.resize(value);\n          break;\n\n        case 'sphereCorrection':\n          this.renderer.setSphereCorrection(value);\n          break;\n\n        case 'navbar':\n        case 'lang':\n          this.navbar.setButtons(this.config.navbar);\n          break;\n\n        case 'moveSpeed':\n        case 'zoomSpeed':\n          this.__updateSpeeds();\n          break;\n\n        case 'minFov':\n        case 'maxFov':\n          this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.prop.vFov));\n          this.trigger(EVENTS.ZOOM_UPDATED, this.getZoomLevel());\n          break;\n\n        case 'canvasBackground':\n          this.renderer.canvasContainer.style.background = this.config.canvasBackground;\n          break;\n\n        case 'autorotateIdle':\n          this.resetIdleTimer();\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    this.needsUpdate();\n    this.refreshUi('set options');\n\n    this.trigger(EVENTS.CONFIG_CHANGED, Object.keys(options));\n  }\n\n  /**\n   * @summary Update options\n   * @param {string} option\n   * @param {any} value\n   * @fires PSV.config-changed\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   */\n  setOption(option, value) {\n    this.setOptions({ [option]: value });\n  }\n\n  /**\n   * @summary Restarts the idle timer (if `autorotateIdle=true`)\n   * @package\n   */\n  resetIdleTimer() {\n    this.prop.idleTime = this.config.autorotateIdle ? performance.now() : -1;\n  }\n\n  /**\n   * @summary Stops the idle timer\n   * @package\n   */\n  disableIdleTimer() {\n    this.prop.idleTime = -1;\n  }\n\n  /**\n   * @summary Starts the automatic rotation\n   * @fires PSV.autorotate\n   */\n  startAutorotate(refresh = false) {\n    if (refresh && !this.isAutorotateEnabled()) {\n      return;\n    }\n    if (!refresh && this.isAutorotateEnabled()) {\n      return;\n    }\n\n    if (!refresh) {\n      this.__stopAll();\n    }\n\n    this.dynamics.position.roll({\n      longitude: this.config.autorotateSpeed < 0,\n    }, Math.abs(this.config.autorotateSpeed / this.config.moveSpeed));\n\n    this.dynamics.position.goto({\n      latitude: this.config.autorotateLat,\n    }, Math.abs(this.config.autorotateSpeed / this.config.moveSpeed));\n\n    if (this.config.autorotateZoomLvl !== null) {\n      this.dynamics.zoom.goto(this.config.autorotateZoomLvl);\n    }\n\n    this.prop.autorotateEnabled = true;\n\n    if (!refresh) {\n      this.trigger(EVENTS.AUTOROTATE, true);\n    }\n  }\n\n  /**\n   * @summary Stops the automatic rotation\n   * @fires PSV.autorotate\n   */\n  stopAutorotate() {\n    if (this.isAutorotateEnabled()) {\n      this.dynamics.position.stop();\n      this.dynamics.zoom.stop();\n\n      this.prop.autorotateEnabled = false;\n\n      this.trigger(EVENTS.AUTOROTATE, false);\n    }\n  }\n\n  /**\n   * @summary Starts or stops the automatic rotation\n   * @fires PSV.autorotate\n   */\n  toggleAutorotate() {\n    if (this.isAutorotateEnabled()) {\n      this.stopAutorotate();\n    }\n    else {\n      this.startAutorotate();\n    }\n  }\n\n  /**\n   * @summary Displays an error message over the viewer\n   * @param {string} message\n   */\n  showError(message) {\n    this.overlay.show({\n      id         : IDS.ERROR,\n      image      : errorIcon,\n      text       : message,\n      dissmisable: false,\n    });\n  }\n\n  /**\n   * @summary Hides the error message\n   */\n  hideError() {\n    this.overlay.hide(IDS.ERROR);\n  }\n\n  /**\n   * @summary Rotates the view to specific longitude and latitude\n   * @param {PSV.ExtendedPosition} position\n   * @fires PSV.before-rotate\n   * @fires PSV.position-updated\n   */\n  rotate(position) {\n    const e = this.trigger(EVENTS.BEFORE_ROTATE, position);\n    if (e.isDefaultPrevented()) {\n      return;\n    }\n\n    const cleanPosition = this.change(CHANGE_EVENTS.GET_ROTATE_POSITION, this.dataHelper.cleanPosition(position));\n    this.dynamics.position.setValue(cleanPosition);\n  }\n\n  /**\n   * @summary Rotates and zooms the view with a smooth animation\n   * @param {PSV.AnimateOptions} options - position and/or zoom level\n   * @returns {PSV.utils.Animation}\n   */\n  animate(options) {\n    this.__stopAll();\n\n    const positionProvided = isExtendedPosition(options);\n    const zoomProvided = options.zoom !== undefined;\n\n    const animProperties = {};\n    let duration;\n\n    // clean/filter position and compute duration\n    if (positionProvided) {\n      const cleanPosition = this.change(CHANGE_EVENTS.GET_ANIMATE_POSITION, this.dataHelper.cleanPosition(options));\n      const currentPosition = this.getPosition();\n\n      // longitude offset for shortest arc\n      const tOffset = getShortestArc(currentPosition.longitude, cleanPosition.longitude);\n\n      animProperties.longitude = { start: currentPosition.longitude, end: currentPosition.longitude + tOffset };\n      animProperties.latitude = { start: currentPosition.latitude, end: cleanPosition.latitude };\n\n      duration = this.dataHelper.speedToDuration(options.speed, getAngle(currentPosition, cleanPosition));\n    }\n\n    // clean/filter zoom and compute duration\n    if (zoomProvided) {\n      const dZoom = Math.abs(options.zoom - this.getZoomLevel());\n\n      animProperties.zoom = { start: this.getZoomLevel(), end: options.zoom };\n\n      if (!duration) {\n        // if animating zoom only and a speed is given, use an arbitrary PI/4 to compute the duration\n        duration = this.dataHelper.speedToDuration(options.speed, Math.PI / 4 * dZoom / 100);\n      }\n    }\n\n    // if no animation needed\n    if (!duration) {\n      if (positionProvided) {\n        this.rotate(options);\n      }\n      if (zoomProvided) {\n        this.zoom(options.zoom);\n      }\n\n      return new Animation();\n    }\n\n    this.prop.animationPromise = new Animation({\n      properties: animProperties,\n      duration  : duration,\n      easing    : 'inOutSine',\n      onTick    : (properties) => {\n        if (positionProvided) {\n          this.rotate(properties);\n        }\n        if (zoomProvided) {\n          this.zoom(properties.zoom);\n        }\n      },\n    });\n\n    this.prop.animationPromise.then(() => {\n      this.prop.animationPromise = null;\n      this.resetIdleTimer();\n    });\n\n    return this.prop.animationPromise;\n  }\n\n  /**\n   * @summary Stops the ongoing animation\n   * @description The return value is a Promise because the is no guaranty the animation can be stopped synchronously.\n   * @returns {Promise} Resolved when the animation has ben cancelled\n   */\n  stopAnimation() {\n    if (this.prop.animationPromise) {\n      this.prop.animationPromise.cancel();\n      return this.prop.animationPromise;\n    }\n    else {\n      return Promise.resolve();\n    }\n  }\n\n  /**\n   * @summary Zooms to a specific level between `max_fov` and `min_fov`\n   * @param {number} level - new zoom level from 0 to 100\n   * @fires PSV.zoom-updated\n   */\n  zoom(level) {\n    this.dynamics.zoom.setValue(level);\n  }\n\n  /**\n   * @summary Increases the zoom level\n   * @param {number} [step=1]\n   */\n  zoomIn(step = 1) {\n    this.dynamics.zoom.step(step);\n  }\n\n  /**\n   * @summary Decreases the zoom level\n   * @param {number} [step=1]\n   */\n  zoomOut(step = 1) {\n    this.dynamics.zoom.step(-step);\n  }\n\n  /**\n   * @summary Resizes the viewer\n   * @param {PSV.CssSize} size\n   */\n  resize(size) {\n    ['width', 'height'].forEach((dim) => {\n      if (size && size[dim]) {\n        if (/^[0-9.]+$/.test(size[dim])) {\n          size[dim] += 'px';\n        }\n        this.parent.style[dim] = size[dim];\n      }\n    });\n\n    this.autoSize();\n  }\n\n  /**\n   * @summary Enters the fullscreen mode\n   * @fires PSV.fullscreen-updated\n   */\n  enterFullscreen() {\n    if (SYSTEM.fullscreenEvent) {\n      requestFullscreen(this.container);\n    }\n    else {\n      this.container.classList.add('psv-container--fullscreen');\n      this.autoSize();\n      this.eventsHandler.__fullscreenToggled(true);\n    }\n  }\n\n  /**\n   * @summary Exits the fullscreen mode\n   * @fires PSV.fullscreen-updated\n   */\n  exitFullscreen() {\n    if (this.isFullscreenEnabled()) {\n      if (SYSTEM.fullscreenEvent) {\n        exitFullscreen();\n      }\n      else {\n        this.container.classList.remove('psv-container--fullscreen');\n        this.autoSize();\n        this.eventsHandler.__fullscreenToggled(false);\n      }\n    }\n  }\n\n  /**\n   * @summary Enters or exits the fullscreen mode\n   * @fires PSV.fullscreen-updated\n   */\n  toggleFullscreen() {\n    if (!this.isFullscreenEnabled()) {\n      this.enterFullscreen();\n    }\n    else {\n      this.exitFullscreen();\n    }\n  }\n\n  /**\n   * @summary Enables the keyboard controls (done automatically when entering fullscreen)\n   */\n  startKeyboardControl() {\n    this.eventsHandler.enableKeyboard();\n  }\n\n  /**\n   * @summary Disables the keyboard controls (done automatically when exiting fullscreen)\n   */\n  stopKeyboardControl() {\n    this.eventsHandler.disableKeyboard();\n  }\n\n  /**\n   * @summary Subscribes to events on objects in the scene\n   * @param {string} userDataKey - only objects with the following `userData` will be emitted\n   * @param {EventListener} listener - must implement `handleEvent`\n   * @return {function} call to stop the subscription\n   * @package\n   */\n  observeObjects(userDataKey, listener) {\n    this.prop.objectsObservers[userDataKey] = { listener };\n\n    return () => {\n      delete this.prop.objectsObservers[userDataKey];\n    };\n  }\n\n  /**\n   * @summary Stops all current animations\n   * @returns {Promise}\n   * @package\n   */\n  __stopAll() {\n    this.trigger(EVENTS.STOP_ALL);\n\n    this.disableIdleTimer();\n    this.stopAutorotate();\n    return this.stopAnimation();\n  }\n\n  /**\n   * @summary Recomputes dynamics speeds\n   * @private\n   */\n  __updateSpeeds() {\n    this.dynamics.zoom.setSpeed(this.config.zoomSpeed * 50);\n    this.dynamics.position.setSpeed(MathUtils.degToRad(this.config.moveSpeed * 50));\n  }\n\n}\n"],"names":["PSVError","message","Error","captureStackTrace","stack","prototype","Object","create","name","constructor","AbstractAdapter","psv","destroy","supportsTransition","panorama","supportsPreload","loadTexture","newPanoData","useXmpPanoData","createMesh","scale","setTexture","mesh","textureData","transition","setTextureOpacity","opacity","disposeTexture","setOverlay","createOverlayMaterial","additionalUniforms","overrideVertexShader","ShaderMaterial","uniforms","OVERLAY_UNIFORMS","value","Texture","overlay","globalOpacity","overlayOpacity","vertexShader","fragmentShader","id","supportsDownload","supportsOverlay","DEFAULT_TRANSITION","MOVE_THRESHOLD","DBLCLICK_DELAY","LONGTOUCH_DELAY","TWOFINGERSOVERLAY_DELAY","CTRLZOOM_TIMEOUT","INERTIA_WINDOW","SPHERE_RADIUS","VIEWER_DATA","MESH_USER_DATA","ACTIONS","ROTATE_LAT_UP","ROTATE_LAT_DOWN","ROTATE_LONG_RIGHT","ROTATE_LONG_LEFT","ZOOM_IN","ZOOM_OUT","TOGGLE_AUTOROTATE","EVENTS","AUTOROTATE","BEFORE_RENDER","BEFORE_ROTATE","CLICK","CLOSE_PANEL","CONFIG_CHANGED","DOUBLE_CLICK","FULLSCREEN_UPDATED","HIDE_NOTIFICATION","HIDE_OVERLAY","HIDE_TOOLTIP","KEY_PRESS","LOAD_PROGRESS","OPEN_PANEL","PANORAMA_LOADED","POSITION_UPDATED","READY","RENDER","SHOW_NOTIFICATION","SHOW_OVERLAY","SHOW_TOOLTIP","SIZE_UPDATED","STOP_ALL","ZOOM_UPDATED","CHANGE_EVENTS","GET_ANIMATE_POSITION","GET_ROTATE_POSITION","OBJECT_EVENTS","ENTER_OBJECT","HOVER_OBJECT","LEAVE_OBJECT","IDS","MENU","TWO_FINGERS","CTRL_ZOOM","ERROR","DESCRIPTION","EASINGS","linear","t","inQuad","outQuad","inOutQuad","inCubic","outCubic","inOutCubic","inQuart","outQuart","inOutQuart","inQuint","outQuint","inOutQuint","inSine","Math","cos","PI","outSine","sin","inOutSine","inExpo","pow","outExpo","inOutExpo","inCirc","sqrt","outCirc","inOutCirc","KEY_CODES","Enter","Control","Escape","Space","PageUp","PageDown","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","Delete","Plus","Minus","LOCALSTORAGE_TOUCH_SUPPORT","SYSTEM","loaded","pixelRatio","isWebGLSupported","isTouchEnabled","maxTextureWidth","mouseWheelEvent","fullscreenEvent","load","ctx","getWebGLCtx","window","devicePixelRatio","getMaxTextureWidth","getMouseWheelEvent","getFullscreenEvent","maxCanvasWidth","getMaxCanvasWidth","canvas","document","createElement","names","context","getContext","some","e","initial","navigator","maxTouchPoints","localStorage","promise","Promise","resolve","clear","listenerMouse","listenerTouch","listenerTimeout","addEventListener","listenerTimeoutId","setTimeout","removeEventListener","clearTimeout","getParameter","MAX_TEXTURE_SIZE","maxWidth","width","height","fillStyle","fillRect","getImageData","data","onmousewheel","undefined","FULLSCREEN_EVT_MAP","exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","validExits","keys","filter","exit","length","toggleClass","element","className","active","classList","toggle","add","remove","addClasses","split","removeClasses","hasParent","el","parent","test","parentNode","getClosest","selector","matches","SVGElement","parentElement","getPosition","left","top","offsetLeft","scrollLeft","clientLeft","offsetTop","scrollTop","clientTop","offsetParent","isFullscreenEnabled","elt","fullscreenElement","webkitFullscreenElement","requestFullscreen","webkitRequestFullscreen","call","getStyle","prop","getComputedStyle","normalizeWheel","event","PIXEL_STEP","LINE_HEIGHT","PAGE_HEIGHT","spinX","spinY","pixelX","pixelY","detail","wheelDelta","wheelDeltaY","wheelDeltaX","axis","HORIZONTAL_AXIS","deltaY","deltaX","deltaMode","bound","x","min","max","MathUtils","clamp","loop","result","isPowerOfTwo","sum","array","reduce","a","b","distance","p1","p2","y","getShortestArc","from","to","tCandidates","candidate","newCandidate","abs","Infinity","getAngle","position1","position2","acos","latitude","longitude","greatArcDistance","λ1","φ1","λ2","φ2","dasherize","str","replace","s","i","toLowerCase","throttle","func","wait","self","args","timeout","previous","later","Date","now","apply","remaining","arguments","isPlainObject","obj","getPrototypeOf","proto","toString","deepmerge","target","src","first","merge","Array","isArray","forEach","key","clone","isEmpty","each","object","callback","isNil","val","firstNonNull","values","deepEqual","obj1","obj2","isObject","pluginInterop","plugin","entries","p","getAbortError","error","isAbortError","err","logWarn","console","warn","isExtendedPosition","key1","key2","getXMPValue","attr","match","parseInt","isNaN","CSS_POSITIONS","bottom","right","center","parsePosition","tokens","toLocaleLowerCase","slice","xFirst","map","token","reverse","parsed","join","parseFloat","X_VALUES","Y_VALUES","POS_VALUES","CENTER","cleanPosition","allowCenter","cssOrder","indexOf","positionIsOrdered","parseSpeed","speed","speedStr","trim","speedValue","speedUnit","degToRad","parseAngle","angle","zeroCenter","halfCircle","unit","createTexture","img","texture","needsUpdate","minFilter","LinearFilter","generateMipmaps","quaternion","Quaternion","applyEulerInverse","vector","euler","setFromEuler","invert","applyQuaternion","Animation","options","__callbacks","easing","__start","delay","__delayTimeout","__animationFrame","requestAnimationFrame","__run","__resolved","timestamp","__cancelled","progress","duration","current","properties","start","end","onTick","__resolve","cb","then","onFulfilled","push","cancel","cancelAnimationFrame","Dynamic","fn","defaultValue","loopValue","mode","STOP","speedMult","currentSpeed","setSpeed","goto","position","POSITION","step","roll","INFINITE","stop","setValue","update","elapsed","dstStop","targetSpeed","next","MultiDynamic","dynamics","d","positions","steps","rolls","hasUpdates","dynamic","Slider","container","direction","onUpdate","mousedown","mouseover","handleEvent","type","stopPropagation","__onMouseDown","__onMouseEnter","__onMouseLeave","__onTouchStart","__onMouseMove","__onTouchMove","__onMouseUp","__onTouchEnd","evt","__update","changedTouches","moving","boundingClientRect","getBoundingClientRect","cursor","vertical","pos","size","click","VERTICAL","EventEmitter","HORIZONTAL","EquirectangularAdapter","config","resolution","SPHERE_SEGMENTS","SPHERE_HORIZONTAL_SEGMENTS","useXmpData","reject","__loadXMP","loader","setProgress","xmpPanoData","textureLoader","loadImage","panoData","fullWidth","fullHeight","croppedWidth","croppedHeight","croppedX","croppedY","poseHeading","posePitch","poseRoll","__createEquirectangularTexture","onProgress","loadFile","blob","__loadBlobAsString","binary","substring","includes","reader","FileReader","onload","onerror","readAsText","ratio","resizedPanoData","buffer","drawImage","geometry","SphereGeometry","material","Mesh","__setUniform","transparent","dispose","uniform","AbstractComponent","children","visible","appendChild","removeChild","childIdx","splice","child","refreshUi","every","uiRefresh","isVisible","hide","show","style","display","AbstractButton","navbar","collapsable","tabbable","enabled","supported","collapsed","offsetWidth","icon","__setIcon","lang","title","tabIndex","onClick","checkSupported","supportedOrObject","isSupported","toggleActive","iconActive","refresh","disable","enable","collapse","uncollapse","innerHTML","querySelector","groupId","AutorotateButton","on","off","isAutorotateEnabled","autorotateIdle","resetIdleTimer","toggleAutorotate","play","playActive","CustomButton","random","substr","content","MODE_NOTIF","MODE_PANEL","DescriptionButton","closed","__close","caption","getButton","captionHidden","hasDescription","description","__open","notification","panel","info","DownloadButton","link","href","downloadUrl","download","pop","adapter","FullscreenButton","toggleFullscreen","fullscreenIn","fullscreenOut","MenuButton","__hideMenu","__showMenu","MENU_TEMPLATE","BUTTON_DATA","noMargin","clickHandler","li","buttonId","dataset","menuIcon","buttons","dataKey","menu","button","PressHandler","time","down","getTime","up","getOrientedArrow","arrow","AbstractMoveButton","move","handler","__stopAll","MoveDownButton","MoveLeftButton","MoveRightButton","MoveUpButton","AbstractZoomButton","zoom","ZoomInButton","zoomIn","ZoomOutButton","zoomOut","ZoomRangeButton","mediaMinWidth","zoomRange","zoomValue","slider","__onSliderUpdate","ready","__moveZoomValue","getZoomLevel","once","level","AbstractPlugin","init","DEFAULTS","plugins","loadingImg","loadingTxt","fisheye","minFov","maxFov","defaultZoomLvl","defaultLong","defaultLat","sphereCorrection","moveSpeed","zoomSpeed","autorotateDelay","autorotateSpeed","autorotateLat","autorotateZoomLvl","moveInertia","mousewheel","mousemove","mousewheelCtrlKey","touchmoveTwoFingers","requestHeaders","canvasBackground","withCredentials","autorotate","fullscreen","twoFingers","ctrlZoom","loadError","keyboard","READONLY_OPTIONS","DEPRECATED_OPTIONS","captureCursor","CONFIG_PARSERS","getConfig","tempConfig","hasOwnProperty","NavbarCaption","contentWidth","setCaption","html","__refreshButton","AVAILABLE_BUTTONS","AVAILABLE_GROUPS","registerButton","defaultPosition","unshift","Navbar","setButtons","item","cleanedButtons","__cleanButtons","buttonCtor","warnNotFound","availableWidth","totalWidth","visibleButtons","collapsableButtons","Loader","clientWidth","tickness","lastChild","inner","round","maxHeight","clearRect","lineWidth","strokeStyle","beginPath","arc","stroke","trigger","Notification","contentId","Overlay","dissmisable","image","text","subtext","preventDefault","PANEL_MIN_WIDTH","Panel","mouseX","mouseY","keyHandler","resizer","closeBtn","wasVisible","focus","__startResize","__resize","touches","clientX","clientY","AbstractService","vector2","Vector2","vector3","Vector3","eulerZero","Euler","DataHelper","fovToZoomLevel","fov","temp","zoomLevelToFov","vFovToHFov","vFov","radToDeg","atan","tan","aspect","speedToDuration","textureCoordsToSphericalCoords","point","relativeX","relativeY","equals","renderer","rotation","meshContainer","sphericalCoordsToVector3","applyEuler","vector3ToSphericalCoords","sphericalCoordsToTextureCoords","relativeLong","relativeLat","z","phi","theta","atan2","viewerCoordsToVector3","viewerPoint","sphereIntersect","getIntersections","userData","vector3ToViewerCoords","vectorClone","project","camera","sphericalCoordsToViewerCoords","raycaster","setFromCamera","intersectObjects","scene","littlePlanet","cleanSphereCorrection","pan","tilt","cleanPanoramaPose","IDLE","MOVING","INERTIA","EventsHandler","state","moveThreshold","keyboardEnabled","startMouseX","startMouseY","mouseHistory","pinchDist","ctrlKeyDown","dblclickData","dblclickTimeout","longtouchTimeout","twofingersTimeout","ctrlZoomTimeout","__onResize","autoSize","passive","__onKeyDown","__onKeyUp","__fullscreenToggled","__onMouseWheel","enableKeyboard","disableKeyboard","e2","isDefaultPrevented","action","__stopMove","__move","objectsObservers","viewerPos","intersections","dataHelper","emit","observer","listener","CustomEvent","originalEvent","intersection","find","touch","__cancelLongTouch","__cancelTwoFingersOverlay","__startMoveZoom","gestureIcon","__moveZoom","mousewheelIcon","delta","force","startKeyboardControl","stopKeyboardControl","__resetMove","__logMouseMove","rightclick","__stopMoveInertia","stopAnimation","__click","curve","SplineCurve","getTangent","curr","total","prev","currentClientX","currentClientY","animationPromise","__applyMove","done","boundingRect","viewerX","viewerY","sphereIntersection","sphericalCoords","objects","o","textureCoords","textureX","textureY","NaN","hFov","currentPosition","rotate","last","Renderer","WebGLRenderer","alpha","antialias","setPixelRatio","domElement","Scene","PerspectiveCamera","Group","Raycaster","canvasContainer","background","setAnimationLoop","__cleanTHREEScene","__onSizeUpdated","__onZoomUpdated","__onPositionUpdated","setSize","updateProjectionMatrix","set","lookAt","copy","multiplyScalar","negate","__renderLoop","idleTime","startAutorotate","render","setPanoramaPose","cleanCorrection","setSphereCorrection","positionProvided","zoomProvided","group","verticalAxis","rotateOnWorldAxis","horizontalAxis","cross","getWorldDirection","normalize","animation","completed","traverse","TextureLoader","FileLoader","setResponseType","setWithCredentials","setRequestHeader","abortLoading","url","lengthComputable","newProgress","createElementNS","URL","revokeObjectURL","createObjectURL","preloadPanorama","STATE","NONE","SHOWING","HIDING","Tooltip","__onTransitionEnd","rect","__waitImages","box","posClass","arrowTop","arrowLeft","__computeTooltipPosition","swapY","swapX","ordered","newPos","propertyName","offsetSide","border","offsetX","offsetY","images","querySelectorAll","promises","all","TooltipRenderer","testTooltip","tooltip","Cache","Viewer","autorotateEnabled","loadingPromise","getElementById","eventsHandler","__updateSpeeds","__resizeRefresh","resize","opts","setPanorama","performance","reason","getPlugin","pluginId","pluginCtor","getSize","clientHeight","path","transitionAnimation","opt","showLoader","hideError","showError","r","setOptions","rawConfig","setOption","option","disableIdleTimer","stopAutorotate","errorIcon","change","animate","animProperties","tOffset","dZoom","dim","enterFullscreen","observeObjects","userDataKey"],"mappings":"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;EACA;EACA;EACA;EACA;EACEC,EAAAA,UAAU,EAAU,YAAY;EAChC;EACF;EACA;EACA;EACA;EACA;EACA;EACEC,EAAAA,aAAa,EAAO,eAAe;EACnC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,aAAa,EAAO,eAAe;EACnC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,KAAK,EAAe,OAAO;EAC3B;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,WAAW,EAAS,aAAa;EACjC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,cAAc,EAAM,gBAAgB;EACpC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,YAAY,EAAQ,UAAU;EAC9B;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,kBAAkB,EAAE,oBAAoB;EACxC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,iBAAiB,EAAG,mBAAmB;EACvC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,YAAY,EAAQ,cAAc;EAClC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,YAAY,EAAQ,cAAc;EAClC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,SAAS,EAAW,WAAW;EAC/B;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,aAAa,EAAO,eAAe;EACnC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,UAAU,EAAU,YAAY;EAChC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,eAAe,EAAK,iBAAiB;EACrC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,gBAAgB,EAAI,kBAAkB;EACtC;EACF;EACA;EACA;EACA;EACEC,EAAAA,KAAK,EAAe,OAAO;EAC3B;EACF;EACA;EACA;EACA;EACEC,EAAAA,MAAM,EAAc,QAAQ;EAC5B;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,iBAAiB,EAAG,mBAAmB;EACvC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,YAAY,EAAQ,cAAc;EAClC;EACF;EACA;EACA;EACA;EACA;EACA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"}