{"version":3,"file":"markers.js","sources":["../../src/plugins/markers/constants.js","../../src/plugins/markers/utils.js","../../src/plugins/markers/Marker.js","../../src/plugins/markers/MarkersButton.js","../../src/plugins/markers/MarkersListButton.js","../../src/plugins/markers/index.js"],"sourcesContent":["import { utils } from '../..';\nimport icon from './pin-list.svg';\n\n/**\n * @summary Available events\n * @enum {string}\n * @memberof PSV.plugins.MarkersPlugin\n * @constant\n */\nexport const EVENTS = {\n  /**\n   * @event marker-visibility\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the visibility of a marker changes\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   * @param {boolean} visible\n   */\n  MARKER_VISIBILITY  : 'marker-visibility',\n  /**\n   * @event goto-marker-done\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the animation to a marker is done\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   */\n  GOTO_MARKER_DONE   : 'goto-marker-done',\n  /**\n   * @event leave-marker\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the user puts the cursor away from a marker\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   */\n  LEAVE_MARKER       : 'leave-marker',\n  /**\n   * @event over-marker\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the user puts the cursor hover a marker\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   */\n  OVER_MARKER        : 'over-marker',\n  /**\n   * @event filter:render-markers-list\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Used to alter the list of markers displayed on the side-panel\n   * @param {PSV.plugins.MarkersPlugin.Marker[]} markers\n   * @returns {PSV.plugins.MarkersPlugin.Marker[]}\n   */\n  RENDER_MARKERS_LIST: 'render-markers-list',\n  /**\n   * @event select-marker\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the user clicks on a marker. The marker can be retrieved from outside the event handler\n   * with {@link PSV.plugins.MarkersPlugin.getCurrentMarker}\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   * @param {PSV.plugins.MarkersPlugin.SelectMarkerData} data\n   */\n  SELECT_MARKER      : 'select-marker',\n  /**\n   * @event select-marker-list\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when a marker is selected from the side panel\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   */\n  SELECT_MARKER_LIST : 'select-marker-list',\n  /**\n   * @event unselect-marker\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when a marker was selected and the user clicks elsewhere\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   */\n  UNSELECT_MARKER    : 'unselect-marker',\n  /**\n   * @event hide-markers\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the markers are hidden\n   */\n  HIDE_MARKERS       : 'hide-markers',\n  /**\n   * @event set-marker\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the list of markers changes\n   * @param {PSV.plugins.MarkersPlugin.Marker[]} markers\n   */\n  SET_MARKERS        : 'set-markers',\n  /**\n   * @event show-markers\n   * @memberof PSV.plugins.MarkersPlugin\n   * @summary Triggered when the markers are shown\n   */\n  SHOW_MARKERS       : 'show-markers',\n};\n\n/**\n * @summary Types of tooltip events\n * @memberOf PSV.plugins.MarkersPlugin\n * @enum {string}\n * @constant\n * @private\n */\nexport const MARKER_TOOLTIP_TRIGGER = {\n  click: 'click',\n  hover: 'hover',\n};\n\n/**\n * @summary Namespace for SVG creation\n * @type {string}\n * @constant\n * @private\n */\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n\n/**\n * @summary Property name added to marker elements\n * @type {string}\n * @constant\n * @private\n */\nexport const MARKER_DATA = 'psvMarker';\n\n/**\n * @summary Panel identifier for marker content\n * @type {string}\n * @constant\n * @private\n */\nexport const ID_PANEL_MARKER = 'marker';\n\n/**\n * @summary Panel identifier for markers list\n * @type {string}\n * @constant\n * @private\n */\nexport const ID_PANEL_MARKERS_LIST = 'markersList';\n\nconst MARKER_DATA_KEY = utils.dasherize(MARKER_DATA);\n\n/**\n * @summary Markers list template\n * @param {PSV.plugins.MarkersPlugin.Marker[]} markers\n * @param {string} title\n * @returns {string}\n * @constant\n * @private\n */\nexport const MARKERS_LIST_TEMPLATE = (markers, title) => `\n<div class=\"psv-panel-menu psv-panel-menu--stripped\">\n  <h1 class=\"psv-panel-menu-title\">${icon} ${title}</h1>\n  <ul class=\"psv-panel-menu-list\">\n    ${markers.map(marker => `\n    <li data-${MARKER_DATA_KEY}=\"${marker.config.id}\" class=\"psv-panel-menu-item\" tabindex=\"0\">\n      ${marker.type === 'image' ? `<span class=\"psv-panel-menu-item-icon\"><img src=\"${marker.config.image}\"/></span>` : ''}\n      <span class=\"psv-panel-menu-item-label\">${marker.getListContent()}</span>\n    </li>\n    `).join('')}\n  </ul>\n</div>\n`;\n","import { CONSTANTS, utils } from '../..';\n\n/**\n * Returns intermediary point between two points on the sphere\n * {@link http://www.movable-type.co.uk/scripts/latlong.html}\n * @param {number[]} p1\n * @param {number[]} p2\n * @param {number} f\n * @returns {number[]}\n * @private\n */\nexport function greatArcIntermediaryPoint(p1, p2, f) {\n  const [λ1, φ1] = p1;\n  const [λ2, φ2] = p2;\n\n  const r = utils.greatArcDistance(p1, p2);\n  const a = Math.sin((1 - f) * r) / Math.sin(r);\n  const b = Math.sin(f * r) / Math.sin(r);\n  const x = a * Math.cos(φ1) * Math.cos(λ1) + b * Math.cos(φ2) * Math.cos(λ2);\n  const y = a * Math.cos(φ1) * Math.sin(λ1) + b * Math.cos(φ2) * Math.sin(λ2);\n  const z = a * Math.sin(φ1) + b * Math.sin(φ2);\n\n  return [\n    Math.atan2(y, x),\n    Math.atan2(z, Math.sqrt(x * x + y * y)),\n  ];\n}\n\n/**\n * @summary Computes the center point of a polygon\n * @todo Get \"visual center\" (https://blog.mapbox.com/a-new-algorithm-for-finding-a-visual-center-of-a-polygon-7c77e6492fbc)\n * @param {number[][]} polygon\n * @returns {number[]}\n * @private\n */\nexport function getPolygonCenter(polygon) {\n  // apply offsets to avoid crossing the origin\n  const workPoints = [polygon[0]];\n\n  let k = 0;\n  for (let i = 1; i < polygon.length; i++) {\n    const d = polygon[i - 1][0] - polygon[i][0];\n    if (d > Math.PI) { // crossed the origin left to right\n      k += 1;\n    }\n    else if (d < -Math.PI) { // crossed the origin right to left\n      k -= 1;\n    }\n    workPoints.push([polygon[i][0] + k * 2 * Math.PI, polygon[i][1]]);\n  }\n\n  const sum = workPoints.reduce((intermediary, point) => [intermediary[0] + point[0], intermediary[1] + point[1]]);\n  return [utils.parseAngle(sum[0] / polygon.length), sum[1] / polygon.length];\n}\n\n/**\n * @summary Computes the middle point of a polyline\n * @param {number[][]} polyline\n * @returns {number[]}\n * @private\n */\nexport function getPolylineCenter(polyline) {\n  // compute each segment length + total length\n  let length = 0;\n  const lengths = [];\n\n  for (let i = 0; i < polyline.length - 1; i++) {\n    const l = utils.greatArcDistance(polyline[i], polyline[i + 1]) * CONSTANTS.SPHERE_RADIUS;\n\n    lengths.push(l);\n    length += l;\n  }\n\n  // iterate until length / 2\n  let consumed = 0;\n\n  for (let j = 0; j < polyline.length - 1; j++) {\n    // once the segment containing the middle point is found, computes the intermediary point\n    if (consumed + lengths[j] > length / 2) {\n      const r = (length / 2 - consumed) / lengths[j];\n      return greatArcIntermediaryPoint(polyline[j], polyline[j + 1], r);\n    }\n\n    consumed += lengths[j];\n  }\n\n  // this never happens\n  return polyline[Math.round(polyline.length / 2)];\n}\n","import { Group, MathUtils, Mesh, MeshBasicMaterial, PlaneGeometry, TextureLoader } from 'three';\nimport { CONSTANTS, PSVError, utils } from '../..';\nimport { MARKER_DATA, MARKER_TOOLTIP_TRIGGER, SVG_NS } from './constants';\nimport { getPolygonCenter, getPolylineCenter } from './utils';\n\n/**\n * @summary Types of marker\n * @memberOf PSV.plugins.MarkersPlugin\n * @enum {string}\n * @constant\n * @private\n */\nconst MARKER_TYPES = {\n  image      : 'image',\n  imageLayer : 'imageLayer',\n  html       : 'html',\n  polygonPx  : 'polygonPx',\n  polygonRad : 'polygonRad',\n  polylinePx : 'polylinePx',\n  polylineRad: 'polylineRad',\n  square     : 'square',\n  rect       : 'rect',\n  circle     : 'circle',\n  ellipse    : 'ellipse',\n  path       : 'path',\n};\n\n/**\n * @typedef {Object} PSV.plugins.MarkersPlugin.Properties\n * @summary Marker properties, see {@link https://photo-sphere-viewer.js.org/plugins/plugin-markers.html#markers-options}\n */\n\n/**\n * @summary Object representing a marker\n * @memberOf PSV.plugins.MarkersPlugin\n */\nexport class Marker {\n\n  /**\n   * @param {PSV.plugins.MarkersPlugin.Properties} properties\n   * @param {PSV.Viewer} psv\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   */\n  constructor(properties, psv) {\n    if (!properties.id) {\n      throw new PSVError('missing marker id');\n    }\n\n    /**\n     * @member {PSV.Viewer}\n     * @readonly\n     * @protected\n     */\n    this.psv = psv;\n\n    /**\n     * @member {string}\n     * @readonly\n     */\n    this.id = properties.id;\n\n    /**\n     * @member {string}\n     * @readonly\n     */\n    this.type = Marker.getType(properties, false);\n\n    /**\n     * @member {boolean}\n     * @protected\n     */\n    this.visible = true;\n\n    /**\n     * @member {HTMLElement|SVGElement|THREE.Object3D}\n     * @readonly\n     */\n    this.$el = null;\n\n    /**\n     * @summary Original configuration of the marker\n     * @member {PSV.plugins.MarkersPlugin.Properties}\n     * @readonly\n     */\n    this.config = {};\n\n    /**\n     * @summary User data associated to the marker\n     * @member {any}\n     */\n    this.data = undefined;\n\n    /**\n     * @summary Tooltip instance for this marker\n     * @member {PSV.components.Tooltip}\n     */\n    this.tooltip = null;\n\n    /**\n     * @summary Computed properties\n     * @member {Object}\n     * @protected\n     * @property {boolean} dynamicSize\n     * @property {PSV.Point} anchor\n     * @property {boolean} visible - actually visible in the view\n     * @property {boolean} staticTooltip - the tooltip must always be shown\n     * @property {PSV.Position} position - position in spherical coordinates\n     * @property {PSV.Point} position2D - position in viewer coordinates\n     * @property {external:THREE.Vector3[]} positions3D - positions in 3D space\n     * @property {number} width\n     * @property {number} height\n     * @property {*} def\n     */\n    this.props = {\n      dynamicSize  : false,\n      anchor       : null,\n      visible      : false,\n      staticTooltip: false,\n      position     : null,\n      position2D   : null,\n      positions3D  : null,\n      width        : null,\n      height       : null,\n      def          : null,\n    };\n\n    /**\n     * @summary THREE file loader\n     * @type {THREE:TextureLoader}\n     * @private\n     */\n    this.loader = null;\n\n    if (this.is3d()) {\n      this.loader = new TextureLoader();\n      if (this.psv.config.withCredentials) {\n        this.loader.setWithCredentials(true);\n      }\n      if (this.psv.config.requestHeaders && typeof this.psv.config.requestHeaders === 'object') {\n        this.loader.setRequestHeader(this.psv.config.requestHeaders);\n      }\n    }\n\n    // create element\n    if (this.isNormal()) {\n      this.$el = document.createElement('div');\n    }\n    else if (this.isPolygon()) {\n      this.$el = document.createElementNS(SVG_NS, 'polygon');\n    }\n    else if (this.isPolyline()) {\n      this.$el = document.createElementNS(SVG_NS, 'polyline');\n    }\n    else if (this.isSvg()) {\n      const svgType = this.type === 'square' ? 'rect' : this.type;\n      this.$el = document.createElementNS(SVG_NS, svgType);\n    }\n\n    if (!this.is3d()) {\n      this.$el.id = `psv-marker-${this.id}`;\n      this.$el[MARKER_DATA] = this;\n    }\n\n    this.update(properties);\n  }\n\n  /**\n   * @summary Destroys the marker\n   */\n  destroy() {\n    delete this.$el[MARKER_DATA];\n    delete this.$el;\n    delete this.config;\n    delete this.props;\n    delete this.psv;\n  }\n\n  /**\n   * @summary Checks if it is a 3D marker (imageLayer)\n   * @returns {boolean}\n   */\n  is3d() {\n    return this.type === MARKER_TYPES.imageLayer;\n  }\n\n  /**\n   * @summary Checks if it is a normal marker (image or html)\n   * @returns {boolean}\n   */\n  isNormal() {\n    return this.type === MARKER_TYPES.image\n      || this.type === MARKER_TYPES.html;\n  }\n\n  /**\n   * @summary Checks if it is a polygon/polyline marker\n   * @returns {boolean}\n   */\n  isPoly() {\n    return this.isPolygon()\n      || this.isPolyline();\n  }\n\n  /**\n   * @summary Checks if it is a polygon/polyline using pixel coordinates\n   * @returns {boolean}\n   */\n  isPolyPx() {\n    return this.type === MARKER_TYPES.polygonPx\n      || this.type === MARKER_TYPES.polylinePx;\n  }\n\n  /**\n   * @summary Checks if it is a polygon/polyline using radian coordinates\n   * @returns {boolean}\n   */\n  isPolyRad() {\n    return this.type === MARKER_TYPES.polygonRad\n      || this.type === MARKER_TYPES.polylineRad;\n  }\n\n  /**\n   * @summary Checks if it is a polygon marker\n   * @returns {boolean}\n   */\n  isPolygon() {\n    return this.type === MARKER_TYPES.polygonPx\n      || this.type === MARKER_TYPES.polygonRad;\n  }\n\n  /**\n   * @summary Checks if it is a polyline marker\n   * @returns {boolean}\n   */\n  isPolyline() {\n    return this.type === MARKER_TYPES.polylinePx\n      || this.type === MARKER_TYPES.polylineRad;\n  }\n\n  /**\n   * @summary Checks if it is an SVG marker\n   * @returns {boolean}\n   */\n  isSvg() {\n    return this.type === MARKER_TYPES.square\n      || this.type === MARKER_TYPES.rect\n      || this.type === MARKER_TYPES.circle\n      || this.type === MARKER_TYPES.ellipse\n      || this.type === MARKER_TYPES.path;\n  }\n\n  /**\n   * @summary Computes marker scale from zoom level\n   * @param {number} zoomLevel\n   * @param {PSV.Position} position\n   * @returns {number}\n   */\n  getScale(zoomLevel, position) {\n    if (!this.config.scale) {\n      return 1;\n    }\n    if (typeof this.config.scale === 'function') {\n      return this.config.scale(zoomLevel, position);\n    }\n\n    let scale = 1;\n    if (Array.isArray(this.config.scale.zoom)) {\n      const bounds = this.config.scale.zoom;\n      scale *= bounds[0] + (bounds[1] - bounds[0]) * CONSTANTS.EASINGS.inQuad(zoomLevel / 100);\n    }\n    if (Array.isArray(this.config.scale.longitude)) {\n      const bounds = this.config.scale.longitude;\n      const halfFov = MathUtils.degToRad(this.psv.prop.hFov) / 2;\n      const arc = Math.abs(utils.getShortestArc(this.props.position.longitude, position.longitude));\n      scale *= bounds[1] + (bounds[0] - bounds[1]) * CONSTANTS.EASINGS.outQuad(Math.max(0, (halfFov - arc) / halfFov));\n    }\n    return scale;\n  }\n\n  /**\n   * @summary Returns the markers list content for the marker, it can be either :\n   * - the `listContent`\n   * - the `tooltip.content`\n   * - the `html`\n   * - the `id`\n   * @returns {*}\n   */\n  getListContent() {\n    if (this.config.listContent) {\n      return this.config.listContent;\n    }\n    else if (this.config.tooltip.content) {\n      return this.config.tooltip.content;\n    }\n    else if (this.config.html) {\n      return this.config.html;\n    }\n    else {\n      return this.id;\n    }\n  }\n\n  /**\n   * @summary Display the tooltip of this marker\n   * @param {{clientX: number, clientY: number}} [mousePosition]\n   */\n  showTooltip(mousePosition) {\n    if (this.props.visible && this.config.tooltip.content && this.props.position2D) {\n      const config = {\n        ...this.config.tooltip,\n        data: this,\n      };\n\n      if (this.isPoly()) {\n        if (mousePosition) {\n          const viewerPos = utils.getPosition(this.psv.container);\n          config.top = mousePosition.clientY - viewerPos.top;\n          config.left = mousePosition.clientX - viewerPos.left;\n          config.box = { // separate the tooltip from the cursor\n            width : 20,\n            height: 20,\n          };\n        }\n        else {\n          config.top = this.props.position2D.y;\n          config.left = this.props.position2D.x;\n        }\n      }\n      else {\n        config.top = this.props.position2D.y + this.props.height / 2;\n        config.left = this.props.position2D.x + this.props.width / 2;\n        config.box = {\n          width : this.props.width,\n          height: this.props.height,\n        };\n      }\n\n      if (this.tooltip) {\n        this.tooltip.move(config);\n      }\n      else {\n        this.tooltip = this.psv.tooltip.create(config);\n      }\n    }\n  }\n\n  /**\n   * @summary Recompute the position of the tooltip\n   */\n  refreshTooltip() {\n    if (this.tooltip) {\n      this.showTooltip();\n    }\n  }\n\n  /**\n   * @summary Hides the tooltip of this marker\n   */\n  hideTooltip() {\n    if (this.tooltip) {\n      this.tooltip.hide();\n      this.tooltip = null;\n    }\n  }\n\n  /**\n   * @summary Updates the marker with new properties\n   * @param {PSV.plugins.MarkersPlugin.Properties} properties\n   * @throws {PSV.PSVError} when the configuration is incorrect\n   */\n  update(properties) {\n    const newType = Marker.getType(properties, true);\n\n    if (newType !== undefined && newType !== this.type) {\n      throw new PSVError('cannot change marker type');\n    }\n\n    utils.deepmerge(this.config, properties);\n    if (typeof this.config.tooltip === 'string') {\n      this.config.tooltip = { content: this.config.tooltip };\n    }\n    if (!this.config.tooltip) {\n      this.config.tooltip = {};\n    }\n    if (!this.config.tooltip.trigger) {\n      this.config.tooltip.trigger = MARKER_TOOLTIP_TRIGGER.hover;\n    }\n\n    this.data = this.config.data;\n    this.visible = this.config.visible !== false;\n\n    if (!this.is3d()) {\n      // reset CSS class\n      if (this.isNormal()) {\n        this.$el.className = 'psv-marker psv-marker--normal';\n      }\n      else {\n        this.$el.setAttribute('class', 'psv-marker psv-marker--svg');\n      }\n\n      // add CSS classes\n      if (this.config.className) {\n        utils.addClasses(this.$el, this.config.className);\n      }\n\n      if (this.config.tooltip) {\n        this.$el.classList.add('psv-marker--has-tooltip');\n      }\n      if (this.config.content) {\n        this.$el.classList.add('psv-marler--has-content');\n      }\n\n      // apply style\n      this.$el.style.opacity = this.config.opacity ?? 1;\n      if (this.config.style) {\n        utils.deepmerge(this.$el.style, this.config.style);\n      }\n    }\n\n    // parse anchor\n    this.props.anchor = utils.parsePosition(this.config.anchor);\n\n    // clean scale\n    if (this.config.scale && Array.isArray(this.config.scale)) {\n      this.config.scale = { zoom: this.config.scale };\n    }\n\n    if (this.isNormal()) {\n      this.__updateNormal();\n    }\n    else if (this.isPoly()) {\n      this.__updatePoly();\n    }\n    else if (this.isSvg()) {\n      this.__updateSvg();\n    }\n    else if (this.is3d()) {\n      this.__update3d();\n    }\n  }\n\n  /**\n   * @summary Updates a normal marker\n   * @private\n   */\n  __updateNormal() {\n    if (!utils.isExtendedPosition(this.config)) {\n      throw new PSVError('missing marker position, latitude/longitude or x/y');\n    }\n\n    if (this.config.image && (!this.config.width || !this.config.height)) {\n      throw new PSVError('missing marker width/height');\n    }\n\n    if (this.config.width && this.config.height) {\n      this.props.dynamicSize = false;\n      this.props.width = this.config.width;\n      this.props.height = this.config.height;\n      this.$el.style.width = this.config.width + 'px';\n      this.$el.style.height = this.config.height + 'px';\n    }\n    else {\n      this.props.dynamicSize = true;\n    }\n\n    if (this.config.image) {\n      this.props.def = this.config.image;\n      this.$el.style.backgroundImage = `url(${this.config.image})`;\n    }\n    else if (this.config.html) {\n      this.props.def = this.config.html;\n      this.$el.innerHTML = this.config.html;\n    }\n\n    // set anchor\n    this.$el.style.transformOrigin = `${this.props.anchor.x * 100}% ${this.props.anchor.y * 100}%`;\n\n    // convert texture coordinates to spherical coordinates\n    this.props.position = this.psv.dataHelper.cleanPosition(this.config);\n\n    // compute x/y/z position\n    this.props.positions3D = [this.psv.dataHelper.sphericalCoordsToVector3(this.props.position)];\n  }\n\n  /**\n   * @summary Updates an SVG marker\n   * @private\n   */\n  __updateSvg() {\n    if (!utils.isExtendedPosition(this.config)) {\n      throw new PSVError('missing marker position, latitude/longitude or x/y');\n    }\n\n    this.props.dynamicSize = true;\n\n    // set content\n    switch (this.type) {\n      case MARKER_TYPES.square:\n        this.props.def = {\n          x     : 0,\n          y     : 0,\n          width : this.config.square,\n          height: this.config.square,\n        };\n        break;\n\n      case MARKER_TYPES.rect:\n        if (Array.isArray(this.config.rect)) {\n          this.props.def = {\n            x     : 0,\n            y     : 0,\n            width : this.config.rect[0],\n            height: this.config.rect[1],\n          };\n        }\n        else {\n          this.props.def = {\n            x     : 0,\n            y     : 0,\n            width : this.config.rect.width,\n            height: this.config.rect.height,\n          };\n        }\n        break;\n\n      case MARKER_TYPES.circle:\n        this.props.def = {\n          cx: this.config.circle,\n          cy: this.config.circle,\n          r : this.config.circle,\n        };\n        break;\n\n      case MARKER_TYPES.ellipse:\n        if (Array.isArray(this.config.ellipse)) {\n          this.props.def = {\n            cx: this.config.ellipse[0],\n            cy: this.config.ellipse[1],\n            rx: this.config.ellipse[0],\n            ry: this.config.ellipse[1],\n          };\n        }\n        else {\n          this.props.def = {\n            cx: this.config.ellipse.rx,\n            cy: this.config.ellipse.ry,\n            rx: this.config.ellipse.rx,\n            ry: this.config.ellipse.ry,\n          };\n        }\n        break;\n\n      case MARKER_TYPES.path:\n        this.props.def = {\n          d: this.config.path,\n        };\n        break;\n\n      // no default\n    }\n\n    utils.each(this.props.def, (value, prop) => {\n      this.$el.setAttributeNS(null, prop, value);\n    });\n\n    // set style\n    if (this.config.svgStyle) {\n      utils.each(this.config.svgStyle, (value, prop) => {\n        this.$el.setAttributeNS(null, utils.dasherize(prop), value);\n      });\n    }\n    else {\n      this.$el.setAttributeNS(null, 'fill', 'rgba(0,0,0,0.5)');\n    }\n\n    // convert texture coordinates to spherical coordinates\n    this.props.position = this.psv.dataHelper.cleanPosition(this.config);\n\n    // compute x/y/z position\n    this.props.positions3D = [this.psv.dataHelper.sphericalCoordsToVector3(this.props.position)];\n  }\n\n  /**\n   * @summary Updates a polygon marker\n   * @private\n   */\n  __updatePoly() {\n    this.props.dynamicSize = true;\n\n    // set style\n    if (this.config.svgStyle) {\n      utils.each(this.config.svgStyle, (value, prop) => {\n        this.$el.setAttributeNS(null, utils.dasherize(prop), value);\n      });\n\n      if (this.isPolyline() && !this.config.svgStyle.fill) {\n        this.$el.setAttributeNS(null, 'fill', 'none');\n      }\n    }\n    else if (this.isPolygon()) {\n      this.$el.setAttributeNS(null, 'fill', 'rgba(0,0,0,0.5)');\n    }\n    else if (this.isPolyline()) {\n      this.$el.setAttributeNS(null, 'fill', 'none');\n      this.$el.setAttributeNS(null, 'stroke', 'rgb(0,0,0)');\n    }\n\n    // fold arrays: [1,2,3,4] => [[1,2],[3,4]]\n    const actualPoly = this.config.polygonPx || this.config.polygonRad || this.config.polylinePx || this.config.polylineRad;\n    if (!Array.isArray(actualPoly[0])) {\n      for (let i = 0; i < actualPoly.length; i++) {\n        actualPoly.splice(i, 2, [actualPoly[i], actualPoly[i + 1]]);\n      }\n    }\n\n    // convert texture coordinates to spherical coordinates\n    if (this.isPolyPx()) {\n      this.props.def = actualPoly.map((coord) => {\n        const sphericalCoords = this.psv.dataHelper.textureCoordsToSphericalCoords({ x: coord[0], y: coord[1] });\n        return [sphericalCoords.longitude, sphericalCoords.latitude];\n      });\n    }\n    // clean angles\n    else {\n      this.props.def = actualPoly.map((coord) => {\n        return [utils.parseAngle(coord[0]), utils.parseAngle(coord[1], true)];\n      });\n    }\n\n    const centroid = this.isPolygon()\n      ? getPolygonCenter(this.props.def)\n      : getPolylineCenter(this.props.def);\n\n    this.props.position = {\n      longitude: centroid[0],\n      latitude : centroid[1],\n    };\n\n    // compute x/y/z positions\n    this.props.positions3D = this.props.def.map((coord) => {\n      return this.psv.dataHelper.sphericalCoordsToVector3({ longitude: coord[0], latitude: coord[1] });\n    });\n  }\n\n  /**\n   * @summary Updates a 3D marker\n   * @private\n   */\n  __update3d() {\n    if (!this.config.width || !this.config.height) {\n      throw new PSVError('missing marker width/height');\n    }\n\n    this.props.dynamicSize = false;\n    this.props.width = this.config.width;\n    this.props.height = this.config.height;\n\n    // convert texture coordinates to spherical coordinates\n    this.props.position = this.psv.dataHelper.cleanPosition(this.config);\n\n    // compute x/y/z position\n    this.props.positions3D = [this.psv.dataHelper.sphericalCoordsToVector3(this.props.position)];\n\n    switch (this.type) {\n      case MARKER_TYPES.imageLayer:\n        if (!this.$el) {\n          const material = new MeshBasicMaterial({\n            transparent: true,\n            opacity    : this.config.opacity ?? 1,\n            depthTest  : false,\n          });\n          const geometry = new PlaneGeometry(1, 1);\n          const mesh = new Mesh(geometry, material);\n          mesh.userData = { [MARKER_DATA]: this };\n          this.$el = new Group().add(mesh);\n\n          // overwrite the visible property to be tied to the Marker instance\n          // and do it without context bleed\n          Object.defineProperty(this.$el, 'visible', {\n            enumerable: true,\n            get       : function () {\n              return this.children[0].userData[MARKER_DATA].visible;\n            },\n            set       : function (visible) {\n              this.children[0].userData[MARKER_DATA].visible = visible;\n            },\n          });\n        }\n\n        if (this.props.def !== this.config.imageLayer) {\n          if (this.psv.config.requestHeaders && typeof this.psv.config.requestHeaders === 'function') {\n            this.loader.setRequestHeader(this.psv.config.requestHeaders(this.config.imageLayer));\n          }\n          this.$el.children[0].material.map = this.loader.load(this.config.imageLayer, (texture) => {\n            texture.anisotropy = 4;\n            this.psv.needsUpdate();\n          });\n          this.props.def = this.config.imageLayer;\n        }\n\n        this.$el.children[0].position.set(\n          this.props.anchor.x - 0.5,\n          this.props.anchor.y - 0.5,\n          0\n        );\n\n        this.$el.position.copy(this.props.positions3D[0]);\n\n        switch (this.config.orientation) {\n          case 'horizontal':\n            this.$el.lookAt(0, this.$el.position.y, 0);\n            this.$el.rotateX(this.props.position.latitude < 0 ? -Math.PI / 2 : Math.PI / 2);\n            break;\n          case 'vertical-left':\n            this.$el.lookAt(0, 0, 0);\n            this.$el.rotateY(-Math.PI * 0.4);\n            break;\n          case 'vertical-right':\n            this.$el.lookAt(0, 0, 0);\n            this.$el.rotateY(Math.PI * 0.4);\n            break;\n          default:\n            this.$el.lookAt(0, 0, 0);\n            break;\n        }\n\n        // 100 is magic number that gives a coherent size at default zoom level\n        this.$el.scale.set(this.config.width / 100, this.config.height / 100, 1);\n        break;\n\n      // no default\n    }\n  }\n\n  /**\n   * @summary Determines the type of a marker by the available properties\n   * @param {Marker.Properties} properties\n   * @param {boolean} [allowNone=false]\n   * @returns {string}\n   * @throws {PSV.PSVError} when the marker's type cannot be found\n   */\n  static getType(properties, allowNone = false) {\n    const found = [];\n\n    utils.each(MARKER_TYPES, (type) => {\n      if (properties[type]) {\n        found.push(type);\n      }\n    });\n\n    if (found.length === 0 && !allowNone) {\n      throw new PSVError(`missing marker content, either ${Object.keys(MARKER_TYPES).join(', ')}`);\n    }\n    else if (found.length > 1) {\n      throw new PSVError(`multiple marker content, either ${Object.keys(MARKER_TYPES).join(', ')}`);\n    }\n\n    return found[0];\n  }\n\n}\n","import { AbstractButton } from '../..';\nimport { EVENTS } from './constants';\nimport pin from './pin.svg';\n\n/**\n * @summary Navigation bar markers button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class MarkersButton extends AbstractButton {\n\n  static id = 'markers';\n  static icon = pin;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-markers-button', true);\n\n    /**\n     * @type {PSV.plugins.MarkersPlugin}\n     */\n    this.plugin = this.psv.getPlugin('markers');\n\n    if (this.plugin) {\n      this.plugin.on(EVENTS.SHOW_MARKERS, this);\n      this.plugin.on(EVENTS.HIDE_MARKERS, this);\n\n      this.toggleActive(true);\n    }\n\n    this.hide();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    if (this.plugin) {\n      this.plugin.off(EVENTS.SHOW_MARKERS, this);\n      this.plugin.off(EVENTS.HIDE_MARKERS, this);\n    }\n\n    super.destroy();\n  }\n\n  /**\n   * @override\n   */\n  isSupported() {\n    return !!this.plugin;\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case EVENTS.SHOW_MARKERS: this.toggleActive(true); break;\n      case EVENTS.HIDE_MARKERS: this.toggleActive(false); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @description Toggles markers\n   */\n  onClick() {\n    if (this.plugin.prop.visible) {\n      this.plugin.hide();\n    }\n    else {\n      this.plugin.show();\n    }\n  }\n\n}\n","import { AbstractButton, CONSTANTS } from '../..';\nimport { ID_PANEL_MARKERS_LIST } from './constants';\nimport pinList from './pin-list.svg';\n\n/**\n * @summary Navigation bar markers list button class\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class MarkersListButton extends AbstractButton {\n\n  static id = 'markersList';\n  static icon = pinList;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-markers-list-button', true);\n\n    /**\n     * @type {PSV.plugins.MarkersPlugin}\n     */\n    this.plugin = this.psv.getPlugin('markers');\n\n    if (this.plugin) {\n      this.psv.on(CONSTANTS.EVENTS.OPEN_PANEL, this);\n      this.psv.on(CONSTANTS.EVENTS.CLOSE_PANEL, this);\n    }\n\n    this.hide();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(CONSTANTS.EVENTS.OPEN_PANEL, this);\n    this.psv.off(CONSTANTS.EVENTS.CLOSE_PANEL, this);\n\n    super.destroy();\n  }\n\n  /**\n   * @override\n   */\n  isSupported() {\n    return !!this.plugin;\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case CONSTANTS.EVENTS.OPEN_PANEL:  this.toggleActive(e.args[0] === ID_PANEL_MARKERS_LIST); break;\n      case CONSTANTS.EVENTS.CLOSE_PANEL: this.toggleActive(false); break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @description Toggles markers list\n   */\n  onClick() {\n    this.plugin.toggleMarkersList();\n  }\n\n}\n","import { Vector3 } from 'three';\nimport { AbstractPlugin, CONSTANTS, DEFAULTS, PSVError, registerButton, utils } from '../..';\nimport {\n  EVENTS,\n  ID_PANEL_MARKER,\n  ID_PANEL_MARKERS_LIST,\n  MARKER_DATA,\n  MARKER_TOOLTIP_TRIGGER,\n  MARKERS_LIST_TEMPLATE,\n  SVG_NS\n} from './constants';\nimport { Marker } from './Marker';\nimport { MarkersButton } from './MarkersButton';\nimport { MarkersListButton } from './MarkersListButton';\nimport './style.scss';\n\n\n/**\n * @typedef {Object} PSV.plugins.MarkersPlugin.Options\n * @property {boolean} [clickEventOnMarker=false] If a `click` event is triggered on the viewer additionally to the `select-marker` event.\n * @property {PSV.plugins.MarkersPlugin.Properties[]} [markers]\n */\n\n/**\n * @typedef {Object} PSV.plugins.MarkersPlugin.SelectMarkerData\n * @summary Data of the `select-marker` event\n * @property {boolean} dblclick - if the selection originated from a double click, the simple click is always fired before the double click\n * @property {boolean} rightclick - if the selection originated from a right click\n */\n\n\n// add markers buttons\nDEFAULTS.lang[MarkersButton.id] = 'Markers';\nDEFAULTS.lang[MarkersListButton.id] = 'Markers list';\nregisterButton(MarkersButton, 'caption:left');\nregisterButton(MarkersListButton, 'caption:left');\n\n\nexport { EVENTS } from './constants';\n\n\n/**\n * @summary Displays various markers on the viewer\n * @extends PSV.plugins.AbstractPlugin\n * @memberof PSV.plugins\n */\nexport class MarkersPlugin extends AbstractPlugin {\n\n  static id = 'markers';\n\n  static EVENTS = EVENTS;\n\n  /**\n   * @param {PSV.Viewer} psv\n   * @param {PSV.plugins.MarkersPlugin.Options} [options]\n   */\n  constructor(psv, options) {\n    super(psv);\n\n    /**\n     * @summary All registered markers\n     * @member {Object<string, PSV.plugins.MarkersPlugin.Marker>}\n     */\n    this.markers = {};\n\n    /**\n     * @type {Object}\n     * @property {boolean} visible - Visibility of the component\n     * @property {PSV.plugins.MarkersPlugin.Marker} currentMarker - Last selected marker\n     * @property {PSV.plugins.MarkersPlugin.Marker} hoveringMarker - Marker under the cursor\n     * @private\n     */\n    this.prop = {\n      visible       : true,\n      currentMarker : null,\n      hoveringMarker: null,\n      stopObserver  : null,\n    };\n\n    /**\n     * @type {PSV.plugins.MarkersPlugin.Options}\n     */\n    this.config = {\n      clickEventOnMarker: false,\n      ...options,\n    };\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     */\n    this.container = document.createElement('div');\n    this.container.className = 'psv-markers';\n    this.container.style.cursor = this.psv.config.mousemove ? 'move' : 'default';\n\n    /**\n     * @member {SVGElement}\n     * @readonly\n     */\n    this.svgContainer = document.createElementNS(SVG_NS, 'svg');\n    this.svgContainer.setAttribute('class', 'psv-markers-svg-container');\n    this.container.appendChild(this.svgContainer);\n\n    // Markers events via delegation\n    this.container.addEventListener('mouseenter', this, true);\n    this.container.addEventListener('mouseleave', this, true);\n    this.container.addEventListener('mousemove', this, true);\n    this.container.addEventListener('contextmenu', this);\n  }\n\n  /**\n   * @package\n   */\n  init() {\n    super.init();\n\n    this.psv.container.appendChild(this.container);\n\n    // Viewer events\n    this.psv.on(CONSTANTS.EVENTS.CLICK, this);\n    this.psv.on(CONSTANTS.EVENTS.DOUBLE_CLICK, this);\n    this.psv.on(CONSTANTS.EVENTS.RENDER, this);\n    this.psv.on(CONSTANTS.EVENTS.CONFIG_CHANGED, this);\n\n    this.psv.once(CONSTANTS.EVENTS.READY, () => {\n      if (this.config.markers) {\n        this.setMarkers(this.config.markers);\n        delete this.config.markers;\n      }\n    });\n  }\n\n  /**\n   * @package\n   */\n  destroy() {\n    this.clearMarkers(false);\n\n    this.prop.stopObserver?.();\n\n    this.psv.off(CONSTANTS.EVENTS.CLICK, this);\n    this.psv.off(CONSTANTS.EVENTS.DOUBLE_CLICK, this);\n    this.psv.off(CONSTANTS.EVENTS.RENDER, this);\n    this.psv.off(CONSTANTS.EVENTS.CONFIG_CHANGED, this);\n\n    this.psv.container.removeChild(this.container);\n\n    delete this.svgContainer;\n    delete this.markers;\n    delete this.container;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      // @formatter:off\n      case 'mouseenter':  this.__onMouseEnter(e, this.__getTargetMarker(e.target)); break;\n      case 'mouseleave':  this.__onMouseLeave(e, this.__getTargetMarker(e.target)); break;\n      case 'mousemove':   this.__onMouseMove(e, this.__getTargetMarker(e.target));  break;\n      case 'contextmenu': e.preventDefault(); break;\n      case CONSTANTS.EVENTS.CLICK:        this.__onClick(e, e.args[0], false); break;\n      case CONSTANTS.EVENTS.DOUBLE_CLICK: this.__onClick(e, e.args[0], true);  break;\n      case CONSTANTS.EVENTS.RENDER:       this.renderMarkers();                        break;\n      case CONSTANTS.OBJECT_EVENTS.ENTER_OBJECT: this.__onMouseEnter(e.detail.originalEvent, e.detail.data); break;\n      case CONSTANTS.OBJECT_EVENTS.LEAVE_OBJECT: this.__onMouseLeave(e.detail.originalEvent, e.detail.data); break;\n      case CONSTANTS.OBJECT_EVENTS.HOVER_OBJECT: this.__onMouseMove(e.detail.originalEvent, e.detail.data);  break;\n      case CONSTANTS.EVENTS.CONFIG_CHANGED:\n        this.container.style.cursor = this.psv.config.mousemove ? 'move' : 'default';\n        break;\n      // @formatter:on\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @summary Shows all markers\n   * @fires PSV.plugins.MarkersPlugin.show-markers\n   */\n  show() {\n    this.prop.visible = true;\n\n    this.renderMarkers();\n\n    this.trigger(EVENTS.SHOW_MARKERS);\n  }\n\n  /**\n   * @summary Hides all markers\n   * @fires PSV.plugins.MarkersPlugin.hide-markers\n   */\n  hide() {\n    this.prop.visible = false;\n\n    this.renderMarkers();\n\n    this.trigger(EVENTS.HIDE_MARKERS);\n  }\n\n  /**\n   * @summary Toggles the visibility of all tooltips\n   */\n  toggleAllTooltips() {\n    if (this.prop.showAllTooltips) {\n      this.hideAllTooltips();\n    }\n    else {\n      this.showAllTooltips();\n    }\n  }\n\n  /**\n   * @summary Displays all tooltips\n   */\n  showAllTooltips() {\n    this.prop.showAllTooltips = true;\n    utils.each(this.markers, (marker) => {\n      marker.props.staticTooltip = true;\n      marker.showTooltip();\n    });\n  }\n\n  /**\n   * @summary Hides all tooltips\n   */\n  hideAllTooltips() {\n    this.prop.showAllTooltips = false;\n    utils.each(this.markers, (marker) => {\n      marker.props.staticTooltip = false;\n      marker.hideTooltip();\n    });\n  }\n\n  /**\n   * @summary Returns the total number of markers\n   * @returns {number}\n   */\n  getNbMarkers() {\n    return Object.keys(this.markers).length;\n  }\n\n  /**\n   * @summary Returns all the markers\n   * @return {PSV.plugins.MarkersPlugin.Marker[]}\n   */\n  getMarkers() {\n    return Object.values(this.markers);\n  }\n\n  /**\n   * @summary Adds a new marker to viewer\n   * @param {PSV.plugins.MarkersPlugin.Properties} properties\n   * @param {boolean} [render=true] - renders the marker immediately\n   * @returns {PSV.plugins.MarkersPlugin.Marker}\n   * @throws {PSV.PSVError} when the marker's id is missing or already exists\n   */\n  addMarker(properties, render = true) {\n    if (this.markers[properties.id]) {\n      throw new PSVError(`marker \"${properties.id}\" already exists`);\n    }\n\n    const marker = new Marker(properties, this.psv);\n\n    if (marker.isNormal()) {\n      this.container.appendChild(marker.$el);\n    }\n    else if (marker.isPoly() || marker.isSvg()) {\n      this.svgContainer.appendChild(marker.$el);\n    }\n    else if (marker.is3d()) {\n      this.psv.renderer.scene.add(marker.$el);\n    }\n\n    this.markers[marker.id] = marker;\n\n    if (render) {\n      this.renderMarkers();\n      this.__refreshUi();\n      this.__checkObjectsObserver();\n\n      this.trigger(EVENTS.SET_MARKERS, this.getMarkers());\n    }\n\n    return marker;\n  }\n\n  /**\n   * @summary Returns the internal marker object for a marker id\n   * @param {string} markerId\n   * @returns {PSV.plugins.MarkersPlugin.Marker}\n   * @throws {PSV.PSVError} when the marker cannot be found\n   */\n  getMarker(markerId) {\n    const id = typeof markerId === 'object' ? markerId.id : markerId;\n\n    if (!this.markers[id]) {\n      throw new PSVError(`cannot find marker \"${id}\"`);\n    }\n\n    return this.markers[id];\n  }\n\n  /**\n   * @summary Returns the last marker selected by the user\n   * @returns {PSV.plugins.MarkersPlugin.Marker}\n   */\n  getCurrentMarker() {\n    return this.prop.currentMarker;\n  }\n\n  /**\n   * @summary Updates the existing marker with the same id\n   * @description Every property can be changed but you can't change its type (Eg: `image` to `html`).\n   * @param {PSV.plugins.MarkersPlugin.Properties} properties\n   * @param {boolean} [render=true] - renders the marker immediately\n   * @returns {PSV.plugins.MarkersPlugin.Marker}\n   */\n  updateMarker(properties, render = true) {\n    const marker = this.getMarker(properties.id);\n\n    marker.update(properties);\n\n    if (render) {\n      this.renderMarkers();\n      this.__refreshUi();\n\n      if (marker.is3d()) {\n        this.psv.needsUpdate();\n      }\n\n      this.trigger(EVENTS.SET_MARKERS, this.getMarkers());\n    }\n\n    return marker;\n  }\n\n  /**\n   * @summary Removes a marker from the viewer\n   * @param {string} markerId\n   * @param {boolean} [render=true] - renders the marker immediately\n   */\n  removeMarker(markerId, render = true) {\n    const marker = this.getMarker(markerId);\n\n    if (marker.isNormal()) {\n      this.container.removeChild(marker.$el);\n    }\n    else if (marker.isPoly() || marker.isSvg()) {\n      this.svgContainer.removeChild(marker.$el);\n    }\n    else if (marker.is3d()) {\n      this.psv.renderer.scene.remove(marker.$el);\n      this.psv.needsUpdate();\n    }\n\n    if (this.prop.hoveringMarker === marker) {\n      this.prop.hoveringMarker = null;\n    }\n\n    if (this.prop.currentMarker === marker) {\n      this.prop.currentMarker = null;\n    }\n\n    marker.hideTooltip();\n\n    marker.destroy();\n    delete this.markers[marker.id];\n\n    if (render) {\n      this.__refreshUi();\n      this.__checkObjectsObserver();\n\n      this.trigger(EVENTS.SET_MARKERS, this.getMarkers());\n    }\n  }\n\n  /**\n   * @summary Removes multiple markers\n   * @param {string[]} markerIds\n   * @param {boolean} [render=true] - renders the markers immediately\n   */\n  removeMarkers(markerIds, render = true) {\n    markerIds.forEach(markerId => this.removeMarker(markerId, false));\n\n    if (render) {\n      this.__refreshUi();\n      this.__checkObjectsObserver();\n\n      this.trigger(EVENTS.SET_MARKERS, this.getMarkers());\n    }\n  }\n\n  /**\n   * @summary Replaces all markers\n   * @param {PSV.plugins.MarkersPlugin.Properties[]} markers\n   * @param {boolean} [render=true] - renders the marker immediately\n   */\n  setMarkers(markers, render = true) {\n    this.clearMarkers(false);\n\n    utils.each(markers, marker => this.addMarker(marker, false));\n\n    if (render) {\n      this.renderMarkers();\n      this.__refreshUi();\n      this.__checkObjectsObserver();\n\n      this.trigger(EVENTS.SET_MARKERS, this.getMarkers());\n    }\n  }\n\n  /**\n   * @summary Removes all markers\n   * @param {boolean} [render=true] - renders the markers immediately\n   */\n  clearMarkers(render = true) {\n    utils.each(this.markers, marker => this.removeMarker(marker, false));\n\n    if (render) {\n      this.renderMarkers();\n      this.__refreshUi();\n      this.__checkObjectsObserver();\n\n      this.trigger(EVENTS.SET_MARKERS, this.getMarkers());\n    }\n  }\n\n  /**\n   * @summary Rotate the view to face the marker\n   * @param {string} markerId\n   * @param {string|number} [speed] - rotates smoothy, see {@link PSV.Viewer#animate}\n   * @fires PSV.plugins.MarkersPlugin.goto-marker-done\n   * @return {PSV.utils.Animation}  A promise that will be resolved when the animation finishes\n   */\n  gotoMarker(markerId, speed) {\n    const marker = this.getMarker(markerId);\n\n    return this.psv.animate({\n      ...marker.props.position,\n      zoom : marker.config.zoomLvl,\n      speed: speed,\n    })\n      .then(() => {\n        this.trigger(EVENTS.GOTO_MARKER_DONE, marker);\n      });\n  }\n\n  /**\n   * @summary Hides a marker\n   * @param {string} markerId\n   */\n  hideMarker(markerId) {\n    this.toggleMarker(markerId, false);\n  }\n\n  /**\n   * @summary Shows a marker\n   * @param {string} markerId\n   */\n  showMarker(markerId) {\n    this.toggleMarker(markerId, true);\n  }\n\n  /**\n   * @summary Forces the display of the tooltip\n   * @param {string} markerId\n   */\n  showMarkerTooltip(markerId) {\n    const marker = this.getMarker(markerId);\n    marker.props.staticTooltip = true;\n    marker.showTooltip();\n  }\n\n  /**\n   * @summary Hides the tooltip\n   * @param {string} markerId\n   */\n  hideMarkerTooltip(markerId) {\n    const marker = this.getMarker(markerId);\n    marker.props.staticTooltip = false;\n    marker.hideTooltip();\n  }\n\n  /**\n   * @summary Toggles a marker\n   * @param {string} markerId\n   * @param {boolean} [visible]\n   */\n  toggleMarker(markerId, visible = null) {\n    const marker = this.getMarker(markerId);\n    marker.visible = visible === null ? !marker.visible : visible;\n    if (marker.is3d()) {\n      this.psv.needsUpdate();\n    }\n    else {\n      this.renderMarkers();\n    }\n  }\n\n  /**\n   * @summary Opens the panel with the content of the marker\n   * @param {string} markerId\n   */\n  showMarkerPanel(markerId) {\n    const marker = this.getMarker(markerId);\n\n    if (marker?.config?.content) {\n      this.psv.panel.show({\n        id     : ID_PANEL_MARKER,\n        content: marker.config.content,\n      });\n    }\n    else {\n      this.psv.panel.hide(ID_PANEL_MARKER);\n    }\n  }\n\n  /**\n   * @summary Toggles the visibility of the list of markers\n   */\n  toggleMarkersList() {\n    if (this.psv.panel.prop.contentId === ID_PANEL_MARKERS_LIST) {\n      this.hideMarkersList();\n    }\n    else {\n      this.showMarkersList();\n    }\n  }\n\n  /**\n   * @summary Opens side panel with the list of markers\n   * @fires PSV.plugins.MarkersPlugin.filter:render-markers-list\n   */\n  showMarkersList() {\n    let markers = [];\n    utils.each(this.markers, (marker) => {\n      if (marker.visible && !marker.config.hideList) {\n        markers.push(marker);\n      }\n    });\n\n    markers = this.change(EVENTS.RENDER_MARKERS_LIST, markers);\n\n    this.psv.panel.show({\n      id          : ID_PANEL_MARKERS_LIST,\n      content     : MARKERS_LIST_TEMPLATE(markers, this.psv.config.lang[MarkersButton.id]),\n      noMargin    : true,\n      clickHandler: (e) => {\n        const li = e.target ? utils.getClosest(e.target, 'li') : undefined;\n        const markerId = li ? li.dataset[MARKER_DATA] : undefined;\n\n        if (markerId) {\n          const marker = this.getMarker(markerId);\n\n          this.trigger(EVENTS.SELECT_MARKER_LIST, marker);\n\n          this.gotoMarker(marker, 1000);\n          this.hideMarkersList();\n        }\n      },\n    });\n  }\n\n  /**\n   * @summary Closes side panel if it contains the list of markers\n   */\n  hideMarkersList() {\n    this.psv.panel.hide(ID_PANEL_MARKERS_LIST);\n  }\n\n  /**\n   * @summary Updates the visibility and the position of all markers\n   */\n  renderMarkers() {\n    const zoomLevel = this.psv.getZoomLevel();\n    const viewerPosition = this.psv.getPosition();\n\n    utils.each(this.markers, (marker) => {\n      let isVisible = this.prop.visible && marker.visible;\n      let visibilityChanged = false;\n      let position = null;\n\n      if (isVisible && marker.is3d()) {\n        position = this.__getMarkerPosition(marker);\n        isVisible = this.__isMarkerVisible(marker, position);\n      }\n      else if (isVisible && marker.isPoly()) {\n        const positions = this.__getPolyPositions(marker);\n        isVisible = positions.length > (marker.isPolygon() ? 2 : 1);\n\n        if (isVisible) {\n          position = this.__getMarkerPosition(marker);\n\n          const points = positions.map(pos => (pos.x - position.x) + ',' + (pos.y - position.y)).join(' ');\n\n          marker.$el.setAttributeNS(null, 'points', points);\n          marker.$el.setAttributeNS(null, 'transform', `translate(${position.x} ${position.y})`);\n        }\n      }\n      else if (isVisible) {\n        if (marker.props.dynamicSize) {\n          this.__updateMarkerSize(marker);\n        }\n\n        position = this.__getMarkerPosition(marker);\n        isVisible = this.__isMarkerVisible(marker, position);\n\n        if (isVisible) {\n          const scale = marker.getScale(zoomLevel, viewerPosition);\n\n          if (marker.isSvg()) {\n            // simulate transform-origin relative to SVG element\n            const x = position.x + marker.props.width * marker.props.anchor.x * (1 - scale);\n            const y = position.y + marker.props.height * marker.props.anchor.y * (1 - scale);\n            marker.$el.setAttributeNS(null, 'transform', `translate(${x}, ${y}) scale(${scale}, ${scale})`);\n          }\n          else {\n            marker.$el.style.transform = `translate3D(${position.x}px, ${position.y}px, 0px) scale(${scale}, ${scale})`;\n          }\n        }\n      }\n\n      visibilityChanged = marker.props.visible !== isVisible;\n      marker.props.visible = isVisible;\n      marker.props.position2D = isVisible ? position : null;\n\n      if (!marker.is3d()) {\n        utils.toggleClass(marker.$el, 'psv-marker--visible', isVisible);\n      }\n\n      if (!isVisible) {\n        marker.hideTooltip();\n      }\n      else if (marker.props.staticTooltip) {\n        marker.showTooltip();\n      }\n      else if (marker.config.tooltip.trigger === MARKER_TOOLTIP_TRIGGER.click || (marker === this.prop.hoveringMarker && !marker.isPoly())) {\n        marker.refreshTooltip();\n      }\n      else if (marker !== this.prop.hoveringMarker) {\n        marker.hideTooltip();\n      }\n\n      if (visibilityChanged) {\n        this.trigger(EVENTS.MARKER_VISIBILITY, marker, isVisible);\n      }\n    });\n  }\n\n  /**\n   * @summary Determines if a point marker is visible<br>\n   * It tests if the point is in the general direction of the camera, then check if it's in the viewport\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   * @param {PSV.Point} position\n   * @returns {boolean}\n   * @private\n   */\n  __isMarkerVisible(marker, position) {\n    return marker.props.positions3D[0].dot(this.psv.prop.direction) > 0\n      && position.x + marker.props.width >= 0\n      && position.x - marker.props.width <= this.psv.prop.size.width\n      && position.y + marker.props.height >= 0\n      && position.y - marker.props.height <= this.psv.prop.size.height;\n  }\n\n  /**\n   * @summary Computes the real size of a marker\n   * @description This is done by removing all it's transformations (if any) and making it visible\n   * before querying its bounding rect\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   * @private\n   */\n  __updateMarkerSize(marker) {\n    marker.$el.classList.add('psv-marker--transparent');\n\n    let transform;\n    if (marker.isSvg()) {\n      transform = marker.$el.getAttributeNS(null, 'transform');\n      marker.$el.removeAttributeNS(null, 'transform');\n    }\n    else {\n      transform = marker.$el.style.transform;\n      marker.$el.style.transform = '';\n    }\n\n    const rect = marker.$el.getBoundingClientRect();\n    marker.props.width = rect.width;\n    marker.props.height = rect.height;\n\n    marker.$el.classList.remove('psv-marker--transparent');\n\n    if (transform) {\n      if (marker.isSvg()) {\n        marker.$el.setAttributeNS(null, 'transform', transform);\n      }\n      else {\n        marker.$el.style.transform = transform;\n      }\n    }\n\n    // the size is no longer dynamic once known\n    marker.props.dynamicSize = false;\n  }\n\n  /**\n   * @summary Computes viewer coordinates of a marker\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   * @returns {PSV.Point}\n   * @private\n   */\n  __getMarkerPosition(marker) {\n    if (marker.isPoly()) {\n      return this.psv.dataHelper.sphericalCoordsToViewerCoords(marker.props.position);\n    }\n    else {\n      const position = this.psv.dataHelper.vector3ToViewerCoords(marker.props.positions3D[0]);\n\n      position.x -= marker.props.width * marker.props.anchor.x;\n      position.y -= marker.props.height * marker.props.anchor.y;\n\n      return position;\n    }\n  }\n\n  /**\n   * @summary Computes viewer coordinates of each point of a polygon/polyline<br>\n   * It handles points behind the camera by creating intermediary points suitable for the projector\n   * @param {PSV.plugins.MarkersPlugin.Marker} marker\n   * @returns {PSV.Point[]}\n   * @private\n   */\n  __getPolyPositions(marker) {\n    const nbVectors = marker.props.positions3D.length;\n\n    // compute if each vector is visible\n    const positions3D = marker.props.positions3D.map((vector) => {\n      return {\n        vector : vector,\n        visible: vector.dot(this.psv.prop.direction) > 0,\n      };\n    });\n\n    // get pairs of visible/invisible vectors for each invisible vector connected to a visible vector\n    const toBeComputed = [];\n    positions3D.forEach((pos, i) => {\n      if (!pos.visible) {\n        const neighbours = [\n          i === 0 ? positions3D[nbVectors - 1] : positions3D[i - 1],\n          i === nbVectors - 1 ? positions3D[0] : positions3D[i + 1],\n        ];\n\n        neighbours.forEach((neighbour) => {\n          if (neighbour.visible) {\n            toBeComputed.push({\n              visible  : neighbour,\n              invisible: pos,\n              index    : i,\n            });\n          }\n        });\n      }\n    });\n\n    // compute intermediary vector for each pair (the loop is reversed for splice to insert at the right place)\n    toBeComputed.reverse().forEach((pair) => {\n      positions3D.splice(pair.index, 0, {\n        vector : this.__getPolyIntermediaryPoint(pair.visible.vector, pair.invisible.vector),\n        visible: true,\n      });\n    });\n\n    // translate vectors to screen pos\n    return positions3D\n      .filter(pos => pos.visible)\n      .map(pos => this.psv.dataHelper.vector3ToViewerCoords(pos.vector));\n  }\n\n  /**\n   * Given one point in the same direction of the camera and one point behind the camera,\n   * computes an intermediary point on the great circle delimiting the half sphere visible by the camera.\n   * The point is shifted by .01 rad because the projector cannot handle points exactly on this circle.\n   * TODO : does not work with fisheye view (must not use the great circle)\n   * {@link http://math.stackexchange.com/a/1730410/327208}\n   * @param P1 {external:THREE.Vector3}\n   * @param P2 {external:THREE.Vector3}\n   * @returns {external:THREE.Vector3}\n   * @private\n   */\n  __getPolyIntermediaryPoint(P1, P2) {\n    const C = this.psv.prop.direction.clone().normalize();\n    const N = new Vector3().crossVectors(P1, P2).normalize();\n    const V = new Vector3().crossVectors(N, P1).normalize();\n    const X = P1.clone().multiplyScalar(-C.dot(V));\n    const Y = V.clone().multiplyScalar(C.dot(P1));\n    const H = new Vector3().addVectors(X, Y).normalize();\n    const a = new Vector3().crossVectors(H, C);\n    return H.applyAxisAngle(a, 0.01).multiplyScalar(CONSTANTS.SPHERE_RADIUS);\n  }\n\n  /**\n   * @summary Returns the marker associated to an event target\n   * @param {EventTarget} target\n   * @param {boolean} [closest=false]\n   * @returns {PSV.plugins.MarkersPlugin.Marker}\n   * @private\n   */\n  __getTargetMarker(target, closest = false) {\n    const target2 = closest ? utils.getClosest(target, '.psv-marker') : target;\n    return target2 ? target2[MARKER_DATA] : undefined;\n  }\n\n  /**\n   * @summary Checks if an event target is in the tooltip\n   * @param {EventTarget} target\n   * @param {PSV.components.Tooltip} tooltip\n   * @returns {boolean}\n   * @private\n   */\n  __targetOnTooltip(target, tooltip) {\n    return target && tooltip ? utils.hasParent(target, tooltip.container) : false;\n  }\n\n  /**\n   * @summary Handles mouse enter events, show the tooltip for non polygon markers\n   * @param {MouseEvent} e\n   * @param {PSV.plugins.MarkersPlugin.Marker} [marker]\n   * @fires PSV.plugins.MarkersPlugin.over-marker\n   * @private\n   */\n  __onMouseEnter(e, marker) {\n    if (marker && !marker.isPoly()) {\n      this.prop.hoveringMarker = marker;\n\n      this.trigger(EVENTS.OVER_MARKER, marker);\n\n      if (!marker.props.staticTooltip && marker.config.tooltip.trigger === MARKER_TOOLTIP_TRIGGER.hover) {\n        marker.showTooltip(e);\n      }\n    }\n  }\n\n  /**\n   * @summary Handles mouse leave events, hide the tooltip\n   * @param {MouseEvent} e\n   * @param {PSV.plugins.MarkersPlugin.Marker} [marker]\n   * @fires PSV.plugins.MarkersPlugin.leave-marker\n   * @private\n   */\n  __onMouseLeave(e, marker) {\n    // do not hide if we enter the tooltip itself while hovering a polygon\n    if (marker && !(marker.isPoly() && this.__targetOnTooltip(e.relatedTarget, marker.tooltip))) {\n      this.trigger(EVENTS.LEAVE_MARKER, marker);\n\n      this.prop.hoveringMarker = null;\n\n      if (!marker.props.staticTooltip && marker.config.tooltip.trigger === MARKER_TOOLTIP_TRIGGER.hover) {\n        marker.hideTooltip();\n      }\n    }\n  }\n\n  /**\n   * @summary Handles mouse move events, refreshUi the tooltip for polygon markers\n   * @param {MouseEvent} e\n   * @param {PSV.plugins.MarkersPlugin.Marker} [targetMarker]\n   * @fires PSV.plugins.MarkersPlugin.leave-marker\n   * @fires PSV.plugins.MarkersPlugin.over-marker\n   * @private\n   */\n  __onMouseMove(e, targetMarker) {\n    let marker;\n\n    if (targetMarker?.isPoly()) {\n      marker = targetMarker;\n    }\n    // do not hide if we enter the tooltip itself while hovering a polygon\n    else if (this.prop.hoveringMarker && this.__targetOnTooltip(e.target, this.prop.hoveringMarker.tooltip)) {\n      marker = this.prop.hoveringMarker;\n    }\n\n    if (marker) {\n      if (!this.prop.hoveringMarker) {\n        this.trigger(EVENTS.OVER_MARKER, marker);\n\n        this.prop.hoveringMarker = marker;\n      }\n\n      if (!marker.props.staticTooltip) {\n        marker.showTooltip(e);\n      }\n    }\n    else if (this.prop.hoveringMarker?.isPoly()) {\n      this.trigger(EVENTS.LEAVE_MARKER, this.prop.hoveringMarker);\n\n      if (!this.prop.hoveringMarker.props.staticTooltip) {\n        this.prop.hoveringMarker.hideTooltip();\n      }\n\n      this.prop.hoveringMarker = null;\n    }\n  }\n\n  /**\n   * @summary Handles mouse click events, select the marker and open the panel if necessary\n   * @param {Event} e\n   * @param {Object} data\n   * @param {boolean} dblclick\n   * @fires PSV.plugins.MarkersPlugin.select-marker\n   * @fires PSV.plugins.MarkersPlugin.unselect-marker\n   * @private\n   */\n  __onClick(e, data, dblclick) {\n    let marker = data.objects.find(o => o.userData[MARKER_DATA])?.userData[MARKER_DATA];\n\n    if (!marker) {\n      marker = this.__getTargetMarker(data.target, true);\n    }\n\n    if (this.prop.currentMarker && this.prop.currentMarker !== marker) {\n      this.trigger(EVENTS.UNSELECT_MARKER, this.prop.currentMarker);\n\n      this.psv.panel.hide(ID_PANEL_MARKER);\n\n      if (!this.prop.showAllTooltips && this.prop.currentMarker.config.tooltip.trigger === MARKER_TOOLTIP_TRIGGER.click) {\n        this.hideMarkerTooltip(this.prop.currentMarker);\n      }\n\n      this.prop.currentMarker = null;\n    }\n\n    if (marker) {\n      this.prop.currentMarker = marker;\n\n      this.trigger(EVENTS.SELECT_MARKER, marker, {\n        dblclick  : dblclick,\n        rightclick: data.rightclick,\n      });\n\n      if (this.config.clickEventOnMarker) {\n        // add the marker to event data\n        data.marker = marker;\n      }\n      else {\n        e.stopPropagation();\n      }\n\n      // the marker could have been deleted in an event handler\n      if (this.markers[marker.id]) {\n        if (marker.config.tooltip.trigger === MARKER_TOOLTIP_TRIGGER.click) {\n          if (marker.tooltip) {\n            this.hideMarkerTooltip(marker);\n          }\n          else {\n            this.showMarkerTooltip(marker);\n          }\n        }\n        else {\n          this.showMarkerPanel(marker.id);\n        }\n      }\n    }\n  }\n\n  /**\n   * @summary Updates the visiblity of the panel and the buttons\n   * @private\n   */\n  __refreshUi() {\n    const nbMarkers = Object.values(this.markers).filter(m => !m.config.hideList).length;\n\n    if (nbMarkers === 0) {\n      if (this.psv.panel.isVisible(ID_PANEL_MARKERS_LIST)) {\n        this.psv.panel.hide();\n      }\n      else if (this.psv.panel.isVisible(ID_PANEL_MARKER)) {\n        this.psv.panel.hide();\n      }\n    }\n    else {\n      // eslint-disable-next-line no-lonely-if\n      if (this.psv.panel.isVisible(ID_PANEL_MARKERS_LIST)) {\n        this.showMarkersList();\n      }\n      else if (this.psv.panel.isVisible(ID_PANEL_MARKER)) {\n        this.prop.currentMarker ? this.showMarkerPanel(this.prop.currentMarker) : this.psv.panel.hide();\n      }\n    }\n\n    this.psv.navbar.getButton(MarkersButton.id, false)?.toggle(nbMarkers > 0);\n    this.psv.navbar.getButton(MarkersListButton.id, false)?.toggle(nbMarkers > 0);\n  }\n\n  /**\n   * @summary Adds or remove the objects observer if there are 3D markers\n   * @private\n   */\n  __checkObjectsObserver() {\n    const has3d = Object.values(this.markers).some(marker => marker.is3d());\n\n    if (!has3d && this.prop.stopObserver) {\n      this.prop.stopObserver();\n      this.prop.stopObserver = null;\n    }\n    else if (has3d && !this.prop.stopObserver) {\n      this.prop.stopObserver = this.psv.observeObjects(MARKER_DATA, this);\n    }\n  }\n\n}\n"],"names":["EVENTS","MARKER_VISIBILITY","GOTO_MARKER_DONE","LEAVE_MARKER","OVER_MARKER","RENDER_MARKERS_LIST","SELECT_MARKER","SELECT_MARKER_LIST","UNSELECT_MARKER","HIDE_MARKERS","SET_MARKERS","SHOW_MARKERS","MARKER_TOOLTIP_TRIGGER","click","hover","SVG_NS","MARKER_DATA","ID_PANEL_MARKER","ID_PANEL_MARKERS_LIST","MARKER_DATA_KEY","utils","dasherize","MARKERS_LIST_TEMPLATE","markers","title","icon","map","marker","config","id","type","image","getListContent","join","greatArcIntermediaryPoint","p1","p2","f","λ1","φ1","λ2","φ2","r","greatArcDistance","a","Math","sin","b","x","cos","y","z","atan2","sqrt","getPolygonCenter","polygon","workPoints","k","i","length","d","PI","push","sum","reduce","intermediary","point","parseAngle","getPolylineCenter","polyline","lengths","l","CONSTANTS","SPHERE_RADIUS","consumed","j","round","MARKER_TYPES","imageLayer","html","polygonPx","polygonRad","polylinePx","polylineRad","square","rect","circle","ellipse","path","Marker","properties","psv","PSVError","getType","visible","$el","data","undefined","tooltip","props","dynamicSize","anchor","staticTooltip","position","position2D","positions3D","width","height","def","loader","is3d","TextureLoader","withCredentials","setWithCredentials","requestHeaders","setRequestHeader","isNormal","document","createElement","isPolygon","createElementNS","isPolyline","isSvg","svgType","update","destroy","isPoly","isPolyPx","isPolyRad","getScale","zoomLevel","scale","Array","isArray","zoom","bounds","EASINGS","inQuad","longitude","halfFov","MathUtils","degToRad","prop","hFov","arc","abs","getShortestArc","outQuad","max","listContent","content","showTooltip","mousePosition","viewerPos","getPosition","container","top","clientY","left","clientX","box","move","create","refreshTooltip","hideTooltip","hide","newType","deepmerge","trigger","className","setAttribute","addClasses","classList","add","style","opacity","parsePosition","__updateNormal","__updatePoly","__updateSvg","__update3d","isExtendedPosition","backgroundImage","innerHTML","transformOrigin","dataHelper","cleanPosition","sphericalCoordsToVector3","cx","cy","rx","ry","each","value","setAttributeNS","svgStyle","fill","actualPoly","splice","coord","sphericalCoords","textureCoordsToSphericalCoords","latitude","centroid","material","MeshBasicMaterial","transparent","depthTest","geometry","PlaneGeometry","mesh","Mesh","userData","Group","Object","defineProperty","enumerable","get","children","set","load","texture","anisotropy","needsUpdate","copy","orientation","lookAt","rotateX","rotateY","allowNone","found","keys","MarkersButton","navbar","plugin","getPlugin","on","toggleActive","off","isSupported","handleEvent","e","onClick","show","AbstractButton","pin","MarkersListButton","OPEN_PANEL","CLOSE_PANEL","args","toggleMarkersList","pinList","DEFAULTS","lang","registerButton","MarkersPlugin","options","currentMarker","hoveringMarker","stopObserver","clickEventOnMarker","cursor","mousemove","svgContainer","appendChild","addEventListener","init","CLICK","DOUBLE_CLICK","RENDER","CONFIG_CHANGED","once","READY","setMarkers","clearMarkers","removeChild","__onMouseEnter","__getTargetMarker","target","__onMouseLeave","__onMouseMove","preventDefault","__onClick","renderMarkers","OBJECT_EVENTS","ENTER_OBJECT","detail","originalEvent","LEAVE_OBJECT","HOVER_OBJECT","toggleAllTooltips","showAllTooltips","hideAllTooltips","getNbMarkers","getMarkers","values","addMarker","render","renderer","scene","__refreshUi","__checkObjectsObserver","getMarker","markerId","getCurrentMarker","updateMarker","removeMarker","remove","removeMarkers","markerIds","forEach","gotoMarker","speed","animate","zoomLvl","then","hideMarker","toggleMarker","showMarker","showMarkerTooltip","hideMarkerTooltip","showMarkerPanel","panel","contentId","hideMarkersList","showMarkersList","hideList","change","noMargin","clickHandler","li","getClosest","dataset","getZoomLevel","viewerPosition","isVisible","visibilityChanged","__getMarkerPosition","__isMarkerVisible","positions","__getPolyPositions","points","pos","__updateMarkerSize","transform","toggleClass","dot","direction","size","getAttributeNS","removeAttributeNS","getBoundingClientRect","sphericalCoordsToViewerCoords","vector3ToViewerCoords","nbVectors","vector","toBeComputed","neighbours","neighbour","invisible","index","reverse","pair","__getPolyIntermediaryPoint","filter","P1","P2","C","clone","normalize","N","Vector3","crossVectors","V","X","multiplyScalar","Y","H","addVectors","applyAxisAngle","closest","target2","__targetOnTooltip","hasParent","relatedTarget","targetMarker","dblclick","objects","find","o","rightclick","stopPropagation","nbMarkers","m","getButton","toggle","has3d","some","observeObjects","AbstractPlugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAGA;EACA;EACA;EACA;EACA;EACA;AACO,MAAMA,MAAM,GAAG;EACpB;EACF;EACA;EACA;EACA;EACA;EACA;EACEC,EAAAA,iBAAiB,EAAI,mBAAmB;EACxC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,gBAAgB,EAAK,kBAAkB;EACvC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,YAAY,EAAS,cAAc;EACnC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,WAAW,EAAU,aAAa;EAClC;EACF;EACA;EACA;EACA;EACA;EACA;EACEC,EAAAA,mBAAmB,EAAE,qBAAqB;EAC1C;EACF;EACA;EACA;EACA;EACA;EACA;EACA;EACEC,EAAAA,aAAa,EAAQ,eAAe;EACpC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,kBAAkB,EAAG,oBAAoB;EACzC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,eAAe,EAAM,iBAAiB;EACtC;EACF;EACA;EACA;EACA;EACEC,EAAAA,YAAY,EAAS,cAAc;EACnC;EACF;EACA;EACA;EACA;EACA;EACEC,EAAAA,WAAW,EAAU,aAAa;EAClC;EACF;EACA;EACA;EACA;EACEC,EAAAA,YAAY,EAAS,cAAA;EACvB,EAAC;;EAED;EACA;EACA;EACA;EACA;EACA;EACA;EACO,IAAMC,sBAAsB,GAAG;EACpCC,EAAAA,KAAK,EAAE,OAAO;EACdC,EAAAA,KAAK,EAAE,OAAA;EACT,CAAC,CAAA;;EAED;EACA;EACA;EACA;EACA;EACA;EACO,IAAMC,MAAM,GAAG,4BAA4B,CAAA;;EAElD;EACA;EACA;EACA;EACA;EACA;EACO,IAAMC,WAAW,GAAG,WAAW,CAAA;;EAEtC;EACA;EACA;EACA;EACA;EACA;EACO,IAAMC,eAAe,GAAG,QAAQ,CAAA;;EAEvC;EACA;EACA;EACA;EACA;EACA;EACO,IAAMC,qBAAqB,GAAG,aAAa,CAAA;EAElD,IAAMC,eAAe,GAAGC,uBAAK,CAACC,SAAS,C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"}